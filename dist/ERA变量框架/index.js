import{createPinia as e}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var n={8:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.meta[data-v-56f5fbd7]{position:relative;padding:12px 12px 14px;border:1px solid rgba(0,0,0,0.06);border-radius:12px;background:linear-gradient(180deg,#ffffff,#f9fafb);box-shadow:0 6px 18px rgba(0,0,0,0.06),inset 0 1px 0 #fff}.meta-title[data-v-56f5fbd7]{margin:0 0 10px;font-size:13px;font-weight:800;color:#374151}.kv[data-v-56f5fbd7]{display:grid;grid-template-columns:120px 1fr;gap:8px 12px}.item[data-v-56f5fbd7]{display:contents}.k[data-v-56f5fbd7]{justify-self:start;align-self:center;font-size:12px;color:#6b7280;background:#f3f4f6;border:1px solid #e5e7eb;padding:4px 8px;border-radius:8px;font-weight:700}.v[data-v-56f5fbd7]{align-self:center;font-family:ui-monospace,Menlo,Consolas,monospace;font-size:12px;color:#111827;background:#fff;border:1px solid #e5e7eb;padding:6px 8px;border-radius:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.glow[data-v-56f5fbd7]{position:absolute;left:12px;right:12px;top:-1px;height:3px;border-radius:999px;background:linear-gradient(90deg,#60a5fa,#a78bfa,#34d399,#f472b6);filter:blur(0.4px)}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/era-panel/parts/MetaHeader.vue'],names:[],mappings:'AA8CA,uBACE,iBAAkB,CAClB,sBAAuB,CACvB,iCAAqC,CACrC,kBAAmB,CACnB,kDAAqD,CACrD,yDAGF,CACA,6BACE,eAAgB,CAChB,cAAe,CACf,eAAgB,CAChB,aACF,CAEA,qBACE,YAAa,CACb,+BAAgC,CAChC,YACF,CACA,uBACE,gBACF,CACA,oBACE,kBAAmB,CACnB,iBAAkB,CAClB,cAAe,CACf,aAAc,CACd,kBAAmB,CACnB,wBAAyB,CACzB,eAAgB,CAChB,iBAAkB,CAClB,eACF,CACA,oBACE,iBAAkB,CAClB,iDAAqD,CACrD,cAAe,CACf,aAAc,CACd,eAAgB,CAChB,wBAAyB,CACzB,eAAgB,CAChB,iBAAkB,CAClB,eAAgB,CAChB,sBAAuB,CACvB,kBACF,CAGA,uBACE,iBAAkB,CAClB,SAAU,CACV,UAAW,CACX,QAAS,CACT,UAAW,CACX,mBAAoB,CACpB,iEAAsE,CACtE,kBACF',sourcesContent:['<template>\n  <section class="meta">\n    <h4 class="meta-title">æœ€æ–°æ¶ˆæ¯å…ƒæ•°æ®</h4>\n    \x3c!-- å°èŠ‚æ ‡é¢˜ --\x3e\n    <div class="kv">\n      <div class="item">\n        <span class="k">mk</span>\n        \x3c!-- é”®ï¼šmk --\x3e\n        <span class="v" :title="mk">{{ mk || \'â€”\' }}</span>\n        \x3c!-- å€¼ï¼šmk --\x3e\n      </div>\n      <div class="item">\n        <span class="k">message_id</span>\n        \x3c!-- é”®ï¼šmessage_id --\x3e\n        <span class="v">{{ messageId ?? \'â€”\' }}</span>\n        \x3c!-- å€¼ï¼šmessage_id --\x3e\n      </div>\n    </div>\n    <div class="glow"></div>\n    \x3c!-- è£…é¥°ï¼šæµå…‰æ¡ --\x3e\n  </section>\n</template>\n\n<script setup lang="ts">\nimport { onMounted, watch } from \'vue\';\nimport { Logger } from \'../../../../utils/log\';\n\nconst logger = new Logger(\'ui-MetaHeader\');\n\n// æ¥æ”¶çˆ¶ç»„ä»¶ä¼ å…¥çš„ä¸¤ä¸ªå­—æ®µ\nconst props = defineProps<{ mk: string; messageId: number }>(); // ç®€å•çš„åªè¯»å±•ç¤º\n\nonMounted(() => {\n  logger.log(\'onMounted\', \'ç»„ä»¶å·²æŒ‚è½½\', { props });\n});\n\nwatch(\n  () => props,\n  newProps => {\n    logger.debug(\'watch:props\', \'Props å‘ç”Ÿå˜åŒ–\', { newProps });\n  },\n  { deep: true },\n);\n<\/script>\n\n<style scoped>\n.meta {\n  position: relative;\n  padding: 12px 12px 14px;\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 12px;\n  background: linear-gradient(180deg, #ffffff, #f9fafb);\n  box-shadow:\n    0 6px 18px rgba(0, 0, 0, 0.06),\n    inset 0 1px 0 #fff;\n}\n.meta-title {\n  margin: 0 0 10px;\n  font-size: 13px;\n  font-weight: 800;\n  color: #374151;\n}\n\n.kv {\n  display: grid;\n  grid-template-columns: 120px 1fr;\n  gap: 8px 12px;\n}\n.item {\n  display: contents;\n}\n.k {\n  justify-self: start;\n  align-self: center;\n  font-size: 12px;\n  color: #6b7280;\n  background: #f3f4f6;\n  border: 1px solid #e5e7eb;\n  padding: 4px 8px;\n  border-radius: 8px;\n  font-weight: 700;\n}\n.v {\n  align-self: center;\n  font-family: ui-monospace, Menlo, Consolas, monospace;\n  font-size: 12px;\n  color: #111827;\n  background: #fff;\n  border: 1px solid #e5e7eb;\n  padding: 6px 8px;\n  border-radius: 8px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n/* é¡¶éƒ¨æµå…‰è£…é¥° */\n.glow {\n  position: absolute;\n  left: 12px;\n  right: 12px;\n  top: -1px;\n  height: 3px;\n  border-radius: 999px;\n  background: linear-gradient(90deg, #60a5fa, #a78bfa, #34d399, #f472b6);\n  filter: blur(0.4px);\n}\n</style>\n'],sourceRoot:''}]);const s=i},54:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t='',a=void 0!==n[5];return n[4]&&(t+='@supports ('.concat(n[4],') {')),n[2]&&(t+='@media '.concat(n[2],' {')),a&&(t+='@layer'.concat(n[5].length>0?' '.concat(n[5]):'',' {')),t+=e(n),a&&(t+='}'),n[2]&&(t+='}'),n[4]&&(t+='}'),t}).join('')},n.i=function(e,t,a,r,o){'string'==typeof e&&(e=[[null,e,void 0]]);var i={};if(a)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(i[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);a&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]='@layer'.concat(d[5].length>0?' '.concat(d[5]):'',' {').concat(d[1],'}')),d[5]=o),t&&(d[2]?(d[1]='@media '.concat(d[2],' {').concat(d[1],'}'),d[2]=t):d[2]=t),r&&(d[4]?(d[1]='@supports ('.concat(d[4],') {').concat(d[1],'}'),d[4]=r):d[4]=''.concat(r)),n.push(d))}},n}},58:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.tabs[data-v-7ab146e6]{margin-top:12px;border:1px solid rgba(0,0,0,0.06);border-radius:12px;overflow:hidden;background:linear-gradient(180deg,#fff,#fafafa)}.tab-bar[data-v-7ab146e6]{display:flex;gap:8px;padding:8px;border-bottom:1px solid rgba(0,0,0,0.06);background:linear-gradient(180deg,#f9fafb,#f3f4f6)}.tab-btn[data-v-7ab146e6]{padding:8px 12px;font-weight:800;font-size:13px;color:#6b7280;background:#fff;border:1px solid #e5e7eb;border-radius:10px;cursor:pointer}.tab-btn.active[data-v-7ab146e6]{color:#111827;border-color:#93c5fd;box-shadow:inset 0 1px 0 #fff,0 0 0 3px rgba(147,197,253,0.35)}.tab-content[data-v-7ab146e6]{padding:10px 12px;background:rgba(255,255,255,0.86)}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/era-panel/parts/TabSwitch.vue'],names:[],mappings:'AA+DA,uBACE,eAAgB,CAChB,iCAAqC,CACrC,kBAAmB,CACnB,eAAgB,CAChB,+CACF,CACA,0BACE,YAAa,CACb,OAAQ,CACR,WAAY,CACZ,wCAA4C,CAC5C,kDACF,CACA,0BACE,gBAAiB,CACjB,eAAgB,CAChB,cAAe,CACf,aAAc,CACd,eAAgB,CAChB,wBAAyB,CACzB,kBAAmB,CACnB,cACF,CACA,iCACE,aAAc,CACd,oBAAqB,CACrB,8DAGF,CACA,8BACE,iBAAkB,CAClB,iCACF',sourcesContent:['<template>\n  <section class="tabs">\n    \x3c!-- é¡µç­¾è¡Œ --\x3e\n    <div class="tab-bar" role="tablist">\n      <button\n        v-for="t in tabs"\n        :key="t.key"\n        class="tab-btn"\n        :class="{ active: t.key === innerActive }"\n        role="tab"\n        @click="setActive(t.key)"\n      >\n        {{ t.label }}\n      </button>\n    </div>\n\n    \x3c!-- å†…å®¹åŒºï¼šæ ¹æ®æ´»åŠ¨é”®æ¸²æŸ“å¯¹åº”æ’æ§½ --\x3e\n    <div class="tab-content">\n      <div v-if="innerActive === \'pure\'">\n        <slot name="pure" />\n        \x3c!-- çº¯å‡€çŠ¶æ€æ•°æ®å†…å®¹ --\x3e\n      </div>\n      <div v-else>\n        <slot name="full" />\n        \x3c!-- å®Œæ•´çŠ¶æ€æ•°æ®å†…å®¹ --\x3e\n      </div>\n    </div>\n  </section>\n</template>\n\n<script setup lang="ts">\nimport { onMounted, ref, watch } from \'vue\'; // å¼•å…¥å“åº”å¼å·¥å…·\nimport { Logger } from \'../../../../utils/log\';\n\ntype TabItem = { key: \'pure\' | \'full\'; label: string }; // Tab é¡¹ç±»å‹\n\nconst logger = new Logger(\'ui-TabSwitch\');\nconst props = defineProps<{ tabs: TabItem[]; active?: \'pure\' | \'full\' }>(); // è¾“å…¥ tabs ä¸å¯é€‰ active\nconst emit = defineEmits<{ \'update:active\': [\'pure\' | \'full\'] }>(); // v-model:active\n\nconst innerActive = ref<\'pure\' | \'full\'>(props.active ?? \'pure\'); // å†…éƒ¨æ´»åŠ¨é”®\n\nwatch(\n  () => props.active,\n  v => {\n    if (v) {\n      logger.debug(\'watch:active\', `å¤–éƒ¨åŒæ­¥ active tab ä¸º: ${v}`);\n      innerActive.value = v;\n    }\n  },\n); // å¤–éƒ¨å˜æ›´æ—¶åŒæ­¥\nfunction setActive(k: \'pure\' | \'full\') {\n  logger.log(\'setActive\', `ç”¨æˆ·ç‚¹å‡»ï¼Œåˆ‡æ¢ tab åˆ°: ${k}`);\n  innerActive.value = k;\n  emit(\'update:active\', k);\n} // åˆ‡æ¢å¹¶æŠ›å‡º\n\nonMounted(() => {\n  logger.log(\'onMounted\', \'ç»„ä»¶å·²æŒ‚è½½\', { props });\n});\n<\/script>\n\n<style scoped>\n.tabs {\n  margin-top: 12px;\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 12px;\n  overflow: hidden;\n  background: linear-gradient(180deg, #fff, #fafafa);\n}\n.tab-bar {\n  display: flex;\n  gap: 8px;\n  padding: 8px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.06);\n  background: linear-gradient(180deg, #f9fafb, #f3f4f6);\n}\n.tab-btn {\n  padding: 8px 12px;\n  font-weight: 800;\n  font-size: 13px;\n  color: #6b7280;\n  background: #fff;\n  border: 1px solid #e5e7eb;\n  border-radius: 10px;\n  cursor: pointer;\n}\n.tab-btn.active {\n  color: #111827;\n  border-color: #93c5fd;\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 0 0 3px rgba(147, 197, 253, 0.35);\n}\n.tab-content {\n  padding: 10px 12px;\n  background: rgba(255, 255, 255, 0.86);\n}\n</style>\n'],sourceRoot:''}]);const s=i},66:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.acc[data-v-cb8a53de]{border:1px solid rgba(0,0,0,0.06);border-radius:12px;background:linear-gradient(180deg,#fff,#fafafa);overflow:hidden}.acc-head[data-v-cb8a53de]{width:100%;display:flex;align-items:center;gap:10px;background:linear-gradient(180deg,#f9fafb,#f3f4f6);border-bottom:1px solid rgba(0,0,0,0.06);padding:10px 12px;cursor:pointer;font-weight:800;color:#374151}.caret[data-v-cb8a53de]{transition:transform 0.18s ease}.caret.open[data-v-cb8a53de]{transform:rotate(90deg)}.title[data-v-cb8a53de]{font-size:13px}.spacer[data-v-cb8a53de]{flex:1}.hint[data-v-cb8a53de]{font-size:12px;color:#6b7280}.acc-body[data-v-cb8a53de]{display:grid;grid-template-rows:0fr;transition:grid-template-rows 0.28s ease;background:rgba(255,255,255,0.82)}.acc-body.open[data-v-cb8a53de]{grid-template-rows:1fr}.inner[data-v-cb8a53de]{overflow:hidden;transition:padding 0.28s ease,visibility 0s 0.28s;padding:0 12px;visibility:hidden}.acc-body.open .inner[data-v-cb8a53de]{padding:10px 12px;visibility:visible;transition-delay:0s}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/era-panel/parts/EraAccordion.vue'],names:[],mappings:'AAkCA,sBACE,iCAAqC,CACrC,kBAAmB,CACnB,+CAAkD,CAClD,eACF,CAEA,2BACE,UAAW,CACX,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,kDAAqD,CACrD,wCAA4C,CAC5C,iBAAkB,CAClB,cAAe,CACf,eAAgB,CAChB,aACF,CACA,wBACE,+BACF,CACA,6BACE,uBACF,CACA,wBACE,cACF,CACA,yBACE,MACF,CACA,uBACE,cAAe,CACf,aACF,CAEA,2BACE,YAAa,CACb,sBAAuB,CACvB,wCAAyC,CACzC,iCACF,CACA,gCACE,sBACF,CAEA,wBACE,eAAgB,CAEhB,iDAEqB,CACrB,cAAe,CACf,iBACF,CACA,uCACE,iBAAkB,CAClB,kBAAmB,CACnB,mBACF',sourcesContent:['<template>\n  <section class="acc">\n    \x3c!-- æŠ˜å å¤´ï¼šç‚¹å‡»åˆ‡æ¢ --\x3e\n    <button class="acc-head" :aria-expanded="open ? \'true\' : \'false\'" @click="open = !open">\n      <span class="caret" :class="{ open }">â–¸</span>\n      \x3c!-- æŒ‡ç¤ºç®­å¤´ --\x3e\n      <span class="title">{{ title }}</span>\n      \x3c!-- æ ‡é¢˜æ–‡æœ¬ --\x3e\n      <span class="spacer"></span>\n      \x3c!-- å¼¹æ€§ç©ºéš™ --\x3e\n      <span class="hint">{{ open ? \'æ”¶èµ·\' : \'å±•å¼€\' }}</span>\n      \x3c!-- å³ä¾§æç¤º --\x3e\n    </button>\n\n    \x3c!-- å†…å®¹ï¼šé«˜åº¦è¿‡æ¸¡ï¼ˆä½¿ç”¨ CSS Gridï¼‰ --\x3e\n    <div class="acc-body" :class="{ open }">\n      <div class="inner">\n        <slot />\n      </div>\n    </div>\n  </section>\n</template>\n\n<script setup lang="ts">\nimport { ref } from \'vue\';\n\nconst props = withDefaults(defineProps<{ title: string; defaultOpen?: boolean }>(), {\n  defaultOpen: false,\n});\n\nconst open = ref<boolean>(props.defaultOpen);\n<\/script>\n\n<style scoped>\n.acc {\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 12px;\n  background: linear-gradient(180deg, #fff, #fafafa);\n  overflow: hidden;\n}\n\n.acc-head {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  background: linear-gradient(180deg, #f9fafb, #f3f4f6);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.06);\n  padding: 10px 12px;\n  cursor: pointer;\n  font-weight: 800;\n  color: #374151;\n}\n.caret {\n  transition: transform 0.18s ease;\n}\n.caret.open {\n  transform: rotate(90deg);\n}\n.title {\n  font-size: 13px;\n}\n.spacer {\n  flex: 1;\n}\n.hint {\n  font-size: 12px;\n  color: #6b7280;\n}\n\n.acc-body {\n  display: grid;\n  grid-template-rows: 0fr;\n  transition: grid-template-rows 0.28s ease;\n  background: rgba(255, 255, 255, 0.82);\n}\n.acc-body.open {\n  grid-template-rows: 1fr;\n}\n\n.inner {\n  overflow: hidden;\n  /* Add transitions for padding and visibility */\n  transition:\n    padding 0.28s ease,\n    visibility 0s 0.28s; /* Hide after the collapse transition ends */\n  padding: 0 12px;\n  visibility: hidden;\n}\n.acc-body.open .inner {\n  padding: 10px 12px;\n  visibility: visible;\n  transition-delay: 0s; /* Show immediately when opening */\n}\n</style>\n'],sourceRoot:''}]);const s=i},98:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.era-panel[data-v-57305d87]{width:min(960px,60vw);height:min(680px,86vh);display:flex;flex-direction:column;background:linear-gradient(180deg,rgba(255,255,255,0.75),rgba(255,255,255,0.65));border:1px solid rgba(255,255,255,0.6);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 10px 40px rgba(0,0,0,0.18),inset 0 1px 0 rgba(255,255,255,0.6);overflow:hidden;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}.panel-top[data-v-57305d87]{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid rgba(0,0,0,0.06);background:linear-gradient(90deg,rgba(255,255,255,0.65),rgba(255,255,255,0.45))}.panel-title[data-v-57305d87]{font-size:16px;font-weight:800;letter-spacing:0.5px;color:#1f2937}.btn-close[data-v-57305d87]{width:32px;height:32px;line-height:30px;text-align:center;border-radius:8px;border:1px solid rgba(0,0,0,0.08);background:#fff;cursor:pointer;font-size:18px;color:#6b7280;box-shadow:0 2px 8px rgba(0,0,0,0.08)}.btn-close[data-v-57305d87]:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,0.12)}.panel-body[data-v-57305d87]{padding:14px 14px 16px;overflow:auto}.block[data-v-57305d87]{margin:12px 0 4px;padding:10px 12px;background:rgba(255,255,255,0.6);border:1px solid rgba(0,0,0,0.06);border-radius:12px}.block-title[data-v-57305d87]{margin:0 0 8px;font-size:13px;font-weight:800;color:#374151}.chips[data-v-57305d87]{display:flex;flex-wrap:wrap;gap:8px}.chip[data-v-57305d87]{font-size:12px;padding:6px 8px;border:1px solid rgba(0,0,0,0.06);border-radius:999px;background:linear-gradient(180deg,#fafafa,#f4f4f4);color:#6b7280;box-shadow:inset 0 1px 0 #fff}.chip.ok[data-v-57305d87]{color:#065f46;background:linear-gradient(180deg,#ecfdf5,#d1fae5);border-color:#a7f3d0}.mk-strip[data-v-57305d87]{display:flex;gap:8px;flex-wrap:wrap;max-height:140px;overflow:auto}.mk-pill[data-v-57305d87]{display:inline-flex;gap:6px;align-items:center;padding:6px 8px;background:linear-gradient(180deg,#eef2ff,#e0e7ff);color:#4338ca;border:1px solid #c7d2fe;border-radius:8px;font-size:12px}.mk-pill.is-null[data-v-57305d87]{background:linear-gradient(180deg,#f9fafb,#f3f4f6);color:#6b7280;border-color:#e5e7eb}.empty[data-v-57305d87]{height:360px;display:grid;place-items:center;color:#6b7280;font-size:14px;border:1px dashed rgba(0,0,0,0.08);border-radius:12px;background:rgba(255,255,255,0.5)}[data-v-57305d87] button[aria-expanded=\'false\']+*{height:0 !important;padding-top:0 !important;padding-bottom:0 !important;margin-top:0 !important;margin-bottom:0 !important;border-top-width:0 !important;border-bottom-width:0 !important;overflow:clip !important;contain:paint !important}[data-v-57305d87] button[aria-expanded=\'true\']+*{overflow:visible}.era-shell[data-v-57305d87]{display:flex;align-items:flex-start;gap:12px;flex-wrap:nowrap}.era-panel[data-v-57305d87]{flex:0 1 auto}.right-rail[data-v-57305d87]{width:min(320px,34vw);position:sticky;top:10px;align-self:flex-start;z-index:1}@media (max-width:1100px){.era-shell[data-v-57305d87]{flex-wrap:wrap}.right-rail[data-v-57305d87]{width:100%;position:static;margin-top:8px}}[data-v-57305d87] .floating-ball{position:fixed;right:max(16px,env(safe-area-inset-right));bottom:max(90px,env(safe-area-inset-bottom));z-index:2147483647;pointer-events:auto;touch-action:manipulation;will-change:transform}.era-expanded-layer[data-v-57305d87]{position:fixed;inset:0;display:grid;place-items:center;padding:clamp(12px,2.5vw,24px);pointer-events:auto;z-index:2147483646;background:transparent;overflow:auto}@media (max-width:640px){.era-panel[data-v-57305d87]{width:min(92vw,560px);height:min(88vh,calc(100svh - 32px))}.panel-body[data-v-57305d87]{overscroll-behavior:contain}}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/App.vue'],names:[],mappings:'AAoMA,4BACE,qBAAuB,CACvB,sBAAwB,CACxB,YAAa,CACb,qBAAsB,CACtB,gFAAyF,CACzF,sCAA0C,CAC1C,0BAA2B,CAC3B,kBAAmB,CACnB,2EAEwC,CACxC,eAAgB,CAChB,gEACF,CAEA,4BACE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,iBAAkB,CAClB,wCAA4C,CAC5C,+EACF,CACA,8BACE,cAAe,CACf,eAAgB,CAChB,oBAAqB,CACrB,aACF,CACA,4BACE,UAAW,CACX,WAAY,CACZ,gBAAiB,CACjB,iBAAkB,CAClB,iBAAkB,CAClB,iCAAqC,CACrC,eAAgB,CAChB,cAAe,CACf,cAAe,CACf,aAAc,CACd,qCACF,CACA,kCACE,0BAA2B,CAC3B,sCACF,CAEA,6BACE,sBAAuB,CACvB,aACF,CAEA,wBACE,iBAAkB,CAClB,iBAAkB,CAClB,gCAAoC,CACpC,iCAAqC,CACrC,kBACF,CACA,8BACE,cAAe,CACf,cAAe,CACf,eAAgB,CAChB,aACF,CAEA,wBACE,YAAa,CACb,cAAe,CACf,OACF,CACA,uBACE,cAAe,CACf,eAAgB,CAChB,iCAAqC,CACrC,mBAAoB,CACpB,kDAAqD,CACrD,aAAc,CACd,6BACF,CACA,0BACE,aAAc,CACd,kDAAqD,CACrD,oBACF,CAEA,2BACE,YAAa,CACb,OAAQ,CACR,cAAe,CACf,gBAAiB,CACjB,aACF,CACA,0BACE,mBAAoB,CACpB,OAAQ,CACR,kBAAmB,CACnB,eAAgB,CAChB,kDAAqD,CACrD,aAAc,CACd,wBAAyB,CACzB,iBAAkB,CAClB,cACF,CACA,kCACE,kDAAqD,CACrD,aAAc,CACd,oBACF,CAEA,wBACE,YAAa,CACb,YAAa,CACb,kBAAmB,CACnB,aAAc,CACd,cAAe,CACf,kCAAsC,CACtC,kBAAmB,CACnB,gCACF,CAIA,kDACE,mBAAoB,CACpB,wBAAyB,CACzB,2BAA4B,CAC5B,uBAAwB,CACxB,0BAA2B,CAC3B,6BAA8B,CAC9B,gCAAiC,CACjC,wBAAyB,CACzB,wBACF,CAGA,iDACE,gBACF,CAGA,4BAEE,YAAa,CACb,sBAAuB,CACvB,QAAS,CACT,gBACF,CAGA,4BAEE,aACF,CAGA,6BAEE,qBAAuB,CACvB,eAAgB,CAChB,QAAS,CACT,qBAAsB,CACtB,SACF,CAGA,0BAEE,4BAEE,cACF,CACA,6BAEE,UAAW,CACX,eAAgB,CAChB,cACF,CACF,CAGA,iCAEE,cAAe,CACf,0CAA4C,CAC5C,4CAA8C,CAC9C,kBAAmB,CACnB,mBAAoB,CACpB,yBAA0B,CAC1B,qBACF,CAGA,qCAEE,cAAe,CACf,OAAQ,CACR,YAAa,CACb,kBAAmB,CACnB,8BAAiC,CACjC,mBAAoB,CACpB,kBAAmB,CACnB,sBAAuB,CACvB,aACF,CAGA,yBAEE,4BAEE,qBAAuB,CACvB,oCACF,CACA,6BAEE,2BACF,CACF',sourcesContent:['<template>\n  <div class="era-app-container">\n    <FloatingBall v-show="currentComponent === \'FloatingBall\'" @click="requestSwitchView(\'ExpandedView\')" />\n    <div v-show="currentComponent === \'ExpandedView\'" class="era-expanded-layer">\n      \x3c!-- è§†å£çº§å±•å¼€å±‚ï¼šæ‚¬æµ®æ¨¡æ€å®¹å™¨ --\x3e\n      <div class="era-shell">\n        \x3c!-- æ–°å¢æ¨ªå‘å£³å®¹å™¨ï¼šå·¦é¢æ¿ + å³ä¾§æ  --\x3e\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ¨ªå‘å¸ƒå±€å®¹å™¨ --\x3e\n        <div class="era-panel">\n          \x3c!-- ä¿æŒé¢æ¿åŸæœ‰ç»“æ„ä¸å˜ --\x3e\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå·¦ä¾§ ERA é¢æ¿ --\x3e\n          \x3c!-- é¡¶éƒ¨æ ï¼šæ ‡é¢˜ + å…³é—­æŒ‰é’® --\x3e\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé¢æ¿é¡¶éƒ¨ --\x3e\n          <header class="panel-top">\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé¡¶æ  --\x3e\n            <h3 class="panel-title">ERA æ•°æ®é¢æ¿</h3>\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ ‡é¢˜ --\x3e\n            <button class="btn-close" aria-label="å…³é—­" @click="requestSwitchView(\'FloatingBall\')">Ã—</button>\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå…³é—­æŒ‰é’® --\x3e\n          </header>\n\n          \x3c!-- å†…å®¹åŒºï¼ˆåŸæ ·ä¿ç•™ï¼‰ --\x3e\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé¢æ¿ä¸»ä½“ --\x3e\n          <div class="panel-body">\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå¯æ»šåŠ¨å†…å®¹ --\x3e\n            <template v-if="dataRef">\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæœ‰æ•°æ®åˆ™æ¸²æŸ“ --\x3e\n              <MetaHeader :mk="dataRef.mk" :message-id="dataRef.message_id" />\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæœ€æ–°æ¶ˆæ¯å…ƒæ•°æ® --\x3e\n\n              <EraAccordion title="ERA æœ€æ–°æ“ä½œè¯¦æƒ…" :default-open="false">\n                \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå¤–å±‚æŠ˜å  --\x3e\n                <template #default>\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ --\x3e\n                  <div style="display: flex; flex-direction: column; gap: 8px">\n                    \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå †å ä¸¤ä¸ªå­æŠ˜å  --\x3e\n                    <EraAccordion title="SelectedMksï¼ˆæ•°ç»„ï¼‰" :default-open="false">\n                      \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå­æŠ˜å 1 --\x3e\n                      <template #default>\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ --\x3e\n                        <PrettyJsonViewer :value="dataRef.selectedMks" :default-collapsed="true" :max-depth="3" />\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                      </template>\n                    </EraAccordion>\n                    <EraAccordion title="EditLogsï¼ˆå¯¹è±¡ï¼‰" :default-open="false">\n                      \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå­æŠ˜å 2 --\x3e\n                      <template #default>\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ --\x3e\n                        <PrettyJsonViewer :value="dataRef.editLogs" :default-collapsed="true" :max-depth="2" />\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                      </template>\n                    </EraAccordion>\n                  </div>\n                </template>\n              </EraAccordion>\n\n              <TabSwitch v-model:active="activeTab" :tabs="tabs">\n                \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé€‰é¡¹å¡ --\x3e\n                <template #pure>\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šçº¯å‡€çŠ¶æ€æ•°æ® --\x3e\n                  <PrettyJsonViewer :value="dataRef.statWithoutMeta" :default-collapsed="true" :max-depth="Infinity" />\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                </template>\n                <template #full>\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå®Œæ•´çŠ¶æ€æ•°æ® --\x3e\n                  <PrettyJsonViewer :value="dataRef.stat" :default-collapsed="true" :max-depth="Infinity" />\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                </template>\n              </TabSwitch>\n            </template>\n\n            <template v-else>\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæš‚æ— æ•°æ®å ä½ --\x3e\n              <div class="empty">ç­‰å¾… era:writeDone äº‹ä»¶æ•°æ®â€¦</div>\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå ä½æç¤º --\x3e\n            </template>\n          </div>\n        </div>\n\n        \x3c!-- å³ä¾§å›ºå®šæ ï¼šåªæ”¹å˜â€œä½ç½®/å¤–éƒ¨ç»“æ„â€ï¼Œä¸æ”¹æŒ‰é’®é€»è¾‘ --\x3e\n        <aside class="right-rail">\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå³ä¾§æ å®¹å™¨ --\x3e\n          <ActionButtons />\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ“ä½œæŒ‰é’®ç»„ä»¶ï¼ˆäº‹ä»¶ä¿æŒä¸å˜ï¼‰ --\x3e\n          <EraSettingsPanel />\n        </aside>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { computed, onMounted, ref, watch } from \'vue\';\nimport { Logger } from \'../utils/log\';\nimport ActionButtons from \'./components/ActionButtons.vue\';\nimport EraSettingsPanel from \'./components/EraSettingsPanel.vue\';\nimport FloatingBall from \'./components/FloatingBall.vue\';\n\n// ä» EraDataPanel è¿ç§»è¿‡æ¥çš„ imports\nimport EraAccordion from \'./components/era-panel/parts/EraAccordion.vue\';\nimport MetaHeader from \'./components/era-panel/parts/MetaHeader.vue\';\nimport PrettyJsonViewer from \'./components/era-panel/parts/PrettyJsonViewer.vue\';\nimport TabSwitch from \'./components/era-panel/parts/TabSwitch.vue\';\n\n// ä» EraDataPanel è¿ç§»è¿‡æ¥çš„ç±»å‹å®šä¹‰\ntype Actions = { rollback: boolean; apply: boolean; resync: boolean; api: boolean; apiWrite: boolean };\nexport interface WriteDonePayload {\n  mk: string;\n  message_id: number;\n  actions: Actions;\n  selectedMks: (string | null)[];\n  editLogs: Record<string, any[]>;\n  stat: any;\n  statWithoutMeta: any;\n  consecutiveProcessingCount: number;\n}\n\n// TabSwitch éœ€è¦çš„ç±»å‹\ntype TabItem = { key: \'pure\' | \'full\'; label: string };\n\nconst logger = new Logger(\'ui-App\');\n\n// App.vue åŸæœ‰çš„ props\nconst props = defineProps({\n  initialView: {\n    type: String,\n    required: true,\n    default: \'FloatingBall\',\n  },\n  eventData: {\n    type: Object as () => WriteDonePayload | null,\n    default: () => null,\n  },\n});\n\n// App.vue åŸæœ‰çš„é€»è¾‘\nconst currentComponent = ref(props.initialView);\nconst requestSwitchView = (viewName: \'FloatingBall\' | \'ExpandedView\') => {\n  logger.debug(\'requestSwitchView\', `è¯·æ±‚åˆ‡æ¢è§†å›¾åˆ°: ${viewName}`);\n  if ((window as any).eraUiSwitchView) {\n    (window as any).eraUiSwitchView(viewName);\n  } else {\n    logger.warn(\'requestSwitchView\', \'å…¨å±€åˆ‡æ¢å‡½æ•° eraUiSwitchView æœªæ‰¾åˆ°\');\n  }\n};\n\n// ä» EraDataPanel è¿ç§»è¿‡æ¥çš„é€»è¾‘\nconst dataRef = computed(() => props.eventData || null);\n\nconst tabs: TabItem[] = [\n  { key: \'pure\', label: \'çº¯å‡€çŠ¶æ€æ•°æ®\' },\n  { key: \'full\', label: \'å®Œæ•´çŠ¶æ€æ•°æ®\' },\n];\nconst activeTab = ref<\'pure\' | \'full\'>(\'pure\');\n\nonMounted(() => {\n  logger.log(\'onMounted\', \'App.vue ç»„ä»¶å·²æŒ‚è½½\', { props: props });\n});\n\nwatch(\n  () => props.eventData,\n  (newData, oldData) => {\n    logger.debug(\'watch:eventData\', \'eventData prop å‘ç”Ÿå˜åŒ–\', {\n      newData,\n      oldData,\n    });\n  },\n  { deep: true },\n);\n\nwatch(\n  () => props.initialView,\n  newView => {\n    logger.debug(\'watch:initialView\', `initialView prop å‘ç”Ÿå˜åŒ–ï¼Œæ–°è§†å›¾: ${newView}`);\n    currentComponent.value = newView;\n  },\n);\n<\/script>\n\n<style>\n/* App.vue è§†å£çº§æ‚¬æµ®å®¹å™¨ï¼ˆæ›¿æ¢åŸæœ‰ .era-app-containerï¼‰ */\n.era-app-container {\n  /* ä½œä¸ºå…¨å±€æ‚¬æµ®å±‚æ ¹å®¹å™¨ */\n  position: fixed; /* å›ºå®šåœ¨è§†å£ï¼Œä¸å—å¤–å±‚å¸ƒå±€å½±å“ */\n  inset: 0; /* è¦†ç›–æ•´ä¸ªè§†å£åŒºåŸŸï¼ˆtop/right/bottom/left å…¨ 0ï¼‰ */\n  z-index: 2147483646; /* è¶…é«˜å±‚çº§ï¼Œç›–ä½ç«™ç‚¹å…¶å®ƒå±‚ */\n  pointer-events: none; /* é»˜è®¤ä¸æˆªè·ç‚¹å‡»ï¼Œé¿å…é˜»æŒ¡é¡µé¢ */\n  isolation: isolate; /* æ–°å»ºç‹¬ç«‹å±‚å ä¸Šä¸‹æ–‡ï¼Œé˜²æ­¢è¢«å¤–å±‚æ··åˆå½±å“ */\n  contain: layout style paint; /* åˆ›å»ºæ¸²æŸ“å°è£…ï¼Œå‡å°‘å¤–ç•Œå¹²æ‰° */\n  width: 100svw; /* é€‚é…ç§»åŠ¨ç«¯åŠ¨æ€è§†å£å®½åº¦ */\n  height: 100svh; /* é€‚é…ç§»åŠ¨ç«¯åŠ¨æ€è§†å£é«˜åº¦ */\n}\n</style>\n\n<style scoped>\n/* ä» EraDataPanel.vue è¿ç§»è¿‡æ¥çš„æ ·å¼ */\n.era-panel {\n  width: min(960px, 60vw);\n  height: min(680px, 86vh);\n  display: flex;\n  flex-direction: column;\n  background: linear-gradient(180deg, rgba(255, 255, 255, 0.75), rgba(255, 255, 255, 0.65));\n  border: 1px solid rgba(255, 255, 255, 0.6);\n  backdrop-filter: blur(10px);\n  border-radius: 16px;\n  box-shadow:\n    0 10px 40px rgba(0, 0, 0, 0.18),\n    inset 0 1px 0 rgba(255, 255, 255, 0.6);\n  overflow: hidden;\n  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;\n}\n\n.panel-top {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 14px 16px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.06);\n  background: linear-gradient(90deg, rgba(255, 255, 255, 0.65), rgba(255, 255, 255, 0.45));\n}\n.panel-title {\n  font-size: 16px;\n  font-weight: 800;\n  letter-spacing: 0.5px;\n  color: #1f2937;\n}\n.btn-close {\n  width: 32px;\n  height: 32px;\n  line-height: 30px;\n  text-align: center;\n  border-radius: 8px;\n  border: 1px solid rgba(0, 0, 0, 0.08);\n  background: #fff;\n  cursor: pointer;\n  font-size: 18px;\n  color: #6b7280;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n}\n.btn-close:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);\n}\n\n.panel-body {\n  padding: 14px 14px 16px;\n  overflow: auto;\n}\n\n.block {\n  margin: 12px 0 4px;\n  padding: 10px 12px;\n  background: rgba(255, 255, 255, 0.6);\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 12px;\n}\n.block-title {\n  margin: 0 0 8px;\n  font-size: 13px;\n  font-weight: 800;\n  color: #374151;\n}\n\n.chips {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n.chip {\n  font-size: 12px;\n  padding: 6px 8px;\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 999px;\n  background: linear-gradient(180deg, #fafafa, #f4f4f4);\n  color: #6b7280;\n  box-shadow: inset 0 1px 0 #fff;\n}\n.chip.ok {\n  color: #065f46;\n  background: linear-gradient(180deg, #ecfdf5, #d1fae5);\n  border-color: #a7f3d0;\n}\n\n.mk-strip {\n  display: flex;\n  gap: 8px;\n  flex-wrap: wrap;\n  max-height: 140px;\n  overflow: auto;\n}\n.mk-pill {\n  display: inline-flex;\n  gap: 6px;\n  align-items: center;\n  padding: 6px 8px;\n  background: linear-gradient(180deg, #eef2ff, #e0e7ff);\n  color: #4338ca;\n  border: 1px solid #c7d2fe;\n  border-radius: 8px;\n  font-size: 12px;\n}\n.mk-pill.is-null {\n  background: linear-gradient(180deg, #f9fafb, #f3f4f6);\n  color: #6b7280;\n  border-color: #e5e7eb;\n}\n\n.empty {\n  height: 360px;\n  display: grid;\n  place-items: center;\n  color: #6b7280;\n  font-size: 14px;\n  border: 1px dashed rgba(0, 0, 0, 0.08);\n  border-radius: 12px;\n  background: rgba(255, 255, 255, 0.5);\n}\n\n/* ===[æ–°å¢] æŠ˜å æ—¶æŠŠâ€œæŒ‰é’®åç´§é‚»çš„å†…å®¹ä½“â€å½»åº•å‹å¹³å¹¶è£å‰ªï¼ˆé€šç”¨è§„åˆ™ï¼‰ === */\n/* é€‚é… EraAccordionï¼šæ ‡é¢˜æŒ‰é’®æœ‰ aria-expandedï¼Œå†…å®¹ä½“æ˜¯ç´§é‚»å…„å¼Ÿå…ƒç´  */\n:deep(button[aria-expanded=\'false\'] + *) {\n  height: 0 !important; /* é«˜åº¦å‹åˆ° 0ï¼Œå½»åº•æ”¶èµ· */\n  padding-top: 0 !important; /* å»æ‰ä¸Šä¸‹å†…è¾¹è·ï¼Œé˜²æ­¢éœ²å‡ºä¸€æ¡è¾¹ */\n  padding-bottom: 0 !important;\n  margin-top: 0 !important; /* å»æ‰ä¸Šä¸‹å¤–è¾¹è·ï¼Œé¿å… margin æŠ˜å ç©¿å‡º */\n  margin-bottom: 0 !important;\n  border-top-width: 0 !important; /* è‹¥å†…å®¹ä½“è‡ªèº«æœ‰åˆ†å‰²çº¿ï¼ŒæŠ˜å æ—¶å»æ‰ */\n  border-bottom-width: 0 !important;\n  overflow: clip !important; /* å…³é”®ï¼šè£å‰ªä¸€åˆ‡å­å†…å®¹ï¼ˆå«è™šçº¿/é˜´å½±ï¼‰ */\n  contain: paint !important; /* é˜²æ­¢å­çº§é˜´å½±/è¾¹æ¡†è¶…å‡ºè£å‰ªè¾¹ç•Œ */\n}\n\n/* å±•å¼€çŠ¶æ€å¯æ¢å¤å¯è§æº¢å‡ºï¼ˆå¦‚æ‚¬æµ®æç¤ºï¼‰ï¼Œé»˜è®¤å³å¯ï¼Œå¯ä¿å®ˆåŠ ä¸€æ¡ï¼š */\n:deep(button[aria-expanded=\'true\'] + *) {\n  overflow: visible; /* å±•å¼€æ—¶æ¢å¤æ­£å¸¸ç»˜åˆ¶ */\n}\n\n/* ===[æ–°å¢] æ¨ªå‘å£³ï¼šå·¦é¢æ¿ + å³ä¾§æ ï¼ˆæŒ‰é’®ï¼‰=== */\n.era-shell {\n  /* æ¨ªå‘åŒ…è£¹å®¹å™¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šæ¨ªå‘æ’åˆ—å®¹å™¨ */\n  display: flex; /* æ¨ªå‘å¸ƒå±€ */ /* ä¸­æ–‡æ³¨é‡Šï¼šflex æ¨ªæ’ */\n  align-items: flex-start; /* é¡¶å¯¹é½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¸Šç¼˜å¯¹é½ */\n  gap: 12px; /* å·¦å³é—´è· */ /* ä¸­æ–‡æ³¨é‡Šï¼šå…ƒç´ é—´è· */\n  flex-wrap: nowrap; /* é»˜è®¤ä¸æ¢è¡Œ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¿æŒå¹¶æ’ */\n}\n\n/* ä¿æŒé¢æ¿å®½é«˜ï¼ˆåŸæ ·ï¼‰ï¼Œä½†è®©å®ƒæ›´å¥½åœ°åœ¨æ¨ªå‘ä¸­è‡ªé€‚åº” */\n.era-panel {\n  /* å·²å­˜åœ¨ï¼šæ­¤å¤„åªè¯´æ˜è¯­ä¹‰ï¼Œä¸åšè¦†ç›– */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¿ç•™åŸæ ·å¼ */\n  flex: 0 1 auto; /* é¢æ¿æŒ‰è‡ªèº«å®½åº¦å¸ƒå±€ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¸å¼ºè¡Œæ‹‰ä¼¸ */\n}\n\n/* å³ä¾§æ å¤–æ¡†ï¼šä¸å·¦é¢æ¿è§†è§‰ç»Ÿä¸€ï¼ˆç»ç’ƒå¡ç‰‡é£ï¼‰ */\n.right-rail {\n  /* å³ä¾§åŒºåŸŸå®¹å™¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¾§æ  */\n  width: min(320px, 34vw); /* å®½åº¦è‡ªé€‚åº”ï¼Œæ¡Œé¢çº¦ 280-320px ä½“éªŒæœ€ä½³ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¾§æ å®½åº¦ */\n  position: sticky; /* ç²˜é™„åœ¨è§†å£å†…æ»šåŠ¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå¸é™„åœ¨è§†å£é¡¶éƒ¨ */\n  top: 10px; /* ä¸é¡¶éƒ¨ç•™ç™½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå¸é¡¶é—´è· */\n  align-self: flex-start; /* ä¸å·¦ä¾§é¢æ¿é¡¶éƒ¨å¯¹é½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šè‡ªèº«å¯¹é½é¡¶éƒ¨ */\n  z-index: 1; /* é¿å…è¢«é¢æ¿é˜´å½±è¦†ç›– */ /* ä¸­æ–‡æ³¨é‡Šï¼šæå‡å±‚çº§ */\n}\n\n/* å°å±å›è½ï¼šæ”¹ä¸ºä¸Šä¸‹å †å ï¼ˆæŒ‰é’®åœ¨ä¸‹ï¼‰ */\n@media (max-width: 1100px) {\n  /* 1100px ä¸‹å›è½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå“åº”å¼æ–­ç‚¹ */\n  .era-shell {\n    /* æ¨ªå‘å®¹å™¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå®¹å™¨ */\n    flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå…è®¸å †å  */\n  }\n  .right-rail {\n    /* ä¾§æ  */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¾§æ  */\n    width: 100%; /* å æ»¡ä¸€è¡Œ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå…¨å®½ */\n    position: static; /* å–æ¶ˆå¸é¡¶ï¼Œé¿å…çª„å±é®æŒ¡ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¸å¸é¡¶ */\n    margin-top: 8px; /* ä¸ä¸Šæ–¹ç•™ç™½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šé—´è· */\n  }\n}\n\n/* ===[æ–°å¢] æ‚¬æµ®çƒï¼šå›ºå®šåœ¨å³ä¸‹è§’ + å¼€å¯ç‚¹å‡» === */\n:deep(.floating-ball) {\n  /* é€‰ä¸­å­ç»„ä»¶æ ¹å…ƒç´ ï¼ˆscoped ä¸‹ç”¨ deepï¼‰ */\n  position: fixed; /* å›ºå®šå®šä½åˆ°è§†å£ */\n  right: max(16px, env(safe-area-inset-right)); /* å³ä¾§å®‰å…¨åŒº + åŸºç¡€è¾¹è· */\n  bottom: max(90px, env(safe-area-inset-bottom)); /* åº•éƒ¨å®‰å…¨åŒº + åŸºç¡€è¾¹è· */\n  z-index: 2147483647; /* é«˜äºå®¹å™¨æ ¹ï¼Œç¡®ä¿å§‹ç»ˆå¯ç‚¹ */\n  pointer-events: auto; /* å¯ç”¨ç‚¹å‡»ï¼ˆçˆ¶å®¹å™¨æ˜¯ noneï¼‰ */\n  touch-action: manipulation; /* ç§»åŠ¨ç«¯å‡å°‘ç‚¹å‡»å»¶è¿Ÿ */\n  will-change: transform; /* æå‰åˆ†å±‚ï¼Œé¿å…ç«™ç‚¹ 3D/æ»¤é•œå½±å“ */\n}\n\n/* ===[æ–°å¢] å±•å¼€å±‚ï¼šè§†å£çº§æ¨¡æ€å®¹å™¨ï¼ˆåªåœ¨ ExpandedView v-show ä¸º true æ—¶å­˜åœ¨ï¼‰ === */\n.era-expanded-layer {\n  /* ç»‘å®šåœ¨æ¨¡æ¿æ–°å¢çš„ class */\n  position: fixed; /* å›ºå®šåœ¨è§†å£ï¼ˆä¸å—å¤–å±‚å¸ƒå±€çº¦æŸï¼‰ */\n  inset: 0; /* é“ºæ»¡è§†å£ */\n  display: grid; /* ç”¨ grid å±…ä¸­å†…å®¹ */\n  place-items: center; /* æ°´å¹³å‚ç›´ç½®ä¸­ */\n  padding: clamp(12px, 2.5vw, 24px); /* è§†å£è‡ªé€‚åº”å†…è¾¹è· */\n  pointer-events: auto; /* å¯ç”¨ç‚¹å‡»ï¼ˆä¸çˆ¶å®¹å™¨çš„ none åŒºåˆ†ï¼‰ */\n  z-index: 2147483646; /* ä»…æ¬¡äºæ‚¬æµ®çƒï¼Œä¿è¯åœ¨æœ€ä¸Šå±‚ */\n  background: transparent; /* å¦‚éœ€åŠé€æ˜é®ç½©å¯æ”¹ä¸º rgba(0,0,0,.25) */\n  overflow: auto; /* å†…å®¹è¶…å‡ºæ—¶ï¼Œå®¹å™¨è‡ªèº«æ»šåŠ¨ï¼Œä¸è¢«è£å‰ª */\n}\n\n/* ===[æ–°å¢] å°å±é€‚é…ï¼šé¢æ¿åœ¨ç§»åŠ¨ç«¯æ›´â€œå¡«å……â€å¯è§†åŒº === */\n@media (max-width: 640px) {\n  /* é’ˆå¯¹æ‰‹æœºå®½åº¦ */\n  .era-panel {\n    /* é‡è®¾é¢æ¿å®½é«˜æ›´è´´åˆæ‰‹æœº */\n    width: min(92vw, 560px); /* æ”¾å®½åˆ° 92vwï¼Œé¿å… 60vw å¤ªçª„ */\n    height: min(88vh, calc(100svh - 32px)); /* å…¼é¡¾çŠ¶æ€æ /åœ°å€æ åŠ¨æ€é«˜åº¦ */\n  }\n  .panel-body {\n    /* ä¸»è¦å†…å®¹åŒºæ»šåŠ¨å®¹å™¨ */\n    overscroll-behavior: contain; /* é˜²æ­¢æ»šåŠ¨ç‰µåŠ¨èƒŒæ™¯é¡µé¢ */\n  }\n}\n</style>\n'],sourceRoot:''}]);const s=i},160:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.json-root[data-v-036df356]{font-size:12px;color:#111827}.json-line[data-v-036df356]{position:relative;display:flex;align-items:center;gap:6px;padding:2px 6px;border-radius:6px}.json-line[data-v-036df356]:hover{background:rgba(59,130,246,0.06)}.json-children[data-v-036df356]{border-left:1px dashed rgba(107,114,128,0.25)}.key[data-v-036df356]{color:#1f2937;font-weight:700}.colon[data-v-036df356]{color:#6b7280}.brace[data-v-036df356]{color:#9ca3af}.val.string[data-v-036df356]{color:#047857}.val.number[data-v-036df356]{color:#7c3aed}.val.boolean[data-v-036df356]{color:#0369a1}.val.null[data-v-036df356]{color:#9ca3af}.val.undefined[data-v-036df356]{color:#9ca3af}.json-root[data-v-036df356]{overflow:clip;contain:layout paint;min-height:0}.json-children[data-v-036df356]{overflow:clip;contain:paint}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/era-panel/parts/PrettyJsonViewer.vue'],names:[],mappings:'AAkIA,4BACE,cAAe,CACf,aACF,CACA,4BACE,iBAAkB,CAClB,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,iBACF,CACA,kCACE,gCACF,CACA,gCACE,6CACF,CAEA,sBACE,aAAc,CACd,eACF,CACA,wBACE,aACF,CACA,wBACE,aACF,CAEA,6BACE,aACF,CACA,6BACE,aACF,CACA,8BACE,aACF,CACA,2BACE,aACF,CACA,gCACE,aACF,CAGA,4BAEE,aAAc,CACd,oBAAqB,CACrB,YACF,CAEA,gCAEE,aAAc,CACd,aACF',sourcesContent:['<template>\n  <div class="json-root">\n    <div class="json-line">\n      <span class="brace">{{ rootOpen }}</span>\n      \x3c!-- æ ¹å¼€æ‹¬å·ï¼šå¯¹è±¡{ / æ•°ç»„[ --\x3e\n    </div>\n\n    <div class="json-children">\n      <template v-if="isPlainObjectOrArray">\n        <JsonNode\n          v-for="(v, k) in value"\n          :key="String(k)"\n          :k="String(k)"\n          :v="v"\n          :path="String(k)"\n          :level="1"\n          :default-collapsed="defaultCollapsed"\n          :max-depth="maxDepth"\n        />\n      </template>\n\n      <template v-else>\n        <div class="json-line" :style="{ paddingLeft: 1 * 14 + \'px\' }">\n          <span class="key">value</span><span class="colon">:</span>\n          <span class="val" :class="primitiveType">{{ primitiveText }}</span>\n        </div>\n      </template>\n    </div>\n\n    <div class="json-line">\n      <span class="brace">{{ rootClose }}</span>\n      \x3c!-- æ ¹é—­æ‹¬å·ï¼šå¯¹è±¡} / æ•°ç»„] --\x3e\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { computed } from \'vue\'; // è®¡ç®—å±æ€§å·¥å…·\nimport { Logger } from \'../../../../utils/log\';\nimport JsonNode from \'./JsonNode.vue\'; // âœ… æ”¹ä¸ºå¯¼å…¥ç‹¬ç«‹ SFC çš„é€’å½’èŠ‚ç‚¹ç»„ä»¶\n\nconst logger = new Logger();\n\nconst props = withDefaults(\n  defineProps<{\n    value: any; // è¦å±•ç¤ºçš„ JSON å€¼\n    defaultCollapsed?: boolean; // é»˜è®¤æ˜¯å¦æŠ˜å \n    maxDepth?: number; // åˆæ¬¡å±•å¼€æœ€å¤§å±‚æ•°\n  }>(),\n  {\n    defaultCollapsed: true, // é»˜è®¤æŠ˜å \n    maxDepth: 3, // é»˜è®¤å±•å¼€åˆ° 3 å±‚\n  },\n);\n\nconst isPlainObjectOrArray = computed(() => {\n  const v = props.value; // å–å…¥å‚å€¼\n  const result = v !== null && typeof v === \'object\'; // ä»…å¯¹è±¡/æ•°ç»„æ‰è¿›å…¥é€é”®æ¸²æŸ“\n  logger.debug(\'isPlainObjectOrArray\', `è®¡ç®—ç»“æœ: ${result}ã€‚è¯¥å€¼${result ? \'æ˜¯\' : \'ä¸æ˜¯\'}æ™®é€šå¯¹è±¡æˆ–æ•°ç»„ã€‚`, {\n    ä¼ å…¥å€¼: v,\n  });\n  return result;\n}); // æ˜¯å¦å¯¹è±¡/æ•°ç»„\n\nconst primitiveType = computed(() => {\n  const v = props.value; // å–å…¥å‚å€¼\n  let result: string;\n  if (v === null) {\n    result = \'null\';\n  } else if (Array.isArray(v)) {\n    result = \'array\'; // æ•°ç»„ï¼ˆä¸ä¼šèµ°åˆ°è¯¥åˆ†æ”¯ï¼Œå› ä¸ºä¸Šé¢ isPlainObjectOrArray åˆ¤æ–­è¿‡ï¼‰\n  } else {\n    const t = typeof v; // åŸå§‹ç±»å‹\n    result = t === \'undefined\' ? \'undefined\' : t;\n  }\n  logger.debug(\'primitiveType\', `è®¡ç®—åŸå§‹å€¼ç±»å‹: ${result}`, { ä¼ å…¥å€¼: v });\n  return result;\n}); // åŸå§‹å€¼ç±»å‹åï¼ˆç”¨äºç€è‰²ï¼‰\n\nconst primitiveText = computed(() => {\n  const v = props.value; // å–å…¥å‚å€¼\n  let result: string;\n  switch (\n    primitiveType.value // æŒ‰ç±»å‹æ ¼å¼åŒ–æ–‡æœ¬\n  ) {\n    case \'string\':\n      result = JSON.stringify(v); // å­—ç¬¦ä¸²å¸¦å¼•å·\n      break;\n    case \'number\':\n      result = String(v); // æ•°å­—\n      break;\n    case \'boolean\':\n      result = v ? \'true\' : \'false\'; // å¸ƒå°”\n      break;\n    case \'null\':\n      result = \'null\'; // null\n      break;\n    case \'undefined\':\n      result = \'undefined\'; // undefined\n      break;\n    case \'bigint\':\n      result = String(v) + \'n\'; // bigint\n      break;\n    case \'symbol\':\n      result = String(v); // symbol\n      break;\n    case \'function\':\n      result = \'Æ’()\'; // å‡½æ•°\n      break;\n    default:\n      result = \'\'; // å…œåº•\n      break;\n  }\n  logger.debug(\'primitiveText\', `æ ¼å¼åŒ–åŸå§‹å€¼æ–‡æœ¬: "${result}"`, {\n    ä¼ å…¥å€¼: v,\n    ç±»å‹: primitiveType.value,\n  });\n  return result;\n}); // åŸå§‹å€¼æ–‡æœ¬\n\nconst isArrayRoot = computed(() => {\n  const result = Array.isArray(props.value);\n  logger.debug(\'isArrayRoot\', `è®¡ç®—æ ¹èŠ‚ç‚¹æ˜¯å¦ä¸ºæ•°ç»„: ${result}`, { ä¼ å…¥å€¼: props.value });\n  return result;\n}); // æ ¹æ˜¯å¦æ•°ç»„\nconst rootOpen = computed(() => (isArrayRoot.value ? \'[\' : \'{\')); // æ ¹å¼€æ‹¬å·\nconst rootClose = computed(() => (isArrayRoot.value ? \']\' : \'}\')); // æ ¹é—­æ‹¬å·\n<\/script>\n\n<style scoped>\n.json-root {\n  font-size: 12px;\n  color: #111827;\n}\n.json-line {\n  position: relative;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 2px 6px;\n  border-radius: 6px;\n}\n.json-line:hover {\n  background: rgba(59, 130, 246, 0.06);\n}\n.json-children {\n  border-left: 1px dashed rgba(107, 114, 128, 0.25);\n}\n\n.key {\n  color: #1f2937;\n  font-weight: 700;\n}\n.colon {\n  color: #6b7280;\n}\n.brace {\n  color: #9ca3af;\n}\n\n.val.string {\n  color: #047857;\n}\n.val.number {\n  color: #7c3aed;\n}\n.val.boolean {\n  color: #0369a1;\n}\n.val.null {\n  color: #9ca3af;\n}\n.val.undefined {\n  color: #9ca3af;\n}\n\n/* ===[æ–°å¢] é˜²æº¢å‡ºï¼šæ ¹ä¸å­å®¹å™¨éƒ½è£å‰ªç»˜åˆ¶ï¼Œé¿å…åœ¨å¤–éƒ¨å®¹å™¨é«˜åº¦ä¸º 0 æ—¶â€œé€å‡ºâ€ === */\n.json-root {\n  /* JSON æ ¹å®¹å™¨ï¼šè‡ªèº«æˆä¸ºä¸€ä¸ªç»˜åˆ¶è¾¹ç•Œ */\n  overflow: clip; /* è£å‰ªä¸€åˆ‡æº¢å‡ºï¼ˆæ¯” hidden æ›´çœæ€§èƒ½ã€æ— æ»šåŠ¨æ¡ï¼‰ */\n  contain: layout paint; /* éš”ç¦»å¸ƒå±€ä¸ç»˜åˆ¶ï¼Œé˜²å¤–éƒ¨é«˜åº¦è®¡ç®—è¯¯å·® */\n  min-height: 0; /* é˜²æ­¢ flex åœºæ™¯ min-content é¡¶é«˜çˆ¶çº§ */\n}\n\n.json-children {\n  /* å­åŒºï¼šåŒæ ·è£å‰ªï¼Œè§£å†³å·¦ä¾§è™šçº¿åœ¨æ”¶èµ·æ—¶å¤–éœ² */\n  overflow: clip; /* å­çº§å†ä¿é™©è£å‰ª */\n  contain: paint; /* è¿›ä¸€æ­¥éš”ç¦»ç»˜åˆ¶ */\n}\n</style>\n'],sourceRoot:''}]);const s=i},242:(e,n,t)=>{var a=t(840);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('232d26b5',a,!1,{ssrId:!0})},249:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.settings-card[data-v-1944c88c]{width:100%;padding:12px;margin-top:12px;background:linear-gradient(180deg,rgba(255,255,255,0.76),rgba(255,255,255,0.62));border:1px solid rgba(255,255,255,0.6);border-radius:16px;backdrop-filter:blur(10px);box-shadow:0 10px 40px rgba(0,0,0,0.16),inset 0 1px 0 rgba(255,255,255,0.6);display:flex;flex-direction:column;gap:10px}.card-header[data-v-1944c88c]{display:flex;align-items:center;justify-content:space-between;padding:8px 10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:linear-gradient(180deg,#fafafa,#f3f4f6);color:#1f2937;font-weight:800;font-size:13px;cursor:pointer;box-shadow:inset 0 1px 0 #fff,0 2px 8px rgba(0,0,0,0.08)}.card-header[data-v-1944c88c]:hover{transform:translateY(-1px);box-shadow:inset 0 1px 0 #fff,0 6px 16px rgba(0,0,0,0.12)}.title[data-v-1944c88c]{pointer-events:none}.chev[data-v-1944c88c]{opacity:0.7}.content[data-v-1944c88c]{display:flex;flex-direction:column;gap:10px}.toolbar[data-v-1944c88c]{display:flex;align-items:center;gap:8px}.spacer[data-v-1944c88c]{flex:1}.mini-btn[data-v-1944c88c]{padding:6px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);background:linear-gradient(180deg,#fafafa,#f3f4f6);cursor:pointer;font-size:12px;font-weight:700;box-shadow:inset 0 1px 0 #fff,0 2px 6px rgba(0,0,0,0.06)}.mini-btn[data-v-1944c88c]:hover{transform:translateY(-1px);box-shadow:inset 0 1px 0 #fff,0 5px 12px rgba(0,0,0,0.1)}.mini-btn.primary[data-v-1944c88c]{background:linear-gradient(180deg,#e0f2fe,#bfdbfe);border-color:#93c5fd;color:#0f172a}.mini-btn.subtle[data-v-1944c88c]{background:linear-gradient(180deg,#f9fafb,#f3f4f6);border-color:#e5e7eb}.vars[data-v-1944c88c]{display:flex;flex-direction:column;gap:8px}.var-row[data-v-1944c88c]{display:grid;grid-template-columns:1fr minmax(120px,1.2fr) auto;align-items:center;gap:10px;padding:8px 10px;border:1px solid rgba(0,0,0,0.06);border-radius:10px;background:linear-gradient(180deg,#ffffff,#f8fafc)}.var-key[data-v-1944c88c]{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:12px;color:#374151;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.var-editor[data-v-1944c88c]{display:flex;align-items:center;gap:8px}.ipt[data-v-1944c88c]{width:100%;padding:8px 10px;border-radius:8px;border:1px solid #e5e7eb;background:#fff;font-size:12px;color:#111827;box-shadow:inset 0 1px 0 #fff}.ta[data-v-1944c88c]{min-height:64px;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}.type-chip[data-v-1944c88c]{font-size:11px;color:#374151;background:#eef2ff;border:1px solid #c7d2fe;border-radius:999px;padding:4px 8px;white-space:nowrap}.switch[data-v-1944c88c]{position:relative;width:42px;height:24px;display:inline-block}.switch input[data-v-1944c88c]{opacity:0;width:0;height:0}.switch .track[data-v-1944c88c]{position:absolute;inset:0;border-radius:999px;background:#e5e7eb;box-shadow:inset 0 1px 0 #fff;transition:background 0.2s ease}.switch .track[data-v-1944c88c]::after{content:\'\';position:absolute;top:3px;left:3px;width:18px;height:18px;border-radius:50%;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.2);transition:transform 0.2s ease}.switch input:checked+.track[data-v-1944c88c]{background:#93c5fd}.switch input:checked+.track[data-v-1944c88c]::after{transform:translateX(18px)}.hint[data-v-1944c88c]{font-size:11px;color:#6b7280}.hint.ok[data-v-1944c88c]{color:#065f46}.hint.bad[data-v-1944c88c]{color:#b91c1c}.placeholder[data-v-1944c88c]{padding:10px;color:#6b7280;font-size:12px;border:1px dashed rgba(0,0,0,0.08);border-radius:10px;background:rgba(255,255,255,0.5)}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/EraSettingsPanel.vue'],names:[],mappings:'AA0PA,gCAEE,UAAW,CACX,YAAa,CACb,eAAgB,CAChB,gFAAyF,CACzF,sCAA0C,CAC1C,kBAAmB,CACnB,0BAA2B,CAC3B,2EAEwC,CACxC,YAAa,CACb,qBAAsB,CACtB,QACF,CAGA,8BAEE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,gBAAiB,CACjB,kBAAmB,CACnB,iCAAqC,CACrC,kDAAqD,CACrD,aAAc,CACd,eAAgB,CAChB,cAAe,CACf,cAAe,CACf,wDAGF,CACA,oCACE,0BAA2B,CAC3B,yDAGF,CACA,wBACE,mBACF,CACA,uBACE,WACF,CAGA,0BACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAGA,0BACE,YAAa,CACb,kBAAmB,CACnB,OACF,CACA,yBACE,MACF,CAEA,2BAEE,gBAAiB,CACjB,iBAAkB,CAClB,iCAAqC,CACrC,kDAAqD,CACrD,cAAe,CACf,cAAe,CACf,eAAgB,CAChB,wDAGF,CACA,iCACE,0BAA2B,CAC3B,wDAGF,CACA,mCACE,kDAAqD,CACrD,oBAAqB,CACrB,aACF,CACA,kCACE,kDAAqD,CACrD,oBACF,CAGA,uBACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,0BAEE,YAAa,CACb,kDAAoD,CACpD,kBAAmB,CACnB,QAAS,CACT,gBAAiB,CACjB,iCAAqC,CACrC,kBAAmB,CACnB,kDACF,CACA,0BACE,gEAAqE,CACrE,cAAe,CACf,aAAc,CACd,eAAgB,CAChB,sBAAuB,CACvB,kBACF,CACA,6BACE,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,sBAEE,UAAW,CACX,gBAAiB,CACjB,iBAAkB,CAClB,wBAAyB,CACzB,eAAgB,CAChB,cAAe,CACf,aAAc,CACd,6BACF,CACA,qBACE,eAAgB,CAChB,gEACF,CAEA,4BAEE,cAAe,CACf,aAAc,CACd,kBAAmB,CACnB,wBAAyB,CACzB,mBAAoB,CACpB,eAAgB,CAChB,kBACF,CAGA,yBACE,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,oBACF,CACA,+BACE,SAAU,CACV,OAAQ,CACR,QACF,CACA,gCACE,iBAAkB,CAClB,OAAQ,CACR,mBAAoB,CACpB,kBAAmB,CACnB,6BAA8B,CAC9B,+BACF,CACA,uCACE,UAAW,CACX,iBAAkB,CAClB,OAAQ,CACR,QAAS,CACT,UAAW,CACX,WAAY,CACZ,iBAAkB,CAClB,eAAgB,CAChB,oCAAwC,CACxC,8BACF,CACA,8CACE,kBACF,CACA,qDACE,0BACF,CAEA,uBACE,cAAe,CACf,aACF,CACA,0BACE,aACF,CACA,2BACE,aACF,CAEA,8BACE,YAAa,CACb,aAAc,CACd,cAAe,CACf,kCAAsC,CACtC,kBAAmB,CACnB,gCACF',sourcesContent:['<template>\n  \x3c!-- å¤–å±‚å¡ç‰‡ï¼šä¸ ActionButtons ä¿æŒä¸€è‡´çš„ç»ç’ƒå¡é£æ ¼ï¼Œä½†é»˜è®¤æ”¶èµ· --\x3e\n  <section class="settings-card" role="region" aria-label="ERA è®¾ç½®">\n    \x3c!-- è®¾ç½®å¡ç‰‡å®¹å™¨ --\x3e\n    \x3c!-- æ ‡é¢˜è¡Œï¼šå¯ç‚¹å‡»æŠ˜å /å±•å¼€ --\x3e\n    <button class="card-header" :aria-expanded="isOpen" @click="onToggle">\n      \x3c!-- ç‚¹å‡»åˆ‡æ¢å±•å¼€çŠ¶æ€ --\x3e\n      <span class="title">ERA è®¾ç½®</span>\n      \x3c!-- æ ‡é¢˜æ–‡å­— --\x3e\n      <span class="chev" aria-hidden="true">{{ isOpen ? \'â–¾\' : \'â–¸\' }}</span>\n      \x3c!-- å±•å¼€ç®­å¤´ --\x3e\n    </button>\n\n    \x3c!-- å†…å®¹ä½“ï¼šé»˜è®¤æ”¶èµ·ï¼›å±•å¼€åæ˜¾ç¤ºå˜é‡åˆ—è¡¨ä¸æ“ä½œ --\x3e\n    <div v-show="isOpen" class="content">\n      \x3c!-- å±•å¼€å†…å®¹å®¹å™¨ --\x3e\n      \x3c!-- é¡¶éƒ¨æ“ä½œåŒºï¼šåˆ·æ–°/ä¿å­˜/é‡ç½®ç¼–è¾‘ --\x3e\n      <div class="toolbar">\n        \x3c!-- å·¥å…·æ¡ --\x3e\n        <button class="mini-btn" title="é‡æ–°è¯»å–è„šæœ¬å˜é‡" @click.stop="loadVars">ğŸ”„ é‡æ–°è¯»å–</button>\n        \x3c!-- è¯»å–æŒ‰é’® --\x3e\n        <div class="spacer"></div>\n        \x3c!-- å ä½æ’‘å¼€ --\x3e\n        <button class="mini-btn subtle" title="ä¸¢å¼ƒæœªä¿å­˜çš„ä¿®æ”¹" @click.stop="discardEdits">â†©ï¸ ä¸¢å¼ƒä¿®æ”¹</button>\n        \x3c!-- ä¸¢å¼ƒç¼–è¾‘ --\x3e\n        <button class="mini-btn primary" title="ä¿å­˜ä¿®æ”¹åˆ°è„šæœ¬å˜é‡" @click.stop="saveEdits">ğŸ’¾ ä¿å­˜ä¿®æ”¹</button>\n        \x3c!-- ä¿å­˜ä¿®æ”¹ --\x3e\n      </div>\n\n      \x3c!-- å˜é‡åˆ—è¡¨ï¼šé€é¡¹æ¸²æŸ“ --\x3e\n      <div class="vars">\n        <template v-if="rows.length > 0">\n          \x3c!-- æœ‰å˜é‡æ—¶æ¸²æŸ“åˆ—è¡¨ --\x3e\n          <div v-for="row in rows" :key="row.key" class="var-row">\n            \x3c!-- æ¯ä¸ªå˜é‡ä¸€è¡Œ --\x3e\n            <label class="var-key" :title="row.key">{{ row.key }}</label>\n            \x3c!-- å˜é‡å --\x3e\n            \x3c!-- æ ¹æ®å˜é‡ç±»å‹é€‰æ‹©ä¸åŒçš„ç¼–è¾‘æ§ä»¶ --\x3e\n            <div class="var-editor">\n              \x3c!-- ç¼–è¾‘å™¨å®¹å™¨ --\x3e\n              \x3c!-- å¸ƒå°”ï¼šå‹¾é€‰æ¡† --\x3e\n              <template v-if="row.type === \'boolean\'">\n                <label class="switch">\n                  \x3c!-- è‡ªå®šä¹‰å¼€å…³å¤–è§‚ --\x3e\n                  <input v-model="edits[row.key]" type="checkbox" />\n                  \x3c!-- å‹¾é€‰å€¼ --\x3e\n                  <span class="track"></span>\n                  \x3c!-- è½¨é“ --\x3e\n                </label>\n              </template>\n\n              \x3c!-- æ•°å­—ï¼šnumber è¾“å…¥ --\x3e\n              <template v-else-if="row.type === \'number\'">\n                <input v-model.number="edits[row.key]" type="number" class="ipt" :placeholder="String(row.value)" />\n                \x3c!-- æ•°å­—è¾“å…¥ --\x3e\n              </template>\n\n              \x3c!-- å­—ç¬¦ä¸²ï¼štext è¾“å…¥ --\x3e\n              <template v-else-if="row.type === \'string\'">\n                <input v-model="edits[row.key]" type="text" class="ipt" :placeholder="String(row.value)" />\n                \x3c!-- æ–‡æœ¬è¾“å…¥ --\x3e\n              </template>\n\n              \x3c!-- å…¶ä»–ï¼ˆå¯¹è±¡/æ•°ç»„/null/æœªçŸ¥ï¼‰ï¼šJSON æ–‡æœ¬åŸŸ --\x3e\n              <template v-else>\n                <textarea\n                  v-model="jsonBuffers[row.key]"\n                  class="ipt ta"\n                  :placeholder="safeStringify(row.value)"\n                  @input="markJsonTouched(row.key)"\n                ></textarea>\n                \x3c!-- JSON æ–‡æœ¬åŸŸ --\x3e\n                <span class="hint" :class="{ ok: jsonState[row.key]?.ok, bad: jsonState[row.key]?.bad }">{{\n                  jsonState[row.key]?.msg ?? \'ä»¥ JSON æ ¼å¼ç¼–è¾‘æ­¤å€¼\'\n                }}</span>\n                \x3c!-- JSON æ ¡éªŒæç¤º --\x3e\n              </template>\n            </div>\n            \x3c!-- ç±»å‹å¾½æ ‡ --\x3e\n            <span class="type-chip">{{ humanType(row.type) }}</span>\n            \x3c!-- ç±»å‹å±•ç¤º --\x3e\n          </div>\n        </template>\n\n        <template v-else>\n          \x3c!-- æ²¡æœ‰å˜é‡æ—¶çš„å ä½ --\x3e\n          <div class="placeholder">\n            <p>æœªè¯»å–åˆ°ä»»ä½•è„šæœ¬å˜é‡ã€‚</p>\n            \x3c!-- æ–‡æœ¬æç¤º --\x3e\n            <p class="dim">\n              è¯·å…ˆç¡®ä¿åœ¨ <code>app_ready</code> æˆ–åˆå§‹åŒ–é˜¶æ®µé€šè¿‡\n              <code>initializeExternalSettings()</code> å†™å…¥é»˜è®¤å˜é‡ã€‚\n            </p>\n            \x3c!-- è¾…åŠ©è¯´æ˜ --\x3e\n          </div>\n        </template>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script setup lang="ts">\n/* å—å¤´ï¼šé€»è¾‘è¯´æ˜\n   - é»˜è®¤æ”¶èµ·ï¼Œå±•å¼€æ—¶è¯»å–è„šæœ¬åŸŸå˜é‡ï¼›\n   - æ”¯æŒ boolean/number/string/json å››ç±»ç¼–è¾‘ï¼›\n   - ä¿å­˜æ—¶æŒ‰åŸç±»å‹å›å†™åˆ°è„šæœ¬åŸŸã€‚\n*/\nimport { reactive, ref } from \'vue\'; // ä¸­æ–‡æ³¨é‡Šï¼šVue å“åº”å¼ API\nimport { z } from \'zod\';\nimport { SettingsSchema } from \'../../utils/constants\';\nimport { getScriptSettings, updateScriptSettings } from \'../../utils/era_data\';\nimport { Logger } from \'../../utils/log\'; // ä¸­æ–‡æ³¨é‡Šï¼šé¡¹ç›®å†…æ—¥å¿—å·¥å…·\n\nconst logger = new Logger(); // ä¸­æ–‡æ³¨é‡Šï¼šå®ä¾‹åŒ–æ—¥å¿—\n\n// === æŠ˜å çŠ¶æ€ ===\nconst isOpen = ref(false); // ä¸­æ–‡æ³¨é‡Šï¼šæ˜¯å¦å±•å¼€\n\n// === åŸå§‹æ•°æ®ä¸ç¼–è¾‘ç¼“å­˜ ===\ntype Row = { key: string; value: any; type: \'boolean\' | \'number\' | \'string\' | \'json\' }; // ä¸­æ–‡æ³¨é‡Šï¼šä¸€è¡Œå˜é‡çš„ç»“æ„\nconst rows = ref<Row[]>([]); // ä¸­æ–‡æ³¨é‡Šï¼šå¯æ¸²æŸ“çš„å˜é‡è¡Œ\nconst edits = reactive<Record<string, any>>({}); // ä¸­æ–‡æ³¨é‡Šï¼šé’ˆå¯¹ç®€å•ç±»å‹çš„ç¼–è¾‘ç¼“å­˜ï¼ˆå¸ƒå°”/æ•°å­—/å­—ç¬¦ä¸²ï¼‰\nconst jsonBuffers = reactive<Record<string, string>>({}); // ä¸­æ–‡æ³¨é‡Šï¼šé’ˆå¯¹ JSON ç±»å‹çš„æ–‡æœ¬ç¼“å­˜\nconst jsonState = reactive<Record<string, { ok?: boolean; bad?: boolean; msg?: string }>>({}); // ä¸­æ–‡æ³¨é‡Šï¼šJSON æ ¡éªŒçŠ¶æ€\n\n// === å·¥å…·ï¼šç±»å‹åˆ¤å®šä¸äººç±»å¯è¯»å ===\nfunction detectType(v: any): Row[\'type\'] {\n  // ä¸­æ–‡æ³¨é‡Šï¼šæ£€æµ‹å˜é‡ç±»å‹\n  if (typeof v === \'boolean\') return \'boolean\'; // ä¸­æ–‡æ³¨é‡Šï¼šå¸ƒå°”\n  if (typeof v === \'number\' && Number.isFinite(v)) return \'number\'; // ä¸­æ–‡æ³¨é‡Šï¼šæœ‰é™æ•°\n  if (typeof v === \'string\') return \'string\'; // ä¸­æ–‡æ³¨é‡Šï¼šå­—ç¬¦ä¸²\n  return \'json\'; // ä¸­æ–‡æ³¨é‡Šï¼šå…¶ä»–ä¸€å¾‹å½’ä¸º jsonï¼ˆå¯¹è±¡/æ•°ç»„/null/ç‰¹æ®Šæ•°ç­‰ï¼‰\n}\nfunction humanType(t: Row[\'type\']): string {\n  // ä¸­æ–‡æ³¨é‡Šï¼šç±»å‹ä¸­æ–‡å\n  return t === \'boolean\' ? \'å¸ƒå°”\' : t === \'number\' ? \'æ•°å­—\' : t === \'string\' ? \'å­—ç¬¦ä¸²\' : \'JSON\'; // ä¸­æ–‡æ³¨é‡Šï¼šæ˜ å°„\n}\nfunction safeStringify(v: any): string {\n  // ä¸­æ–‡æ³¨é‡Šï¼šå®‰å…¨ JSON åºåˆ—åŒ–\n  try {\n    return JSON.stringify(v, null, 2);\n  } catch {\n    return String(v);\n  } // ä¸­æ–‡æ³¨é‡Šï¼šå¤±è´¥åˆ™è½¬å­—ç¬¦ä¸²\n}\n\n// === åŠ è½½å˜é‡åˆ—è¡¨ ===\nfunction loadVars() {\n  try {\n    logger.debug(\'loadVars\', \'å°è¯•è¯»å–è„šæœ¬è®¾ç½®...\');\n    const obj = getScriptSettings();\n    logger.debug(\'loadVars\', \'æˆåŠŸè¯»å–è„šæœ¬è®¾ç½®:\', obj);\n\n    if (!obj || Object.keys(obj).length === 0) {\n      logger.warn(\'loadVars\', \'è®¾ç½®å¯¹è±¡ä¸ºç©ºï¼ŒUI å°†ä¸ä¼šè¢«å¡«å……ã€‚\');\n      rows.value = [];\n      return;\n    }\n\n    // æ¸…ç©ºæ—§ç¼“å­˜\n    rows.value = [];\n    for (const k of Object.keys(edits)) delete edits[k];\n    for (const k of Object.keys(jsonBuffers)) delete jsonBuffers[k];\n    for (const k of Object.keys(jsonState)) delete jsonState[k];\n\n    // æ„å»ºå¯ç¼–è¾‘è¡Œ\n    Object.entries(obj)\n      .filter(([key]) => key !== \'å¼€å¯æ‚¬æµ®çƒ\')\n      .forEach(([key, value]) => {\n        const t = detectType(value);\n        rows.value.push({ key, value, type: t });\n        if (t === \'json\') {\n          jsonBuffers[key] = safeStringify(value);\n        } else {\n          edits[key] = value;\n        }\n      });\n  } catch (e) {\n    logger.error(\'loadVars\', \'è¯»å–è„šæœ¬å˜é‡å¤±è´¥:\', e);\n    alert(\'è¯»å– ERA è®¾ç½®å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯ã€‚\');\n  }\n}\n\n// === å±•å¼€æŠ˜å  ===\nfunction onToggle() {\n  // ä¸­æ–‡æ³¨é‡Šï¼šåˆ‡æ¢å±•å¼€\n  isOpen.value = !isOpen.value; // ä¸­æ–‡æ³¨é‡Šï¼šç¿»è½¬çŠ¶æ€\n  if (isOpen.value && rows.value.length === 0) loadVars(); // ä¸­æ–‡æ³¨é‡Šï¼šé¦–æ¬¡å±•å¼€æ—¶è¯»å–æ•°æ®\n}\n\n// === JSON æ–‡æœ¬åŸŸç¼–è¾‘æ ‡è®° + æ ¡éªŒ ===\nfunction markJsonTouched(key: string) {\n  // ä¸­æ–‡æ³¨é‡Šï¼šæ ‡è®° JSON æ–‡æœ¬æ”¹åŠ¨å¹¶æ ¡éªŒ\n  const txt = jsonBuffers[key] ?? \'\'; // ä¸­æ–‡æ³¨é‡Šï¼šè¯»å–æ–‡æœ¬\n  if (txt.trim() === \'\') {\n    // ä¸­æ–‡æ³¨é‡Šï¼šç©ºæ–‡æœ¬æç¤º\n    jsonState[key] = { bad: true, ok: false, msg: \'ä¸èƒ½ä¸ºç©ºï¼ˆè‹¥è¦è®¾ä¸º null è¯·å†™ nullï¼‰\' }; // ä¸­æ–‡æ³¨é‡Šï¼šç©ºæç¤º\n    return; // ä¸­æ–‡æ³¨é‡Šï¼šè¿”å›\n  }\n  try {\n    JSON.parse(txt);\n    jsonState[key] = { ok: true, bad: false, msg: \'JSON æ ¼å¼æœ‰æ•ˆ\' };\n  } catch (e: any) {\n    // ä¸­æ–‡æ³¨é‡Šï¼šæ ¡éªŒé€šè¿‡\n    jsonState[key] = { bad: true, ok: false, msg: `JSON æ ¼å¼é”™è¯¯ï¼š${e?.message ?? \'\'}` };\n  } // ä¸­æ–‡æ³¨é‡Šï¼šæ ¡éªŒå¤±è´¥\n}\n\n// === ä¸¢å¼ƒæœªä¿å­˜çš„ç¼–è¾‘ ===\nfunction discardEdits() {\n  // ä¸­æ–‡æ³¨é‡Šï¼šä¸¢å¼ƒç¼–è¾‘\n  loadVars(); // ä¸­æ–‡æ³¨é‡Šï¼šé‡æ–°è¯»å–è¦†ç›–æœ¬åœ°æ”¹åŠ¨\n}\n\n// === ä¿å­˜ä¿®æ”¹ ===\nasync function saveEdits() {\n  // ä¸­æ–‡æ³¨é‡Šï¼šä¿å­˜åˆ°è„šæœ¬åŸŸ\n  try {\n    await updateScriptSettings(currentSettings => {\n      const next: z.infer<typeof SettingsSchema> = { ...currentSettings };\n\n      // åˆå¹¶ç®€å•ç±»å‹çš„æ”¹åŠ¨ï¼ˆå¸ƒå°”/æ•°å­—/å­—ç¬¦ä¸²ï¼‰\n      Object.entries(edits).forEach(([k, v]) => {\n        const key = k as keyof z.infer<typeof SettingsSchema>;\n        (next as any)[key] = v;\n      });\n\n      // åˆå¹¶ JSON æ–‡æœ¬æ”¹åŠ¨ï¼ˆéœ€å…ˆé€šè¿‡æ ¡éªŒï¼‰\n      Object.entries(jsonBuffers).forEach(([k, txt]) => {\n        if (txt != null) {\n          if (jsonState[k]?.bad) throw new Error(`é”® ${k} çš„ JSON æ ¼å¼ä¸æ­£ç¡®`);\n          const key = k as keyof z.infer<typeof SettingsSchema>;\n          (next as any)[key] = JSON.parse(txt);\n        }\n      });\n\n      return next;\n    });\n\n    logger.log(\'saveEdits\', \'è„šæœ¬å˜é‡å·²ä¿å­˜\');\n    loadVars();\n  } catch (e) {\n    logger.error(\'saveEdits\', \'ä¿å­˜å¤±è´¥ï¼š\', e);\n    alert(`ä¿å­˜å¤±è´¥ï¼š${(e as any)?.message ?? e}`);\n  }\n}\n<\/script>\n\n<style scoped>\n/* === å¤–å±‚å¡ç‰‡å®¹å™¨ï¼ˆä¸ ActionButtons ä¿æŒåŒç³»å¤–è§‚ï¼‰ === */\n.settings-card {\n  /* ç»ç’ƒå¡å®¹å™¨ */\n  width: 100%; /* å æ»¡ä¾§æ å®½åº¦ */\n  padding: 12px; /* å†…è¾¹è· */\n  margin-top: 12px; /* ä¸ä¸Šæ–¹æŒ‰é’®å¡é—´è· */\n  background: linear-gradient(180deg, rgba(255, 255, 255, 0.76), rgba(255, 255, 255, 0.62)); /* åŠé€æ˜æ¸å˜ */\n  border: 1px solid rgba(255, 255, 255, 0.6); /* æµ…æè¾¹ */\n  border-radius: 16px; /* åœ†è§’ */\n  backdrop-filter: blur(10px); /* æ¯›ç»ç’ƒ */\n  box-shadow:\n    0 10px 40px rgba(0, 0, 0, 0.16),\n    inset 0 1px 0 rgba(255, 255, 255, 0.6); /* æŠ•å½± */\n  display: flex; /* çºµå‘å¸ƒå±€ */\n  flex-direction: column; /* å‚ç›´æ’å¸ƒ */\n  gap: 10px; /* é—´è· */\n}\n\n/* æ ‡é¢˜æŒ‰é’®ï¼šæ”¶èµ·/å±•å¼€æ§åˆ¶ */\n.card-header {\n  /* æ ‡é¢˜è¡ŒæŒ‰é’® */\n  display: flex; /* æ¨ªå‘å¸ƒå±€ */\n  align-items: center; /* å‚ç›´å±…ä¸­ */\n  justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */\n  padding: 8px 10px; /* å†…è¾¹è· */\n  border-radius: 10px; /* åœ†è§’ */\n  border: 1px solid rgba(0, 0, 0, 0.06); /* è½»æè¾¹ */\n  background: linear-gradient(180deg, #fafafa, #f3f4f6); /* æ¸å˜ */\n  color: #1f2937; /* å­—è‰² */\n  font-weight: 800; /* åŠ ç²— */\n  font-size: 13px; /* å­—å· */\n  cursor: pointer; /* å¯ç‚¹ */\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 2px 8px rgba(0, 0, 0, 0.08); /* é˜´å½± */\n}\n.card-header:hover {\n  transform: translateY(-1px);\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 6px 16px rgba(0, 0, 0, 0.12);\n} /* æ‚¬åœæ€ */\n.title {\n  pointer-events: none;\n} /* é¿å…å­å…ƒç´ æˆªè·ç‚¹å‡» */\n.chev {\n  opacity: 0.7;\n} /* ç®­å¤´æ·¡åŒ– */\n\n/* å†…å®¹ä½“ */\n.content {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n} /* å†…å®¹å®¹å™¨ */\n\n/* å·¥å…·æ¡ */\n.toolbar {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n} /* å·¥å…·æ¡å¸ƒå±€ */\n.spacer {\n  flex: 1;\n} /* å³å¯¹é½æŒ‰é’®ç”¨ */\n\n.mini-btn {\n  /* é€šç”¨å°æŒ‰é’® */\n  padding: 6px 10px; /* å†…è¾¹è· */\n  border-radius: 8px; /* åœ†è§’ */\n  border: 1px solid rgba(0, 0, 0, 0.08); /* æè¾¹ */\n  background: linear-gradient(180deg, #fafafa, #f3f4f6); /* èƒŒæ™¯ */\n  cursor: pointer; /* å¯ç‚¹å‡» */\n  font-size: 12px; /* å­—å· */\n  font-weight: 700; /* åŠ ç²— */\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 2px 6px rgba(0, 0, 0, 0.06); /* é˜´å½± */\n}\n.mini-btn:hover {\n  transform: translateY(-1px);\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 5px 12px rgba(0, 0, 0, 0.1);\n} /* æ‚¬åœ */\n.mini-btn.primary {\n  background: linear-gradient(180deg, #e0f2fe, #bfdbfe);\n  border-color: #93c5fd;\n  color: #0f172a;\n} /* ä¸»è¦ */\n.mini-btn.subtle {\n  background: linear-gradient(180deg, #f9fafb, #f3f4f6);\n  border-color: #e5e7eb;\n} /* æ¬¡è¦ */\n\n/* å˜é‡åˆ—è¡¨ */\n.vars {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n} /* åˆ—è¡¨å®¹å™¨ */\n\n.var-row {\n  /* ä¸€è¡Œå˜é‡ */\n  display: grid; /* ç½‘æ ¼å¸ƒå±€ */\n  grid-template-columns: 1fr minmax(120px, 1.2fr) auto; /* ä¸‰åˆ—ï¼šé”® / ç¼–è¾‘å™¨ / ç±»å‹ */\n  align-items: center; /* å‚ç›´å±…ä¸­ */\n  gap: 10px; /* åˆ—é—´è· */\n  padding: 8px 10px; /* å†…è¾¹è· */\n  border: 1px solid rgba(0, 0, 0, 0.06); /* è½»æè¾¹ */\n  border-radius: 10px; /* åœ†è§’ */\n  background: linear-gradient(180deg, #ffffff, #f8fafc); /* æ·¡åº• */\n}\n.var-key {\n  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;\n  font-size: 12px;\n  color: #374151;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n} /* é”®åæ ·å¼ */\n.var-editor {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n} /* ç¼–è¾‘å™¨å®¹å™¨ */\n\n.ipt {\n  /* é€šç”¨è¾“å…¥æ¡† */\n  width: 100%; /* æ‹‰æ»¡å¯ç”¨å®½åº¦ */\n  padding: 8px 10px; /* å†…è¾¹è· */\n  border-radius: 8px; /* åœ†è§’ */\n  border: 1px solid #e5e7eb; /* æè¾¹ */\n  background: #fff; /* èƒŒæ™¯ */\n  font-size: 12px; /* å­—å· */\n  color: #111827; /* æ–‡å­— */\n  box-shadow: inset 0 1px 0 #fff; /* å†…é«˜å…‰ */\n}\n.ta {\n  min-height: 64px;\n  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;\n} /* JSON æ–‡æœ¬åŸŸ */\n\n.type-chip {\n  /* ç±»å‹æ ‡ç­¾ */\n  font-size: 11px; /* å­—å· */\n  color: #374151; /* å­—è‰² */\n  background: #eef2ff; /* èƒŒæ™¯ */\n  border: 1px solid #c7d2fe; /* æè¾¹ */\n  border-radius: 999px; /* èƒ¶å›Š */\n  padding: 4px 8px; /* å†…è¾¹è· */\n  white-space: nowrap; /* ä¸æ¢è¡Œ */\n}\n\n/* è‡ªå®šä¹‰å¼€å…³ï¼ˆå¸ƒå°”ï¼‰ */\n.switch {\n  position: relative;\n  width: 42px;\n  height: 24px;\n  display: inline-block;\n} /* å¼€å…³å®¹å™¨ */\n.switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n} /* éšè—åŸç”Ÿæ¡† */\n.switch .track {\n  position: absolute;\n  inset: 0;\n  border-radius: 999px;\n  background: #e5e7eb;\n  box-shadow: inset 0 1px 0 #fff;\n  transition: background 0.2s ease;\n} /* è½¨é“ */\n.switch .track::after {\n  content: \'\';\n  position: absolute;\n  top: 3px;\n  left: 3px;\n  width: 18px;\n  height: 18px;\n  border-radius: 50%;\n  background: #fff;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);\n  transition: transform 0.2s ease;\n} /* æ‹–å¤´ */\n.switch input:checked + .track {\n  background: #93c5fd;\n} /* é€‰ä¸­è½¨é“è‰² */\n.switch input:checked + .track::after {\n  transform: translateX(18px);\n} /* æ‹–å¤´å³ç§» */\n\n.hint {\n  font-size: 11px;\n  color: #6b7280;\n} /* JSON æç¤º */\n.hint.ok {\n  color: #065f46;\n} /* é€šè¿‡æç¤ºè‰² */\n.hint.bad {\n  color: #b91c1c;\n} /* é”™è¯¯æç¤ºè‰² */\n\n.placeholder {\n  padding: 10px;\n  color: #6b7280;\n  font-size: 12px;\n  border: 1px dashed rgba(0, 0, 0, 0.08);\n  border-radius: 10px;\n  background: rgba(255, 255, 255, 0.5);\n} /* ç©ºçŠ¶æ€ */\n</style>\n'],sourceRoot:''}]);const s=i},354:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.json-line[data-v-34fc6c00]{position:relative;display:flex;align-items:center;gap:6px;padding:2px 6px;border-radius:6px}.json-line[data-v-34fc6c00]:hover{background:rgba(59,130,246,0.06)}.json-children[data-v-34fc6c00]{border-left:1px dashed rgba(107,114,128,0.25)}.key[data-v-34fc6c00]{color:#1f2937;font-weight:700}.colon[data-v-34fc6c00]{color:#6b7280}.brace[data-v-34fc6c00]{color:#9ca3af}.summary[data-v-34fc6c00]{color:#6b7280;margin-left:4px}.val.string[data-v-34fc6c00]{color:#047857}.val.number[data-v-34fc6c00]{color:#7c3aed}.val.boolean[data-v-34fc6c00]{color:#0369a1}.val.null[data-v-34fc6c00]{color:#9ca3af}.val.undefined[data-v-34fc6c00]{color:#9ca3af}.caret[data-v-34fc6c00]{width:18px;height:18px;border:1px solid rgba(0,0,0,0.06);border-radius:4px;background:#fff;line-height:16px;text-align:center;font-size:10px;color:#6b7280;cursor:pointer;box-shadow:0 1px 0 #fff,0 2px 6px rgba(0,0,0,0.06);transition:transform 0.18s ease,box-shadow 0.18s ease}.caret.open[data-v-34fc6c00]{transform:rotate(90deg);box-shadow:0 3px 10px rgba(0,0,0,0.12)}.node[data-v-34fc6c00]{overflow:clip;contain:paint;min-height:0}.json-children[data-v-34fc6c00]{overflow:clip;contain:paint}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/era-panel/parts/JsonNode.vue'],names:[],mappings:'AAoJA,4BACE,iBAAkB,CAClB,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,iBACF,CACA,kCACE,gCACF,CACA,gCACE,6CACF,CAGA,sBACE,aAAc,CACd,eACF,CACA,wBACE,aACF,CACA,wBACE,aACF,CACA,0BACE,aAAc,CACd,eACF,CACA,6BACE,aACF,CACA,6BACE,aACF,CACA,8BACE,aACF,CACA,2BACE,aACF,CACA,gCACE,aACF,CAGA,wBACE,UAAW,CACX,WAAY,CACZ,iCAAqC,CACrC,iBAAkB,CAClB,eAAgB,CAChB,gBAAiB,CACjB,iBAAkB,CAClB,cAAe,CACf,aAAc,CACd,cAAe,CACf,kDAE+B,CAC/B,qDAGF,CACA,6BACE,uBAAwB,CACxB,sCACF,CAGA,uBAEE,aAAc,CACd,aAAc,CACd,YACF,CAEA,gCAEE,aAAc,CACd,aACF',sourcesContent:['<template>\n  \x3c!-- å•æ¡èŠ‚ç‚¹ï¼ˆæ”¯æŒé€’å½’ï¼‰ --\x3e\n  <div class="node">\n    \x3c!-- æ¯ä¸ªé”®å€¼å¯¹ / æ•°ç»„é¡¹çš„å®¹å™¨ --\x3e\n    <div class="json-line" :style="{ paddingLeft: level * 14 + \'px\' }">\n      \x3c!-- è¡Œ+ç¼©è¿› --\x3e\n      <button v-if="foldable" class="caret" :class="{ open }" aria-label="toggle" @click="open = !open">â–¸</button>\n      \x3c!-- æŠ˜å ç®­å¤´æŒ‰é’® --\x3e\n\n      <span class="key">{{ k }}</span\n      ><span class="colon">:</span>\n      \x3c!-- é”®ä¸å†’å· --\x3e\n\n      \x3c!-- å¯æŠ˜å å®¹å™¨ï¼šåªæ˜¾ç¤ºæ‹¬å·ä¸æ‘˜è¦ï¼›å±•å¼€åç”±ä¸‹æ–¹ children åŒºåŸŸé€’å½’æ¸²æŸ“ --\x3e\n      <template v-if="foldable">\n        <span class="brace">{{ isArray ? \'[\' : \'{\' }}</span>\n        \x3c!-- å®¹å™¨èµ·å§‹æ‹¬å· --\x3e\n        <span v-if="!open" class="summary">{{ summary }}</span>\n        \x3c!-- æ”¶èµ·æ—¶çš„æ‘˜è¦ --\x3e\n      </template>\n\n      \x3c!-- åŸå§‹å€¼ï¼šç›´æ¥ç€è‰²æ¸²æŸ“ --\x3e\n      <template v-else>\n        <span class="val" :class="type">{{ primitiveText }}</span>\n        \x3c!-- åŸå§‹å€¼æ–‡æœ¬ --\x3e\n      </template>\n    </div>\n\n    \x3c!-- å­å…ƒç´ åŒºåŸŸï¼šä»…å½“å¯æŠ˜å ä¸”å¤„äºå±•å¼€æ€æ—¶æ˜¾ç¤º --\x3e\n    <template v-if="foldable && open">\n      <div class="json-children">\n        \x3c!-- é€’å½’ï¼šè‡ªå¼•ç”¨åŒåç»„ä»¶ JsonNodeï¼ˆä¾èµ– name: \'JsonNode\' å®ç°è‡ªé€’å½’ï¼‰ --\x3e\n        <JsonNode\n          v-for="(childVal, childKey) in childEntries"\n          :key="path + \'/\' + String(childKey)"\n          :k="String(childKey)"\n          :v="childVal"\n          :path="path + \'/\' + String(childKey)"\n          :level="level + 1"\n          :default-collapsed="defaultCollapsed"\n          :max-depth="maxDepth"\n        />\n        <div class="json-line" :style="{ paddingLeft: level * 14 + \'px\' }">\n          <span class="brace">{{ isArray ? \']\' : \'}\' }}</span>\n          \x3c!-- å®¹å™¨é—­åˆæ‹¬å· --\x3e\n        </div>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script lang="ts">\nimport { computed, defineComponent, onMounted, ref, watch } from \'vue\'; // å¼•å…¥å“åº”å¼/ç»„ä»¶å·¥å…·\nimport { Logger } from \'../../../../utils/log\';\n\nexport default defineComponent({\n  name: \'JsonNode\', // å…³é”®ï¼šä¸ºè‡ªé€’å½’æä¾›ç»„ä»¶å\n  props: {\n    k: { type: [String, Number], required: true }, // å½“å‰é”®ï¼ˆæˆ–æ•°ç»„ä¸‹æ ‡ï¼‰\n    v: { required: true }, // å½“å‰å€¼\n    path: { type: String, required: true }, // è·¯å¾„ï¼ˆä»…ç”¨äº key/è°ƒè¯•ï¼‰\n    level: { type: Number, required: true }, // å±‚çº§ï¼ˆç”¨äºç¼©è¿›ï¼‰\n    defaultCollapsed: { type: Boolean, default: true }, // é»˜è®¤æ˜¯å¦æŠ˜å \n    maxDepth: { type: Number, default: 3 }, // åˆæ¬¡å±•å¼€çš„æœ€å¤§æ·±åº¦\n  },\n  setup(p) {\n    const logger = new Logger();\n\n    onMounted(() => {\n      logger.debug(\'onMounted\', \'ç»„ä»¶å·²æŒ‚è½½\', { props: p });\n    });\n\n    // èŠ‚ç‚¹ç±»å‹åˆ¤å®š\n    const type = computed(() => {\n      const val = p.v;\n      if (val === null) return \'null\';\n      if (Array.isArray(val)) return \'array\';\n      const t = typeof val;\n      if (t === \'object\') return \'object\';\n      if (t === \'undefined\') return \'undefined\';\n      return t as \'string\' | \'number\' | \'boolean\' | \'bigint\' | \'symbol\' | \'function\';\n    });\n\n    // æ˜¯å¦æ•°ç»„/å¯¹è±¡\n    const isArray = computed(() => type.value === \'array\');\n    const isObject = computed(() => type.value === \'object\');\n\n    // æ˜¯å¦å¯æŠ˜å \n    const foldable = computed(() => isArray.value || isObject.value);\n\n    // åˆå§‹å¼€åˆï¼šä¸è¶…è¿‡ maxDepth çš„å±‚çº§é»˜è®¤å±•å¼€ï¼›å¦åˆ™éµå¾ª defaultCollapsed\n    const open = ref<boolean>(p.level <= (p.maxDepth ?? 3) ? true : !p.defaultCollapsed);\n\n    watch(open, newOpenState => {\n      logger.debug(\'watch:open\', `æŠ˜å çŠ¶æ€æ”¹å˜ä¸º: ${newOpenState ? \'å±•å¼€\' : \'æ”¶èµ·\'}`);\n    });\n\n    // åŸå§‹å€¼æ¸²æŸ“æ–‡æœ¬ï¼ˆè¡¥è¶³ undefined / bigint / symbolï¼‰\n    const primitiveText = computed(() => {\n      const val = p.v as any;\n      switch (type.value) {\n        case \'string\':\n          return JSON.stringify(val);\n        case \'number\':\n          return String(val);\n        case \'boolean\':\n          return val ? \'true\' : \'false\';\n        case \'null\':\n          return \'null\';\n        case \'undefined\':\n          return \'undefined\';\n        case \'bigint\':\n          return String(val) + \'n\';\n        case \'symbol\':\n          return String(val);\n        case \'function\':\n          return \'Æ’()\';\n        default:\n          return \'\';\n      }\n    });\n\n    // æ”¶èµ·æ—¶çš„æ‘˜è¦ä¿¡æ¯\n    const summary = computed(() => {\n      if (isArray.value) return `Array[${(p.v as any[]).length}]`;\n      if (isObject.value) return `Object{${Object.keys(p.v || {}).length}}`;\n      return \'\';\n    });\n\n    // å­é¡¹åˆ—è¡¨ï¼šå¯¹è±¡ â†’ å…¶ entriesï¼›æ•°ç»„ â†’ ç›´æ¥æšä¸¾ç´¢å¼•å’Œå€¼\n    const childEntries = computed<Record<string, any>>(() => {\n      if (isObject.value) return p.v as Record<string, any>;\n      if (isArray.value) {\n        const out: Record<string, any> = {};\n        (p.v as any[]).forEach((cv, idx) => {\n          out[String(idx)] = cv;\n        });\n        return out;\n      }\n      return {};\n    });\n\n    return { type, isArray, foldable, open, primitiveText, summary, childEntries };\n  },\n});\n<\/script>\n\n<style scoped>\n.json-line {\n  position: relative;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 2px 6px;\n  border-radius: 6px;\n}\n.json-line:hover {\n  background: rgba(59, 130, 246, 0.06);\n}\n.json-children {\n  border-left: 1px dashed rgba(107, 114, 128, 0.25);\n}\n\n/* ç»“æ„å…ƒç´ ä¸ç€è‰² */\n.key {\n  color: #1f2937;\n  font-weight: 700;\n}\n.colon {\n  color: #6b7280;\n}\n.brace {\n  color: #9ca3af;\n}\n.summary {\n  color: #6b7280;\n  margin-left: 4px;\n}\n.val.string {\n  color: #047857;\n}\n.val.number {\n  color: #7c3aed;\n}\n.val.boolean {\n  color: #0369a1;\n}\n.val.null {\n  color: #9ca3af;\n}\n.val.undefined {\n  color: #9ca3af;\n}\n\n/* æŠ˜å ç®­å¤´ */\n.caret {\n  width: 18px;\n  height: 18px;\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 4px;\n  background: #fff;\n  line-height: 16px;\n  text-align: center;\n  font-size: 10px;\n  color: #6b7280;\n  cursor: pointer;\n  box-shadow:\n    0 1px 0 #fff,\n    0 2px 6px rgba(0, 0, 0, 0.06);\n  transition:\n    transform 0.18s ease,\n    box-shadow 0.18s ease;\n}\n.caret.open {\n  transform: rotate(90deg);\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.12);\n}\n\n/* ===[æ–°å¢] é˜²æº¢å‡ºï¼šèŠ‚ç‚¹ä¸å­æ ‘éƒ½è£å‰ªï¼ˆé…åˆä¸Šå±‚æŠ˜å æ—¶å½»åº•çœ‹ä¸è§ï¼‰ === */\n.node {\n  /* å•ä¸ªèŠ‚ç‚¹å®¹å™¨ */\n  overflow: clip; /* è£å‰ªèŠ‚ç‚¹å†…éƒ¨æ‰€æœ‰ç»˜åˆ¶ */\n  contain: paint; /* éš”ç¦»ç»˜åˆ¶ï¼Œé¿å… 1px æ¸²æŸ“å¤–æ³„ */\n  min-height: 0; /* é˜²â€œæœ€å°é«˜åº¦â€æŠŠçˆ¶çº§æ’‘å¼€ */\n}\n\n.json-children {\n  /* å­èŠ‚ç‚¹åŒºåŸŸ */\n  overflow: clip; /* è£å‰ªå­æ ‘ï¼ˆå«å·¦ä¾§è™šçº¿ç­‰è£…é¥°ï¼‰ */\n  contain: paint; /* é˜²æ­¢å­å…ƒç´ é˜´å½±/è¾¹æ¡†è¶…ç•Œ */\n}\n</style>\n'],sourceRoot:''}]);const s=i},360:(e,n,t)=>{var a=t(66);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('5a0f86ce',a,!1,{ssrId:!0})},364:(e,n,t)=>{var a=t(58);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('4ddf5df5',a,!1,{ssrId:!0})},408:(e,n,t)=>{var a=t(98);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('2a59f09f',a,!1,{ssrId:!0})},424:(e,n,t)=>{function a(e,n){for(var t=[],a={},r=0;r<n.length;r++){var o=n[r],i=o[0],s={id:e+':'+r,css:o[1],media:o[2],sourceMap:o[3]};a[i]?a[i].parts.push(s):t.push(a[i]={id:i,parts:[s]})}return t}t.d(n,{A:()=>g});var r='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!r)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var o={},i=r&&(document.head||document.getElementsByTagName('head')[0]),s=null,l=0,c=!1,d=function(){},p=null,A='data-vue-ssr-id',u='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(e,n,t,r){c=t,p=r||{};var i=a(e,n);return f(i),function(n){for(var t=[],r=0;r<i.length;r++){var s=i[r];(l=o[s.id]).refs--,t.push(l)}n?f(i=a(e,n)):i=[];for(r=0;r<t.length;r++){var l;if(0===(l=t[r]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete o[l.id]}}}}function f(e){for(var n=0;n<e.length;n++){var t=e[n],a=o[t.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](t.parts[r]);for(;r<t.parts.length;r++)a.parts.push(m(t.parts[r]));a.parts.length>t.parts.length&&(a.parts.length=t.parts.length)}else{var i=[];for(r=0;r<t.parts.length;r++)i.push(m(t.parts[r]));o[t.id]={id:t.id,refs:1,parts:i}}}}function C(){var e=document.createElement('style');return e.type='text/css',i.appendChild(e),e}function m(e){var n,t,a=document.querySelector('style['+A+'~="'+e.id+'"]');if(a){if(c)return d;a.parentNode.removeChild(a)}if(u){var r=l++;a=s||(s=C()),n=v.bind(null,a,r,!1),t=v.bind(null,a,r,!0)}else a=C(),n=h.bind(null,a),t=function(){a.parentNode.removeChild(a)};return n(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;n(e=a)}else t()}}var b,x=(b=[],function(e,n){return b[e]=n,b.filter(Boolean).join('\n')});function v(e,n,t,a){var r=t?'':a.css;if(e.styleSheet)e.styleSheet.cssText=x(n,r);else{var o=document.createTextNode(r),i=e.childNodes;i[n]&&e.removeChild(i[n]),i.length?e.insertBefore(o,i[n]):e.appendChild(o)}}function h(e,n){var t=n.css,a=n.media,r=n.sourceMap;if(a&&e.setAttribute('media',a),p.ssrId&&e.setAttribute(A,n.id),r&&(t+='\n/*# sourceURL='+r.sources[0]+' */',t+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+' */'),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},441:(e,n)=>{n.A=(e,n)=>{const t=e.__vccOpts||e;for(const[e,a]of n)t[e]=a;return t}},462:(e,n,t)=>{var a=t(8);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('1d8fc8b2',a,!1,{ssrId:!0})},463:(e,n,t)=>{var a=t(249);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('4de6a2ac',a,!1,{ssrId:!0})},527:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.action-buttons-card[data-v-5766043a]{width:100%;padding:12px;background:linear-gradient(180deg,rgba(255,255,255,0.76),rgba(255,255,255,0.62));border:1px solid rgba(255,255,255,0.6);border-radius:16px;backdrop-filter:blur(10px);box-shadow:0 10px 40px rgba(0,0,0,0.16),inset 0 1px 0 rgba(255,255,255,0.6);display:flex;flex-direction:column;gap:10px}.card-title[data-v-5766043a]{margin:0 0 4px;font-size:14px;font-weight:800;letter-spacing:0.3px;color:#1f2937}.btns[data-v-5766043a]{display:flex;flex-direction:column;gap:10px}.btn[data-v-5766043a]{display:grid;grid-template-columns:22px 1fr;align-items:center;-moz-column-gap:8px;column-gap:8px;padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,0.06);background:linear-gradient(180deg,#fafafa,#f3f4f6);color:#374151;font-weight:700;font-size:13px;cursor:pointer;box-shadow:inset 0 1px 0 #fff,0 2px 8px rgba(0,0,0,0.08);transition:transform 0.12s ease,box-shadow 0.12s ease,background 0.2s ease;text-align:left}.btn.primary[data-v-5766043a]{background:linear-gradient(180deg,#e0f2fe,#bfdbfe);border-color:#93c5fd;color:#0f172a}.btn.subtle[data-v-5766043a]{background:linear-gradient(180deg,#f9fafb,#f3f4f6);border-color:#e5e7eb}.btn[data-v-5766043a]:hover{transform:translateY(-1px);box-shadow:inset 0 1px 0 #fff,0 6px 16px rgba(0,0,0,0.12)}.btn[data-v-5766043a]:active{transform:translateY(0);box-shadow:inset 0 1px 0 #fff,0 2px 8px rgba(0,0,0,0.1)}.btn[data-v-5766043a]:focus-visible{outline:2px solid #60a5fa;outline-offset:2px}.ico[data-v-5766043a]{display:inline-grid;place-items:center;width:22px;height:22px;filter:saturate(0.95)}.label[data-v-5766043a]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/ActionButtons.vue'],names:[],mappings:'AA8CA,sCAEE,UAAW,CACX,YAAa,CACb,gFAAyF,CACzF,sCAA0C,CAC1C,kBAAmB,CACnB,0BAA2B,CAC3B,2EAEwC,CACxC,YAAa,CACb,qBAAsB,CACtB,QACF,CAGA,6BAEE,cAAe,CACf,cAAe,CACf,eAAgB,CAChB,oBAAqB,CACrB,aACF,CAGA,uBAEE,YAAa,CACb,qBAAsB,CACtB,QACF,CAGA,sBAEE,YAAa,CACb,8BAA+B,CAC/B,kBAAmB,CACnB,mBAAe,CAAf,cAAe,CACf,iBAAkB,CAClB,kBAAmB,CACnB,iCAAqC,CACrC,kDAAqD,CACrD,aAAc,CACd,eAAgB,CAChB,cAAe,CACf,cAAe,CACf,wDAE+B,CAC/B,0EAGsB,CACtB,eACF,CAGA,8BAEE,kDAAqD,CACrD,oBAAqB,CACrB,aACF,CAGA,6BAEE,kDAAqD,CACrD,oBACF,CAGA,4BAEE,0BAA2B,CAC3B,yDAGF,CACA,6BAEE,uBAAwB,CACxB,uDAGF,CAGA,oCAEE,yBAA0B,CAC1B,kBACF,CAGA,sBAEE,mBAAoB,CACpB,kBAAmB,CACnB,UAAW,CACX,WAAY,CACZ,qBACF,CACA,wBAEE,kBAAmB,CACnB,eAAgB,CAChB,sBACF',sourcesContent:['<template>\n  \x3c!-- å³ä¾§æ“ä½œå¡ï¼šå¤–å±‚è‡ªåŒ…å«ï¼Œä¸ä¾èµ–çˆ¶ç»„ä»¶æ ·å¼ --\x3e\n  <section class="action-buttons-card" role="complementary" aria-label="ERA å¿«æ·æ“ä½œ">\n    \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ“ä½œå¡å®¹å™¨ --\x3e\n    <h4 class="card-title">å¿«æ·æ“ä½œ</h4>\n    \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå¡ç‰‡æ ‡é¢˜ --\x3e\n    <div class="btns">\n      \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæŒ‰é’®å‚ç›´æ ˆ --\x3e\n      <button class="btn primary" title="é‡æ–°è®¡ç®—æ‰€æœ‰å˜é‡" @click.stop="onFullSync">\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šä¸»æŒ‰é’® --\x3e\n        <span class="ico" aria-hidden="true">ğŸ”„</span>\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå›¾æ ‡ --\x3e\n        <span class="label">å®Œå…¨é‡ç®—å˜é‡</span>\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ–‡å­— --\x3e\n      </button>\n      <button class="btn subtle" title="åªé‡ç®—æœ€æ–°ä¸€æ¥¼çš„å˜é‡" @click.stop="onLastSync">\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ¬¡æŒ‰é’® --\x3e\n        <span class="ico" aria-hidden="true">â™»ï¸</span>\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå›¾æ ‡ --\x3e\n        <span class="label">é‡ç®—æœ€åä¸€æ¥¼å˜é‡</span>\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ–‡å­— --\x3e\n      </button>\n    </div>\n  </section>\n</template>\n\n<script setup lang="ts">\nimport { Logger } from \'../../utils/log\'; // ä¸­æ–‡æ³¨é‡Šï¼šæ—¥å¿—å·¥å…·\n\nconst logger = new Logger(\'ui-ActionButtons\'); // ä¸­æ–‡æ³¨é‡Šï¼šå®ä¾‹åŒ–æ—¥å¿—\n\nfunction onFullSync() {\n  // ä¸­æ–‡æ³¨é‡Šï¼šå®Œå…¨é‡ç®—äº‹ä»¶\n  logger.log(\'onFullSync\', \'ç‚¹å‡»â€œå®Œå…¨é‡ç®—å˜é‡â€ï¼Œå‘é€ manual_full_sync äº‹ä»¶ã€‚\'); // ä¸­æ–‡æ³¨é‡Šï¼šæ—¥å¿—\n  eventEmit(\'manual_full_sync\'); // ä¸­æ–‡æ³¨é‡Šï¼šå‘é€å…¨é‡é‡ç®—äº‹ä»¶ï¼ˆä¿æŒä¸å˜ï¼‰\n}\n\nfunction onLastSync() {\n  // ä¸­æ–‡æ³¨é‡Šï¼šå±€éƒ¨é‡ç®—äº‹ä»¶\n  logger.log(\'onLastSync\', \'ç‚¹å‡»â€œé‡ç®—æœ€åä¸€æ¥¼å˜é‡â€ï¼Œå‘é€ manual_sync äº‹ä»¶ã€‚\'); // ä¸­æ–‡æ³¨é‡Šï¼šæ—¥å¿—\n  eventEmit(\'manual_sync\'); // ä¸­æ–‡æ³¨é‡Šï¼šå‘é€å•æ¥¼é‡ç®—äº‹ä»¶ï¼ˆä¿æŒä¸å˜ï¼‰\n}\n<\/script>\n\n<style scoped>\n/* === å¤–å±‚å¡ç‰‡ï¼šä¸å·¦ä¾§ ERA é¢æ¿åŒé£æ ¼ï¼ˆç»ç’ƒå¡ + è½»æµ®é›•ï¼‰ === */\n.action-buttons-card {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šå¡ç‰‡å®¹å™¨ */\n  width: 100%; /* å æ»¡ä¾§æ  */ /* ä¸­æ–‡æ³¨é‡Šï¼šè‡ªé€‚åº”å®½åº¦ */\n  padding: 12px; /* å†…è¾¹è· */ /* ä¸­æ–‡æ³¨é‡Šï¼šç•™ç™½ */\n  background: linear-gradient(180deg, rgba(255, 255, 255, 0.76), rgba(255, 255, 255, 0.62)); /* ä¸­æ–‡æ³¨é‡Šï¼šåŠé€æ˜æ¸å˜ */\n  border: 1px solid rgba(255, 255, 255, 0.6); /* ä¸­æ–‡æ³¨é‡Šï¼šæµ…è‰²æè¾¹ */\n  border-radius: 16px; /* ä¸­æ–‡æ³¨é‡Šï¼šåœ†è§’ */\n  backdrop-filter: blur(10px); /* ä¸­æ–‡æ³¨é‡Šï¼šæ¯›ç»ç’ƒæ•ˆæœ */\n  box-shadow:\n    0 10px 40px rgba(0, 0, 0, 0.16),\n    inset 0 1px 0 rgba(255, 255, 255, 0.6); /* ä¸­æ–‡æ³¨é‡Šï¼šå¤–æŠ•å½± + å†…é«˜å…‰ */\n  display: flex; /* ä¸­æ–‡æ³¨é‡Šï¼šçºµå‘å¸ƒå±€ */\n  flex-direction: column; /* ä¸­æ–‡æ³¨é‡Šï¼šå‚ç›´æ’åˆ— */\n  gap: 10px; /* ä¸­æ–‡æ³¨é‡Šï¼šå…ƒç´ é—´è· */\n}\n\n/* æ ‡é¢˜ï¼šä¸é¢æ¿æ ‡é¢˜æƒé‡æ¥è¿‘ä½†ç•¥è½» */\n.card-title {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šå¡ç‰‡æ ‡é¢˜ */\n  margin: 0 0 4px; /* ä¸­æ–‡æ³¨é‡Šï¼šåº•éƒ¨ç•™ç™½ */\n  font-size: 14px; /* ä¸­æ–‡æ³¨é‡Šï¼šå­—å· */\n  font-weight: 800; /* ä¸­æ–‡æ³¨é‡Šï¼šåŠ ç²— */\n  letter-spacing: 0.3px; /* ä¸­æ–‡æ³¨é‡Šï¼šå­—è· */\n  color: #1f2937; /* ä¸­æ–‡æ³¨é‡Šï¼šæ·±ç°æ–‡å­— */\n}\n\n/* æŒ‰é’®æ ˆï¼šç«–ç›´æ’åˆ— */\n.btns {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šæŒ‰é’®å®¹å™¨ */\n  display: flex; /* ä¸­æ–‡æ³¨é‡Šï¼šflex å¸ƒå±€ */\n  flex-direction: column; /* ä¸­æ–‡æ³¨é‡Šï¼šå‚ç›´æ’åˆ— */\n  gap: 10px; /* ä¸­æ–‡æ³¨é‡Šï¼šä¸Šä¸‹é—´è· */\n}\n\n/* é€šç”¨æŒ‰é’®é€ å‹ï¼šå¤§å·ã€æ˜“ç‚¹ã€å¯èšç„¦ */\n.btn {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šé€šç”¨æŒ‰é’® */\n  display: grid; /* ä¸­æ–‡æ³¨é‡Šï¼šç½‘æ ¼æ–¹ä¾¿å¯¹é½å›¾æ ‡ä¸æ–‡å­— */\n  grid-template-columns: 22px 1fr; /* ä¸­æ–‡æ³¨é‡Šï¼šå·¦ 22px å›¾æ ‡ + å³ä¾§æ–‡å­— */\n  align-items: center; /* ä¸­æ–‡æ³¨é‡Šï¼šå‚ç›´å±…ä¸­ */\n  column-gap: 8px; /* ä¸­æ–‡æ³¨é‡Šï¼šå›¾æ ‡ä¸æ–‡å­—é—´è· */\n  padding: 10px 12px; /* ä¸­æ–‡æ³¨é‡Šï¼šè§¦æ§å‹å¥½å°ºå¯¸ */\n  border-radius: 12px; /* ä¸­æ–‡æ³¨é‡Šï¼šåœ†è§’ */\n  border: 1px solid rgba(0, 0, 0, 0.06); /* ä¸­æ–‡æ³¨é‡Šï¼šæµ…æè¾¹ */\n  background: linear-gradient(180deg, #fafafa, #f3f4f6); /* ä¸­æ–‡æ³¨é‡Šï¼šæµ…ç°æ¸å˜ */\n  color: #374151; /* ä¸­æ–‡æ³¨é‡Šï¼šæ–‡å­—é¢œè‰² */\n  font-weight: 700; /* ä¸­æ–‡æ³¨é‡Šï¼šå­—é‡ */\n  font-size: 13px; /* ä¸­æ–‡æ³¨é‡Šï¼šå­—å· */\n  cursor: pointer; /* ä¸­æ–‡æ³¨é‡Šï¼šå¯ç‚¹å‡» */\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 2px 8px rgba(0, 0, 0, 0.08); /* ä¸­æ–‡æ³¨é‡Šï¼šå†…é«˜å…‰ + è½»æŠ•å½± */\n  transition:\n    transform 0.12s ease,\n    box-shadow 0.12s ease,\n    background 0.2s ease; /* ä¸­æ–‡æ³¨é‡Šï¼šäº¤äº’è¿‡æ¸¡ */\n  text-align: left; /* ä¸­æ–‡æ³¨é‡Šï¼šé å·¦ */\n}\n\n/* ä¸»æŒ‰é’®ï¼šç•¥å¸¦å“ç‰Œè‰²è°ƒï¼ˆè“é’ï¼‰ */\n.btn.primary {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šä¸»æŒ‰é’® */\n  background: linear-gradient(180deg, #e0f2fe, #bfdbfe); /* ä¸­æ–‡æ³¨é‡Šï¼šæµ…è“æ¸å˜ */\n  border-color: #93c5fd; /* ä¸­æ–‡æ³¨é‡Šï¼šæè¾¹è“ */\n  color: #0f172a; /* ä¸­æ–‡æ³¨é‡Šï¼šæ·±è‰²æ–‡å­— */\n}\n\n/* æ¬¡æŒ‰é’®ï¼šæ›´ç´ é›… */\n.btn.subtle {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šæ¬¡æŒ‰é’® */\n  background: linear-gradient(180deg, #f9fafb, #f3f4f6); /* ä¸­æ–‡æ³¨é‡Šï¼šæµ…ç°æ¸å˜ */\n  border-color: #e5e7eb; /* ä¸­æ–‡æ³¨é‡Šï¼šæµ…ç°æè¾¹ */\n}\n\n/* æ‚¬åœä¸æŒ‰å‹åé¦ˆ */\n.btn:hover {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šæ‚¬åœæ€ */\n  transform: translateY(-1px); /* ä¸­æ–‡æ³¨é‡Šï¼šè½»æµ®èµ· */\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 6px 16px rgba(0, 0, 0, 0.12); /* ä¸­æ–‡æ³¨é‡Šï¼šå¢å¼ºæŠ•å½± */\n}\n.btn:active {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šæŒ‰ä¸‹æ€ */\n  transform: translateY(0); /* ä¸­æ–‡æ³¨é‡Šï¼šå›è½ */\n  box-shadow:\n    inset 0 1px 0 #fff,\n    0 2px 8px rgba(0, 0, 0, 0.1); /* ä¸­æ–‡æ³¨é‡Šï¼šå›åˆ°è½»æŠ•å½± */\n}\n\n/* ç„¦ç‚¹å¯è§æ€§ï¼ˆæ— éšœç¢ï¼‰ */\n.btn:focus-visible {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šé”®ç›˜èšç„¦æ€ */\n  outline: 2px solid #60a5fa; /* ä¸­æ–‡æ³¨é‡Šï¼šè“è‰²æè¾¹ */\n  outline-offset: 2px; /* ä¸­æ–‡æ³¨é‡Šï¼šæè¾¹åç§» */\n}\n\n/* å›¾æ ‡ä¸æ–‡å­— */\n.ico {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šå›¾æ ‡æ¡† */\n  display: inline-grid; /* ä¸­æ–‡æ³¨é‡Šï¼šç½‘æ ¼æ”¾ç½® */\n  place-items: center; /* ä¸­æ–‡æ³¨é‡Šï¼šå±…ä¸­ */\n  width: 22px; /* ä¸­æ–‡æ³¨é‡Šï¼šå®½åº¦ */\n  height: 22px; /* ä¸­æ–‡æ³¨é‡Šï¼šé«˜åº¦ */\n  filter: saturate(0.95); /* ä¸­æ–‡æ³¨é‡Šï¼šè½»é¥±å’Œ */\n}\n.label {\n  /* ä¸­æ–‡æ³¨é‡Šï¼šæ–‡å­— */\n  white-space: nowrap; /* ä¸­æ–‡æ³¨é‡Šï¼šä¸æ¢è¡Œï¼ˆæ–‡å­—çŸ­ï¼‰ */\n  overflow: hidden; /* ä¸­æ–‡æ³¨é‡Šï¼šæº¢å‡ºè£å‰ª */\n  text-overflow: ellipsis; /* ä¸­æ–‡æ³¨é‡Šï¼šçœç•¥å· */\n}\n</style>\n'],sourceRoot:''}]);const s=i},741:(e,n,t)=>{var a=t(527);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('25167c60',a,!1,{ssrId:!0})},744:(e,n,t)=>{var a=t(806);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('8f9a273e',a,!1,{ssrId:!0})},790:e=>{e.exports=function(e){var n=e[1],t=e[3];if(!t)return n;if('function'==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),r='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(a),o='/*# '.concat(r,' */');return[n].concat([o]).join('\n')}return[n].join('\n')}},802:(e,n,t)=>{var a=t(160);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('6d351864',a,!1,{ssrId:!0})},806:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.floating-ball[data-v-ee0f5b22]{--size:50px;--hue:212;--sat:100%;--lum:52%;--surface:hsl(var(--hue) var(--sat) var(--lum));--surface-2:hsl(var(--hue) 95% 64%);--ring:hsl(calc(var(--hue) + 20) 95% 65%);--shadow:rgba(0,123,255,0.36);--glow:rgba(102,200,255,0.55);--inner-shadow:rgba(0,0,0,0.22);--specular:rgba(255,255,255,0.75);--glass:rgba(255,255,255,0.18);width:var(--size);height:var(--size);border-radius:50%;position:relative;display:grid;place-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;background:radial-gradient(120% 120% at 30% 28%,rgba(255,255,255,0.85) 0%,rgba(255,255,255,0.22) 18%,rgba(255,255,255,0) 36%),radial-gradient(120% 120% at 70% 72%,rgba(0,0,0,0.18) 0%,rgba(0,0,0,0) 38%),conic-gradient(from 210deg at 50% 50%,var(--surface),var(--surface-2),var(--surface));box-shadow:inset 0 2px 6px var(--inner-shadow),0 2px 4px rgba(0,0,0,0.08),0 10px 22px var(--shadow);transition:transform 0.28s ease,box-shadow 0.28s ease,filter 0.28s ease;will-change:transform,box-shadow,filter;animation:ball-bob-ee0f5b22 3.2s ease-in-out infinite}.floating-ball[data-v-ee0f5b22]::after{content:\'\';position:absolute;inset:-8px;border-radius:50%;background:conic-gradient(from 0deg,var(--ring),transparent 30%,transparent 70%,var(--ring));filter:blur(6px);opacity:0.55;pointer-events:none;-webkit-mask:radial-gradient(farthest-side,transparent calc(100% - 12px),#000 0);mask:radial-gradient(farthest-side,transparent calc(100% - 12px),#000 0);animation:ring-spin-ee0f5b22 12s linear infinite}.floating-ball[data-v-ee0f5b22]::before{content:\'\';position:absolute;inset:2px;border-radius:50%;background:radial-gradient(120% 80% at 26% 24%,var(--specular) 0%,rgba(255,255,255,0.2) 26%,rgba(255,255,255,0) 46%),linear-gradient(160deg,var(--glass) 0%,rgba(255,255,255,0) 50%);mix-blend-mode:screen;pointer-events:none;transition:opacity 0.28s ease,transform 0.28s ease}.floating-ball[data-v-ee0f5b22]:hover{transform:translateY(-2px) scale(1.04);box-shadow:inset 0 2px 8px rgba(0,0,0,0.22),0 4px 10px rgba(0,0,0,0.12),0 16px 36px rgba(0,123,255,0.45);filter:saturate(1.08)}.floating-ball[data-v-ee0f5b22]:hover::before{opacity:0.95;animation:shimmer-ee0f5b22 1.2s ease-out}.floating-ball[data-v-ee0f5b22]:active{transform:translateY(0) scale(0.98);box-shadow:inset 0 2px 10px rgba(0,0,0,0.28),0 2px 6px rgba(0,0,0,0.12),0 10px 22px rgba(0,123,255,0.35)}.floating-ball[data-v-ee0f5b22]:focus-visible{outline:2px solid rgba(102,200,255,0.85);outline-offset:2px}@media (prefers-reduced-motion:reduce){.floating-ball[data-v-ee0f5b22]{animation:none}.floating-ball[data-v-ee0f5b22]::after{animation:none}}@keyframes ball-bob-ee0f5b22{0%,100%{transform:translateY(0)}50%{transform:translateY(-2px)}}@keyframes ring-spin-ee0f5b22{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes shimmer-ee0f5b22{0%{transform:translateY(-1px) scale(0.98);opacity:0.6}50%{transform:translateY(-2px) scale(1.02);opacity:1}100%{transform:translateY(-1px) scale(0.99);opacity:0.85}}.floating-ball[data-v-ee0f5b22]{--logo-scale:0.38}.era-logo[data-v-ee0f5b22]{font-weight:800;font-size:calc(var(--size) * var(--logo-scale));letter-spacing:0.02em;line-height:1;transform:translateY(-1px);white-space:nowrap;-webkit-user-select:none;user-select:none;pointer-events:none;z-index:1;background:linear-gradient(180deg,rgba(255,255,255,0.96) 0%,rgba(255,255,255,0.55) 45%,rgba(220,240,255,0.4) 65%,rgba(120,195,255,0.55) 100%),linear-gradient(180deg,rgba(0,0,0,0.38),rgba(0,0,0,0) 60%);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 1px 0 rgba(255,255,255,0.75),0 2px 4px rgba(0,0,0,0.25),0 8px 18px rgba(0,123,255,0.35);filter:drop-shadow(0 0 2px rgba(102,200,255,0.25));animation:era-sheen-ee0f5b22 4s ease-in-out infinite}.floating-ball:hover .era-logo[data-v-ee0f5b22]{text-shadow:0 1px 0 rgba(255,255,255,0.85),0 3px 8px rgba(0,0,0,0.28),0 10px 26px rgba(0,123,255,0.55);filter:drop-shadow(0 0 3px rgba(102,200,255,0.38))}@keyframes era-sheen-ee0f5b22{0%,100%{background-position:0% 0%,0% 0%}50%{background-position:0% 40%,0% 0%}}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/components/FloatingBall.vue'],names:[],mappings:'AAuBA,gCACE,WAAY,CACZ,SAAU,CACV,UAAW,CACX,SAAU,CACV,+CAAgD,CAChD,mCAAoC,CACpC,yCAA0C,CAC1C,6BAAiC,CACjC,6BAAiC,CACjC,+BAAmC,CACnC,iCAAqC,CACrC,8BAAkC,CAClC,iBAAkB,CAClB,kBAAmB,CACnB,iBAAkB,CAClB,iBAAkB,CAClB,YAAa,CACb,kBAAmB,CACnB,cAAe,CACf,wBAAiB,CAAjB,gBAAiB,CACjB,uCAAwC,CACxC,+RAQ0G,CAC1G,mGAG0C,CAC1C,uEAGmB,CACnB,uCAA0C,CAC1C,qDACF,CAGA,uCACE,UAAW,CACX,iBAAkB,CAClB,UAAW,CACX,iBAAkB,CAClB,4FAMC,CACD,gBAAiB,CACjB,YAAa,CACb,mBAAoB,CACpB,gFAA2E,CAA3E,wEAA2E,CAC3E,gDACF,CAGA,wCACE,UAAW,CACX,iBAAkB,CAClB,SAAU,CACV,iBAAkB,CAClB,oLAE+E,CAC/E,qBAAsB,CACtB,mBAAoB,CACpB,kDAGF,CAGA,sCACE,sCAAuC,CACvC,wGAGgD,CAChD,qBACF,CAGA,8CACE,YAAa,CACb,wCACF,CAGA,uCACE,mCAAoC,CACpC,wGAIF,CAGA,8CACE,wCAA4C,CAC5C,kBACF,CAGA,uCACE,gCACE,cACF,CACA,uCACE,cACF,CACF,CAGA,6BACE,QAEE,uBACF,CACA,IACE,0BACF,CACF,CAGA,8BACE,GACE,sBACF,CACA,KACE,wBACF,CACF,CAGA,4BACE,GACE,sCAAuC,CACvC,WACF,CACA,IACE,sCAAuC,CACvC,SACF,CACA,KACE,sCAAuC,CACvC,YACF,CACF,CAGA,gCACE,iBACF,CAEA,2BACE,eAAgB,CAChB,+CAAgD,CAChD,qBAAsB,CACtB,aAAc,CACd,0BAA2B,CAC3B,kBAAmB,CACnB,wBAAiB,CAAjB,gBAAiB,CACjB,mBAAoB,CACpB,SAAU,CAGV,wMAQmF,CACnF,4BAA6B,CAC7B,oBAAqB,CACrB,iBAAkB,CAClB,qGAG8C,CAC9C,kDAAsD,CACtD,oDACF,CAEA,gDACE,sGAGqC,CACrC,kDACF,CAGA,8BACE,QAEE,+BAGF,CACA,IACE,gCAGF,CACF',sourcesContent:['<template>\n  <div class="floating-ball" @click="$emit(\'click\')">\n    <span class="era-logo" aria-hidden="true">ERA</span>\n    \x3c!-- ä»…æ˜¾ç¤ºç”¨ï¼›ä¸æ‹¦æˆªäº‹ä»¶ --\x3e\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { onMounted } from \'vue\';\nimport { Logger } from \'../../utils/log\';\n\nconst logger = new Logger(\'ui-FloatingBall\');\ndefineEmits([\'click\']);\n\nonMounted(() => {\n  logger.log(\'onMounted\', \'FloatingBall.vue ç»„ä»¶å·²æŒ‚è½½\');\n});\n<\/script>\n\n<style scoped>\n/* =========================\n   å¯è°ƒå¤–è§‚å˜é‡ï¼ˆå±€éƒ¨ä½œç”¨åŸŸï¼‰\n   ========================= */\n.floating-ball {\n  --size: 50px; /* ç›´å¾„ï¼šä¿æŒé»˜è®¤ 50pxï¼Œä¸åŸå§‹ä¸€è‡´ */\n  --hue: 212; /* ä¸»è‰²ç›¸ï¼š212â‰ˆ#007bffï¼Œæ–¹ä¾¿å…¨å±€åè°ƒè‰²ç›¸ */\n  --sat: 100%; /* é¥±å’Œåº¦ï¼šæ›´é²œäº® */\n  --lum: 52%; /* æ˜åº¦ï¼šä¸»è‰²çš„æ˜åº¦ */\n  --surface: hsl(var(--hue) var(--sat) var(--lum)); /* ä¸»è¡¨é¢è‰² */\n  --surface-2: hsl(var(--hue) 95% 64%); /* æ¸å˜ç¬¬äºŒè‰²ï¼Œç•¥äº® */\n  --ring: hsl(calc(var(--hue) + 20) 95% 65%); /* å¤–ç¯çš„ç‚¹ç¼€è‰²ï¼Œåé’ä¸€ç‚¹ */\n  --shadow: rgba(0, 123, 255, 0.36); /* é˜´å½±é¢œè‰²ï¼ˆä¸ä¸»è‰²ç›¸è¿‘ï¼‰ */\n  --glow: rgba(102, 200, 255, 0.55); /* å¤–å‘å…‰é¢œè‰² */\n  --inner-shadow: rgba(0, 0, 0, 0.22); /* å†…é˜´å½±å¢å¼ºä½“ç§¯æ„Ÿ */\n  --specular: rgba(255, 255, 255, 0.75); /* é«˜å…‰ */\n  --glass: rgba(255, 255, 255, 0.18); /* ç»ç’ƒè´¨æ„Ÿè¦†ç›–å±‚ */\n  width: var(--size); /* å®½åº¦è®¾ä¸ºå¯å˜é‡ */\n  height: var(--size); /* é«˜åº¦è®¾ä¸ºå¯å˜é‡ */\n  border-radius: 50%; /* åœ†å½¢ */\n  position: relative; /* ä½œä¸ºä¼ªå…ƒç´ å®šä½å‚ç…§ */\n  display: grid; /* ç”¨ grid å®ç°ç²¾ç¡®å±…ä¸­ */\n  place-items: center; /* å±…ä¸­å¯¹é½ */\n  cursor: pointer; /* æ‰‹å‹å…‰æ ‡ï¼ˆä»…è§†è§‰ï¼Œä¸æ”¹é€»è¾‘ï¼‰ */\n  user-select: none; /* é˜²æ­¢è¯¯é€‰ä¸­æ–‡æœ¬ */\n  -webkit-tap-highlight-color: transparent; /* ç§»åŠ¨ç«¯ç‚¹å‡»é«˜äº®å»é™¤ */\n  background:\n    radial-gradient(\n      120% 120% at 30% 28%,\n      rgba(255, 255, 255, 0.85) 0%,\n      rgba(255, 255, 255, 0.22) 18%,\n      rgba(255, 255, 255, 0) 36%\n    ),\n    /* ç»ç’ƒé«˜å…‰ */ radial-gradient(120% 120% at 70% 72%, rgba(0, 0, 0, 0.18) 0%, rgba(0, 0, 0, 0) 38%),\n    /* å¾®å†…é˜´å½±ï¼Œå¢åŠ ä½“ç§¯ */ conic-gradient(from 210deg at 50% 50%, var(--surface), var(--surface-2), var(--surface)); /* ä¸»è¡¨é¢æ¸å˜ï¼šæŸ”å’ŒæµåŠ¨æ„Ÿ */\n  box-shadow:\n    inset 0 2px 6px var(--inner-shadow),\n    /* å†…é˜´å½±ï¼šçƒä½“è¾¹ç¼˜æ”¶æŸ */ 0 2px 4px rgba(0, 0, 0, 0.08),\n    /* åŸºç¡€æŠ•å½±ï¼šè´´åœ°æ„Ÿ */ 0 10px 22px var(--shadow); /* è¿œæŠ•å½±ï¼šæ‚¬æµ®æ„Ÿ */\n  transition:\n    transform 0.28s ease,\n    box-shadow 0.28s ease,\n    filter 0.28s ease; /* æ‚¬åœæ—¶çš„å¹³æ»‘è¿‡æ¸¡ */\n  will-change: transform, box-shadow, filter; /* æç¤ºæµè§ˆå™¨ä¼˜åŒ– */\n  animation: ball-bob 3.2s ease-in-out infinite; /* è½»å¾®ä¸Šä¸‹æµ®åŠ¨ */\n}\n\n/* å…‰æ™•å¤–ç¯ï¼ˆçº¯è§†è§‰å±‚ï¼‰ï¼Œä¸å ç‚¹å‡»åŒºåŸŸ */\n.floating-ball::after {\n  content: \'\'; /* ç”Ÿæˆå¤–ç¯å±‚ */\n  position: absolute; /* ç»å¯¹å®šä½è´´åˆçˆ¶å…ƒç´  */\n  inset: -8px; /* å‘å¤–å»¶å±• 8pxï¼Œåˆ¶é€ å‘å…‰è¾¹ç¼˜ */\n  border-radius: 50%; /* ä¿æŒåœ†å½¢ */\n  background: conic-gradient(\n    from 0deg,\n    var(--ring),\n    transparent 30%,\n    transparent 70%,\n    var(--ring)\n  ); /* ç»†è…»çš„è‰²ç¯é—ªçƒ */\n  filter: blur(6px); /* æ¨¡ç³ŠæˆæŸ”å’Œå…‰æ™• */\n  opacity: 0.55; /* åŠé€æ˜ï¼Œé¿å…å–§å®¾ */\n  pointer-events: none; /* ä¸æ‹¦æˆªé¼ æ ‡äº‹ä»¶ */\n  mask: radial-gradient(farthest-side, transparent calc(100% - 12px), #000 0); /* æç©ºä¸­å¿ƒå½¢æˆç¯ */\n  animation: ring-spin 12s linear infinite; /* æ…¢é€Ÿæ—‹è½¬ï¼Œä½ä¾µæ‰° */\n}\n\n/* ç»ç’ƒé«˜å…‰å±‚ï¼ˆæ›´ç«‹ä½“ï¼‰ */\n.floating-ball::before {\n  content: \'\'; /* ç”Ÿæˆé«˜å…‰å±‚ */\n  position: absolute; /* ç»å¯¹å®šä½ */\n  inset: 2px; /* ç¼©è¿›ä¸€ç‚¹ï¼Œä¿ç•™è¾¹ç¼˜ */\n  border-radius: 50%; /* åœ†å½¢ */\n  background:\n    radial-gradient(120% 80% at 26% 24%, var(--specular) 0%, rgba(255, 255, 255, 0.2) 26%, rgba(255, 255, 255, 0) 46%),\n    /* äº®æ–‘ */ linear-gradient(160deg, var(--glass) 0%, rgba(255, 255, 255, 0) 50%); /* ç»ç’ƒè’™å±‚ */\n  mix-blend-mode: screen; /* ä¸åº•è‰²å åŠ æ›´è‡ªç„¶ */\n  pointer-events: none; /* ä¸æ‹¦æˆªäº‹ä»¶ */\n  transition:\n    opacity 0.28s ease,\n    transform 0.28s ease; /* æ‚¬åœè”åŠ¨ */\n}\n\n/* æ‚¬åœæ€ï¼šè½»å¾®æŠ¬å‡+å¢å¼ºå…‰å½± */\n.floating-ball:hover {\n  transform: translateY(-2px) scale(1.04); /* è½»å¾®å‡èµ·å¹¶æ”¾å¤§ */\n  box-shadow:\n    inset 0 2px 8px rgba(0, 0, 0, 0.22),\n    /* å†…é˜´å½±ç•¥åŠ å¼º */ 0 4px 10px rgba(0, 0, 0, 0.12),\n    /* è¿‘å½±å¢å¼º */ 0 16px 36px rgba(0, 123, 255, 0.45); /* è¿œå½±æ›´äº®ï¼Œå‘ˆç°å‘å…‰ */\n  filter: saturate(1.08); /* æå‡é¥±å’Œåº¦ä¸€ç‚¹ç‚¹ */\n}\n\n/* æ‚¬åœæ—¶çš„å¾®å…‰æ‰«è¿‡æ•ˆæœ */\n.floating-ball:hover::before {\n  opacity: 0.95; /* é«˜å…‰æ›´æ˜¾è‘— */\n  animation: shimmer 1.2s ease-out; /* ä¸€æ¬¡æ€§é«˜å…‰æ è¿‡ */\n}\n\n/* æŒ‰ä¸‹æ€ï¼šç•¥å‹ä½ */\n.floating-ball:active {\n  transform: translateY(0) scale(0.98); /* å›è½ä¸€ç‚¹å¹¶è½»å¾®å‹æ‰ */\n  box-shadow:\n    inset 0 2px 10px rgba(0, 0, 0, 0.28),\n    0 2px 6px rgba(0, 0, 0, 0.12),\n    0 10px 22px rgba(0, 123, 255, 0.35); /* å›åˆ°æ¥è¿‘åˆå§‹çš„é˜´å½± */\n}\n\n/* å¯è¾¾æ€§ï¼šé”®ç›˜èšç„¦æ—¶çš„å¯è§æè¾¹ï¼ˆä¸æ”¹å˜å¸ƒå±€ï¼‰ */\n.floating-ball:focus-visible {\n  outline: 2px solid rgba(102, 200, 255, 0.85); /* é«˜äº®æè¾¹ */\n  outline-offset: 2px; /* å¤–ç§» 2pxï¼Œé¿å…é®æŒ¡çƒä½“ */\n}\n\n/* å‡å°‘åŠ¨æ€åå¥½ï¼šå…³é—­åŠ¨ç”»ä¿æŒé™æ€ä¼˜é›… */\n@media (prefers-reduced-motion: reduce) {\n  .floating-ball {\n    animation: none;\n  } /* å»é™¤ä¸Šä¸‹æµ®åŠ¨ */\n  .floating-ball::after {\n    animation: none;\n  } /* åœæ­¢å¤–ç¯æ—‹è½¬ */\n}\n\n/* è½»å¾®ä¸Šä¸‹æµ®åŠ¨ï¼ˆå¾ªç¯ï¼‰ */\n@keyframes ball-bob {\n  0%,\n  100% {\n    transform: translateY(0);\n  } /* èµ·ç‚¹/ç»ˆç‚¹ï¼šåŸä½ */\n  50% {\n    transform: translateY(-2px);\n  } /* ä¸­ç‚¹ï¼šä¸Šæµ® 2px */\n}\n\n/* å¤–ç¯æ…¢é€Ÿæ—‹è½¬ï¼ˆä¸åˆºçœ¼ï¼‰ */\n@keyframes ring-spin {\n  0% {\n    transform: rotate(0deg);\n  } /* èµ·ç‚¹ï¼š0 åº¦ */\n  100% {\n    transform: rotate(360deg);\n  } /* ç»ˆç‚¹ï¼šæ•´å‘¨æ—‹è½¬ */\n}\n\n/* æ‚¬åœæ—¶çš„é«˜å…‰æ‰«è¿‡ */\n@keyframes shimmer {\n  0% {\n    transform: translateY(-1px) scale(0.98);\n    opacity: 0.6;\n  } /* åˆå§‹ï¼šå¼±ä¸€ç‚¹çš„é«˜å…‰ */\n  50% {\n    transform: translateY(-2px) scale(1.02);\n    opacity: 1;\n  } /* ä¸­æ®µï¼šæœ€äº®æœ€å¤§ */\n  100% {\n    transform: translateY(-1px) scale(0.99);\n    opacity: 0.85;\n  } /* ç»“æŸï¼šå›è½ */\n}\n\n/* ======= ERA å†…æ ‡ï¼ˆä»…è§†è§‰å±‚ï¼‰ ======= */\n.floating-ball {\n  --logo-scale: 0.38;\n} /* å¯è°ƒï¼šå­—ä½“å çƒç›´å¾„æ¯”ä¾‹ */\n\n.era-logo {\n  font-weight: 800; /* ç²—ä½“ï¼Œå¢å¼ºåˆ»æ„Ÿ */\n  font-size: calc(var(--size) * var(--logo-scale)); /* è·Ÿéšçƒå¤§å°ç¼©æ”¾ */\n  letter-spacing: 0.02em; /* è½»å¾®å­—è·ï¼Œé¿å…ç³Š */\n  line-height: 1; /* ç´§å‡‘å¯¹é½ */\n  transform: translateY(-1px); /* è§†è§‰å¾®è°ƒå±…ä¸­ */\n  white-space: nowrap; /* é˜²æ­¢æ¢è¡Œ */\n  user-select: none;\n  pointer-events: none; /* ä¸æŠ¢äº‹ä»¶ã€ä¸é€‰ä¸­ */\n  z-index: 1; /* ä½äºèƒŒæ™¯ä¹‹ä¸Šï¼ˆä»åœ¨ ::after å…‰ç¯ä¹‹ä¸‹ï¼‰ */\n\n  /* æ¸å˜é•‚ç©ºå­— + ç«‹ä½“é˜´å½± */\n  background:\n    linear-gradient(\n      180deg,\n      rgba(255, 255, 255, 0.96) 0%,\n      rgba(255, 255, 255, 0.55) 45%,\n      rgba(220, 240, 255, 0.4) 65%,\n      rgba(120, 195, 255, 0.55) 100%\n    ),\n    /* é«˜å…‰åˆ°å†·è“çš„å±‚æ¬¡ */ linear-gradient(180deg, rgba(0, 0, 0, 0.38), rgba(0, 0, 0, 0) 60%); /* è½»å†…é˜´å½± */\n  -webkit-background-clip: text;\n  background-clip: text; /* æ¸å˜è£å‰ªåˆ°æ–‡å­— */\n  color: transparent; /* é•‚ç©ºå¡«å……ç”±èƒŒæ™¯æä¾› */\n  text-shadow:\n    0 1px 0 rgba(255, 255, 255, 0.75),\n    /* é¡¶éƒ¨æ£å…‰ */ 0 2px 4px rgba(0, 0, 0, 0.25),\n    /* è¿‘é˜´å½± */ 0 8px 18px rgba(0, 123, 255, 0.35); /* è¿œå‘å…‰é˜´å½± */\n  filter: drop-shadow(0 0 2px rgba(102, 200, 255, 0.25)); /* æŸ”å…‰æ™• */\n  animation: era-sheen 4s ease-in-out infinite; /* è½»å¾®é«˜å…‰æµåŠ¨ */\n}\n\n.floating-ball:hover .era-logo {\n  text-shadow:\n    0 1px 0 rgba(255, 255, 255, 0.85),\n    0 3px 8px rgba(0, 0, 0, 0.28),\n    0 10px 26px rgba(0, 123, 255, 0.55); /* æ‚¬åœå¢å¼ºç«‹ä½“æ„Ÿ */\n  filter: drop-shadow(0 0 3px rgba(102, 200, 255, 0.38)); /* å‘å…‰ç•¥åŠ å¼º */\n}\n\n/* é«˜å…‰ç¼“æ…¢ä¸Šç§»ï¼Œåˆ¶é€ ç»ç’ƒæµå…‰æ„Ÿï¼ˆä½ä¾µæ‰°ï¼‰ */\n@keyframes era-sheen {\n  0%,\n  100% {\n    background-position:\n      0% 0%,\n      0% 0%;\n  }\n  50% {\n    background-position:\n      0% 40%,\n      0% 0%;\n  }\n}\n</style>\n'],sourceRoot:''}]);const s=i},840:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var a=t(790),r=t.n(a),o=t(54),i=t.n(o)()(r());i.push([e.id,'.era-app-container{position:fixed;inset:0;z-index:2147483646;pointer-events:none;isolation:isolate;contain:layout style paint;width:100svw;height:100svh}\n','',{version:3,sources:['webpack://./src/ERAå˜é‡æ¡†æ¶/ui/App.vue'],names:[],mappings:'AAqLA,mBAEE,cAAe,CACf,OAAQ,CACR,kBAAmB,CACnB,mBAAoB,CACpB,iBAAkB,CAClB,0BAA2B,CAC3B,YAAa,CACb,aACF',sourcesContent:['<template>\n  <div class="era-app-container">\n    <FloatingBall v-show="currentComponent === \'FloatingBall\'" @click="requestSwitchView(\'ExpandedView\')" />\n    <div v-show="currentComponent === \'ExpandedView\'" class="era-expanded-layer">\n      \x3c!-- è§†å£çº§å±•å¼€å±‚ï¼šæ‚¬æµ®æ¨¡æ€å®¹å™¨ --\x3e\n      <div class="era-shell">\n        \x3c!-- æ–°å¢æ¨ªå‘å£³å®¹å™¨ï¼šå·¦é¢æ¿ + å³ä¾§æ  --\x3e\n        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ¨ªå‘å¸ƒå±€å®¹å™¨ --\x3e\n        <div class="era-panel">\n          \x3c!-- ä¿æŒé¢æ¿åŸæœ‰ç»“æ„ä¸å˜ --\x3e\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå·¦ä¾§ ERA é¢æ¿ --\x3e\n          \x3c!-- é¡¶éƒ¨æ ï¼šæ ‡é¢˜ + å…³é—­æŒ‰é’® --\x3e\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé¢æ¿é¡¶éƒ¨ --\x3e\n          <header class="panel-top">\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé¡¶æ  --\x3e\n            <h3 class="panel-title">ERA æ•°æ®é¢æ¿</h3>\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ ‡é¢˜ --\x3e\n            <button class="btn-close" aria-label="å…³é—­" @click="requestSwitchView(\'FloatingBall\')">Ã—</button>\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå…³é—­æŒ‰é’® --\x3e\n          </header>\n\n          \x3c!-- å†…å®¹åŒºï¼ˆåŸæ ·ä¿ç•™ï¼‰ --\x3e\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé¢æ¿ä¸»ä½“ --\x3e\n          <div class="panel-body">\n            \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå¯æ»šåŠ¨å†…å®¹ --\x3e\n            <template v-if="dataRef">\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæœ‰æ•°æ®åˆ™æ¸²æŸ“ --\x3e\n              <MetaHeader :mk="dataRef.mk" :message-id="dataRef.message_id" />\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæœ€æ–°æ¶ˆæ¯å…ƒæ•°æ® --\x3e\n\n              <EraAccordion title="ERA æœ€æ–°æ“ä½œè¯¦æƒ…" :default-open="false">\n                \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå¤–å±‚æŠ˜å  --\x3e\n                <template #default>\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ --\x3e\n                  <div style="display: flex; flex-direction: column; gap: 8px">\n                    \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå †å ä¸¤ä¸ªå­æŠ˜å  --\x3e\n                    <EraAccordion title="SelectedMksï¼ˆæ•°ç»„ï¼‰" :default-open="false">\n                      \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå­æŠ˜å 1 --\x3e\n                      <template #default>\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ --\x3e\n                        <PrettyJsonViewer :value="dataRef.selectedMks" :default-collapsed="true" :max-depth="3" />\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                      </template>\n                    </EraAccordion>\n                    <EraAccordion title="EditLogsï¼ˆå¯¹è±¡ï¼‰" :default-open="false">\n                      \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå­æŠ˜å 2 --\x3e\n                      <template #default>\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ --\x3e\n                        <PrettyJsonViewer :value="dataRef.editLogs" :default-collapsed="true" :max-depth="2" />\n                        \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                      </template>\n                    </EraAccordion>\n                  </div>\n                </template>\n              </EraAccordion>\n\n              <TabSwitch v-model:active="activeTab" :tabs="tabs">\n                \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šé€‰é¡¹å¡ --\x3e\n                <template #pure>\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šçº¯å‡€çŠ¶æ€æ•°æ® --\x3e\n                  <PrettyJsonViewer :value="dataRef.statWithoutMeta" :default-collapsed="true" :max-depth="Infinity" />\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                </template>\n                <template #full>\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå®Œæ•´çŠ¶æ€æ•°æ® --\x3e\n                  <PrettyJsonViewer :value="dataRef.stat" :default-collapsed="true" :max-depth="Infinity" />\n                  \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ --\x3e\n                </template>\n              </TabSwitch>\n            </template>\n\n            <template v-else>\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæš‚æ— æ•°æ®å ä½ --\x3e\n              <div class="empty">ç­‰å¾… era:writeDone äº‹ä»¶æ•°æ®â€¦</div>\n              \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå ä½æç¤º --\x3e\n            </template>\n          </div>\n        </div>\n\n        \x3c!-- å³ä¾§å›ºå®šæ ï¼šåªæ”¹å˜â€œä½ç½®/å¤–éƒ¨ç»“æ„â€ï¼Œä¸æ”¹æŒ‰é’®é€»è¾‘ --\x3e\n        <aside class="right-rail">\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šå³ä¾§æ å®¹å™¨ --\x3e\n          <ActionButtons />\n          \x3c!-- ä¸­æ–‡æ³¨é‡Šï¼šæ“ä½œæŒ‰é’®ç»„ä»¶ï¼ˆäº‹ä»¶ä¿æŒä¸å˜ï¼‰ --\x3e\n          <EraSettingsPanel />\n        </aside>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { computed, onMounted, ref, watch } from \'vue\';\nimport { Logger } from \'../utils/log\';\nimport ActionButtons from \'./components/ActionButtons.vue\';\nimport EraSettingsPanel from \'./components/EraSettingsPanel.vue\';\nimport FloatingBall from \'./components/FloatingBall.vue\';\n\n// ä» EraDataPanel è¿ç§»è¿‡æ¥çš„ imports\nimport EraAccordion from \'./components/era-panel/parts/EraAccordion.vue\';\nimport MetaHeader from \'./components/era-panel/parts/MetaHeader.vue\';\nimport PrettyJsonViewer from \'./components/era-panel/parts/PrettyJsonViewer.vue\';\nimport TabSwitch from \'./components/era-panel/parts/TabSwitch.vue\';\n\n// ä» EraDataPanel è¿ç§»è¿‡æ¥çš„ç±»å‹å®šä¹‰\ntype Actions = { rollback: boolean; apply: boolean; resync: boolean; api: boolean; apiWrite: boolean };\nexport interface WriteDonePayload {\n  mk: string;\n  message_id: number;\n  actions: Actions;\n  selectedMks: (string | null)[];\n  editLogs: Record<string, any[]>;\n  stat: any;\n  statWithoutMeta: any;\n  consecutiveProcessingCount: number;\n}\n\n// TabSwitch éœ€è¦çš„ç±»å‹\ntype TabItem = { key: \'pure\' | \'full\'; label: string };\n\nconst logger = new Logger(\'ui-App\');\n\n// App.vue åŸæœ‰çš„ props\nconst props = defineProps({\n  initialView: {\n    type: String,\n    required: true,\n    default: \'FloatingBall\',\n  },\n  eventData: {\n    type: Object as () => WriteDonePayload | null,\n    default: () => null,\n  },\n});\n\n// App.vue åŸæœ‰çš„é€»è¾‘\nconst currentComponent = ref(props.initialView);\nconst requestSwitchView = (viewName: \'FloatingBall\' | \'ExpandedView\') => {\n  logger.debug(\'requestSwitchView\', `è¯·æ±‚åˆ‡æ¢è§†å›¾åˆ°: ${viewName}`);\n  if ((window as any).eraUiSwitchView) {\n    (window as any).eraUiSwitchView(viewName);\n  } else {\n    logger.warn(\'requestSwitchView\', \'å…¨å±€åˆ‡æ¢å‡½æ•° eraUiSwitchView æœªæ‰¾åˆ°\');\n  }\n};\n\n// ä» EraDataPanel è¿ç§»è¿‡æ¥çš„é€»è¾‘\nconst dataRef = computed(() => props.eventData || null);\n\nconst tabs: TabItem[] = [\n  { key: \'pure\', label: \'çº¯å‡€çŠ¶æ€æ•°æ®\' },\n  { key: \'full\', label: \'å®Œæ•´çŠ¶æ€æ•°æ®\' },\n];\nconst activeTab = ref<\'pure\' | \'full\'>(\'pure\');\n\nonMounted(() => {\n  logger.log(\'onMounted\', \'App.vue ç»„ä»¶å·²æŒ‚è½½\', { props: props });\n});\n\nwatch(\n  () => props.eventData,\n  (newData, oldData) => {\n    logger.debug(\'watch:eventData\', \'eventData prop å‘ç”Ÿå˜åŒ–\', {\n      newData,\n      oldData,\n    });\n  },\n  { deep: true },\n);\n\nwatch(\n  () => props.initialView,\n  newView => {\n    logger.debug(\'watch:initialView\', `initialView prop å‘ç”Ÿå˜åŒ–ï¼Œæ–°è§†å›¾: ${newView}`);\n    currentComponent.value = newView;\n  },\n);\n<\/script>\n\n<style>\n/* App.vue è§†å£çº§æ‚¬æµ®å®¹å™¨ï¼ˆæ›¿æ¢åŸæœ‰ .era-app-containerï¼‰ */\n.era-app-container {\n  /* ä½œä¸ºå…¨å±€æ‚¬æµ®å±‚æ ¹å®¹å™¨ */\n  position: fixed; /* å›ºå®šåœ¨è§†å£ï¼Œä¸å—å¤–å±‚å¸ƒå±€å½±å“ */\n  inset: 0; /* è¦†ç›–æ•´ä¸ªè§†å£åŒºåŸŸï¼ˆtop/right/bottom/left å…¨ 0ï¼‰ */\n  z-index: 2147483646; /* è¶…é«˜å±‚çº§ï¼Œç›–ä½ç«™ç‚¹å…¶å®ƒå±‚ */\n  pointer-events: none; /* é»˜è®¤ä¸æˆªè·ç‚¹å‡»ï¼Œé¿å…é˜»æŒ¡é¡µé¢ */\n  isolation: isolate; /* æ–°å»ºç‹¬ç«‹å±‚å ä¸Šä¸‹æ–‡ï¼Œé˜²æ­¢è¢«å¤–å±‚æ··åˆå½±å“ */\n  contain: layout style paint; /* åˆ›å»ºæ¸²æŸ“å°è£…ï¼Œå‡å°‘å¤–ç•Œå¹²æ‰° */\n  width: 100svw; /* é€‚é…ç§»åŠ¨ç«¯åŠ¨æ€è§†å£å®½åº¦ */\n  height: 100svh; /* é€‚é…ç§»åŠ¨ç«¯åŠ¨æ€è§†å£é«˜åº¦ */\n}\n</style>\n\n<style scoped>\n/* ä» EraDataPanel.vue è¿ç§»è¿‡æ¥çš„æ ·å¼ */\n.era-panel {\n  width: min(960px, 60vw);\n  height: min(680px, 86vh);\n  display: flex;\n  flex-direction: column;\n  background: linear-gradient(180deg, rgba(255, 255, 255, 0.75), rgba(255, 255, 255, 0.65));\n  border: 1px solid rgba(255, 255, 255, 0.6);\n  backdrop-filter: blur(10px);\n  border-radius: 16px;\n  box-shadow:\n    0 10px 40px rgba(0, 0, 0, 0.18),\n    inset 0 1px 0 rgba(255, 255, 255, 0.6);\n  overflow: hidden;\n  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;\n}\n\n.panel-top {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 14px 16px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.06);\n  background: linear-gradient(90deg, rgba(255, 255, 255, 0.65), rgba(255, 255, 255, 0.45));\n}\n.panel-title {\n  font-size: 16px;\n  font-weight: 800;\n  letter-spacing: 0.5px;\n  color: #1f2937;\n}\n.btn-close {\n  width: 32px;\n  height: 32px;\n  line-height: 30px;\n  text-align: center;\n  border-radius: 8px;\n  border: 1px solid rgba(0, 0, 0, 0.08);\n  background: #fff;\n  cursor: pointer;\n  font-size: 18px;\n  color: #6b7280;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n}\n.btn-close:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);\n}\n\n.panel-body {\n  padding: 14px 14px 16px;\n  overflow: auto;\n}\n\n.block {\n  margin: 12px 0 4px;\n  padding: 10px 12px;\n  background: rgba(255, 255, 255, 0.6);\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 12px;\n}\n.block-title {\n  margin: 0 0 8px;\n  font-size: 13px;\n  font-weight: 800;\n  color: #374151;\n}\n\n.chips {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n.chip {\n  font-size: 12px;\n  padding: 6px 8px;\n  border: 1px solid rgba(0, 0, 0, 0.06);\n  border-radius: 999px;\n  background: linear-gradient(180deg, #fafafa, #f4f4f4);\n  color: #6b7280;\n  box-shadow: inset 0 1px 0 #fff;\n}\n.chip.ok {\n  color: #065f46;\n  background: linear-gradient(180deg, #ecfdf5, #d1fae5);\n  border-color: #a7f3d0;\n}\n\n.mk-strip {\n  display: flex;\n  gap: 8px;\n  flex-wrap: wrap;\n  max-height: 140px;\n  overflow: auto;\n}\n.mk-pill {\n  display: inline-flex;\n  gap: 6px;\n  align-items: center;\n  padding: 6px 8px;\n  background: linear-gradient(180deg, #eef2ff, #e0e7ff);\n  color: #4338ca;\n  border: 1px solid #c7d2fe;\n  border-radius: 8px;\n  font-size: 12px;\n}\n.mk-pill.is-null {\n  background: linear-gradient(180deg, #f9fafb, #f3f4f6);\n  color: #6b7280;\n  border-color: #e5e7eb;\n}\n\n.empty {\n  height: 360px;\n  display: grid;\n  place-items: center;\n  color: #6b7280;\n  font-size: 14px;\n  border: 1px dashed rgba(0, 0, 0, 0.08);\n  border-radius: 12px;\n  background: rgba(255, 255, 255, 0.5);\n}\n\n/* ===[æ–°å¢] æŠ˜å æ—¶æŠŠâ€œæŒ‰é’®åç´§é‚»çš„å†…å®¹ä½“â€å½»åº•å‹å¹³å¹¶è£å‰ªï¼ˆé€šç”¨è§„åˆ™ï¼‰ === */\n/* é€‚é… EraAccordionï¼šæ ‡é¢˜æŒ‰é’®æœ‰ aria-expandedï¼Œå†…å®¹ä½“æ˜¯ç´§é‚»å…„å¼Ÿå…ƒç´  */\n:deep(button[aria-expanded=\'false\'] + *) {\n  height: 0 !important; /* é«˜åº¦å‹åˆ° 0ï¼Œå½»åº•æ”¶èµ· */\n  padding-top: 0 !important; /* å»æ‰ä¸Šä¸‹å†…è¾¹è·ï¼Œé˜²æ­¢éœ²å‡ºä¸€æ¡è¾¹ */\n  padding-bottom: 0 !important;\n  margin-top: 0 !important; /* å»æ‰ä¸Šä¸‹å¤–è¾¹è·ï¼Œé¿å… margin æŠ˜å ç©¿å‡º */\n  margin-bottom: 0 !important;\n  border-top-width: 0 !important; /* è‹¥å†…å®¹ä½“è‡ªèº«æœ‰åˆ†å‰²çº¿ï¼ŒæŠ˜å æ—¶å»æ‰ */\n  border-bottom-width: 0 !important;\n  overflow: clip !important; /* å…³é”®ï¼šè£å‰ªä¸€åˆ‡å­å†…å®¹ï¼ˆå«è™šçº¿/é˜´å½±ï¼‰ */\n  contain: paint !important; /* é˜²æ­¢å­çº§é˜´å½±/è¾¹æ¡†è¶…å‡ºè£å‰ªè¾¹ç•Œ */\n}\n\n/* å±•å¼€çŠ¶æ€å¯æ¢å¤å¯è§æº¢å‡ºï¼ˆå¦‚æ‚¬æµ®æç¤ºï¼‰ï¼Œé»˜è®¤å³å¯ï¼Œå¯ä¿å®ˆåŠ ä¸€æ¡ï¼š */\n:deep(button[aria-expanded=\'true\'] + *) {\n  overflow: visible; /* å±•å¼€æ—¶æ¢å¤æ­£å¸¸ç»˜åˆ¶ */\n}\n\n/* ===[æ–°å¢] æ¨ªå‘å£³ï¼šå·¦é¢æ¿ + å³ä¾§æ ï¼ˆæŒ‰é’®ï¼‰=== */\n.era-shell {\n  /* æ¨ªå‘åŒ…è£¹å®¹å™¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šæ¨ªå‘æ’åˆ—å®¹å™¨ */\n  display: flex; /* æ¨ªå‘å¸ƒå±€ */ /* ä¸­æ–‡æ³¨é‡Šï¼šflex æ¨ªæ’ */\n  align-items: flex-start; /* é¡¶å¯¹é½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¸Šç¼˜å¯¹é½ */\n  gap: 12px; /* å·¦å³é—´è· */ /* ä¸­æ–‡æ³¨é‡Šï¼šå…ƒç´ é—´è· */\n  flex-wrap: nowrap; /* é»˜è®¤ä¸æ¢è¡Œ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¿æŒå¹¶æ’ */\n}\n\n/* ä¿æŒé¢æ¿å®½é«˜ï¼ˆåŸæ ·ï¼‰ï¼Œä½†è®©å®ƒæ›´å¥½åœ°åœ¨æ¨ªå‘ä¸­è‡ªé€‚åº” */\n.era-panel {\n  /* å·²å­˜åœ¨ï¼šæ­¤å¤„åªè¯´æ˜è¯­ä¹‰ï¼Œä¸åšè¦†ç›– */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¿ç•™åŸæ ·å¼ */\n  flex: 0 1 auto; /* é¢æ¿æŒ‰è‡ªèº«å®½åº¦å¸ƒå±€ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¸å¼ºè¡Œæ‹‰ä¼¸ */\n}\n\n/* å³ä¾§æ å¤–æ¡†ï¼šä¸å·¦é¢æ¿è§†è§‰ç»Ÿä¸€ï¼ˆç»ç’ƒå¡ç‰‡é£ï¼‰ */\n.right-rail {\n  /* å³ä¾§åŒºåŸŸå®¹å™¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¾§æ  */\n  width: min(320px, 34vw); /* å®½åº¦è‡ªé€‚åº”ï¼Œæ¡Œé¢çº¦ 280-320px ä½“éªŒæœ€ä½³ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¾§æ å®½åº¦ */\n  position: sticky; /* ç²˜é™„åœ¨è§†å£å†…æ»šåŠ¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå¸é™„åœ¨è§†å£é¡¶éƒ¨ */\n  top: 10px; /* ä¸é¡¶éƒ¨ç•™ç™½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå¸é¡¶é—´è· */\n  align-self: flex-start; /* ä¸å·¦ä¾§é¢æ¿é¡¶éƒ¨å¯¹é½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šè‡ªèº«å¯¹é½é¡¶éƒ¨ */\n  z-index: 1; /* é¿å…è¢«é¢æ¿é˜´å½±è¦†ç›– */ /* ä¸­æ–‡æ³¨é‡Šï¼šæå‡å±‚çº§ */\n}\n\n/* å°å±å›è½ï¼šæ”¹ä¸ºä¸Šä¸‹å †å ï¼ˆæŒ‰é’®åœ¨ä¸‹ï¼‰ */\n@media (max-width: 1100px) {\n  /* 1100px ä¸‹å›è½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå“åº”å¼æ–­ç‚¹ */\n  .era-shell {\n    /* æ¨ªå‘å®¹å™¨ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå®¹å™¨ */\n    flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå…è®¸å †å  */\n  }\n  .right-rail {\n    /* ä¾§æ  */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¾§æ  */\n    width: 100%; /* å æ»¡ä¸€è¡Œ */ /* ä¸­æ–‡æ³¨é‡Šï¼šå…¨å®½ */\n    position: static; /* å–æ¶ˆå¸é¡¶ï¼Œé¿å…çª„å±é®æŒ¡ */ /* ä¸­æ–‡æ³¨é‡Šï¼šä¸å¸é¡¶ */\n    margin-top: 8px; /* ä¸ä¸Šæ–¹ç•™ç™½ */ /* ä¸­æ–‡æ³¨é‡Šï¼šé—´è· */\n  }\n}\n\n/* ===[æ–°å¢] æ‚¬æµ®çƒï¼šå›ºå®šåœ¨å³ä¸‹è§’ + å¼€å¯ç‚¹å‡» === */\n:deep(.floating-ball) {\n  /* é€‰ä¸­å­ç»„ä»¶æ ¹å…ƒç´ ï¼ˆscoped ä¸‹ç”¨ deepï¼‰ */\n  position: fixed; /* å›ºå®šå®šä½åˆ°è§†å£ */\n  right: max(16px, env(safe-area-inset-right)); /* å³ä¾§å®‰å…¨åŒº + åŸºç¡€è¾¹è· */\n  bottom: max(90px, env(safe-area-inset-bottom)); /* åº•éƒ¨å®‰å…¨åŒº + åŸºç¡€è¾¹è· */\n  z-index: 2147483647; /* é«˜äºå®¹å™¨æ ¹ï¼Œç¡®ä¿å§‹ç»ˆå¯ç‚¹ */\n  pointer-events: auto; /* å¯ç”¨ç‚¹å‡»ï¼ˆçˆ¶å®¹å™¨æ˜¯ noneï¼‰ */\n  touch-action: manipulation; /* ç§»åŠ¨ç«¯å‡å°‘ç‚¹å‡»å»¶è¿Ÿ */\n  will-change: transform; /* æå‰åˆ†å±‚ï¼Œé¿å…ç«™ç‚¹ 3D/æ»¤é•œå½±å“ */\n}\n\n/* ===[æ–°å¢] å±•å¼€å±‚ï¼šè§†å£çº§æ¨¡æ€å®¹å™¨ï¼ˆåªåœ¨ ExpandedView v-show ä¸º true æ—¶å­˜åœ¨ï¼‰ === */\n.era-expanded-layer {\n  /* ç»‘å®šåœ¨æ¨¡æ¿æ–°å¢çš„ class */\n  position: fixed; /* å›ºå®šåœ¨è§†å£ï¼ˆä¸å—å¤–å±‚å¸ƒå±€çº¦æŸï¼‰ */\n  inset: 0; /* é“ºæ»¡è§†å£ */\n  display: grid; /* ç”¨ grid å±…ä¸­å†…å®¹ */\n  place-items: center; /* æ°´å¹³å‚ç›´ç½®ä¸­ */\n  padding: clamp(12px, 2.5vw, 24px); /* è§†å£è‡ªé€‚åº”å†…è¾¹è· */\n  pointer-events: auto; /* å¯ç”¨ç‚¹å‡»ï¼ˆä¸çˆ¶å®¹å™¨çš„ none åŒºåˆ†ï¼‰ */\n  z-index: 2147483646; /* ä»…æ¬¡äºæ‚¬æµ®çƒï¼Œä¿è¯åœ¨æœ€ä¸Šå±‚ */\n  background: transparent; /* å¦‚éœ€åŠé€æ˜é®ç½©å¯æ”¹ä¸º rgba(0,0,0,.25) */\n  overflow: auto; /* å†…å®¹è¶…å‡ºæ—¶ï¼Œå®¹å™¨è‡ªèº«æ»šåŠ¨ï¼Œä¸è¢«è£å‰ª */\n}\n\n/* ===[æ–°å¢] å°å±é€‚é…ï¼šé¢æ¿åœ¨ç§»åŠ¨ç«¯æ›´â€œå¡«å……â€å¯è§†åŒº === */\n@media (max-width: 640px) {\n  /* é’ˆå¯¹æ‰‹æœºå®½åº¦ */\n  .era-panel {\n    /* é‡è®¾é¢æ¿å®½é«˜æ›´è´´åˆæ‰‹æœº */\n    width: min(92vw, 560px); /* æ”¾å®½åˆ° 92vwï¼Œé¿å… 60vw å¤ªçª„ */\n    height: min(88vh, calc(100svh - 32px)); /* å…¼é¡¾çŠ¶æ€æ /åœ°å€æ åŠ¨æ€é«˜åº¦ */\n  }\n  .panel-body {\n    /* ä¸»è¦å†…å®¹åŒºæ»šåŠ¨å®¹å™¨ */\n    overscroll-behavior: contain; /* é˜²æ­¢æ»šåŠ¨ç‰µåŠ¨èƒŒæ™¯é¡µé¢ */\n  }\n}\n</style>\n'],sourceRoot:''}]);const s=i},988:(e,n,t)=>{var a=t(354);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('173d0d96',a,!1,{ssrId:!0})}},t={};function a(e){var r=t[e];if(void 0!==r)return r.exports;var o=t[e]={id:e,exports:{}};return n[e](o,o.exports,a),o.exports}a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};const r=z,o=r.z.object({å¼€å¯æ‚¬æµ®çƒ:r.z.boolean().default(!0),å¼ºåˆ¶é‡è½½åŠŸèƒ½:r.z.boolean().default(!1),å¼ºåˆ¶é‡è½½æ¶ˆæ¯æ•°:r.z.number().default(2)}),i={type:'chat'},s='ERAMetaData',l='stat_data',c='EditLogs',d='SelectedMks',p='era_data',A=new RegExp(`<${p}>({.*?})<\\/${p}>`),u={INSERT_BY_OBJECT:'era:insertByObject',UPDATE_BY_OBJECT:'era:updateByObject',INSERT_BY_PATH:'era:insertByPath',UPDATE_BY_PATH:'era:updateByPath',DELETE_BY_OBJECT:'era:deleteByObject',DELETE_BY_PATH:'era:deleteByPath',GET_CURRENT_VARS:'era:getCurrentVars'},g='era:writeDone',f='era:apiWrite',C='era_debug_config';let m=[],b=[];function x(){try{const e=globalThis.localStorage?.getItem(C)||'{"enabled":[],"disabled":[]}',n=JSON.parse(e),t=e=>new RegExp(`^${e.replace(/\*/g,'.*?')}$`);m=(n.enabled||[]).map(t),b=(n.disabled||[]).map(t)}catch(e){console.error('ã€ŠERA-Logã€‹: åŠ è½½è°ƒè¯•é…ç½®å¤±è´¥ã€‚',e),m=[],b=[]}}function v(e){const n={enabled:[...new Set(e.enabled)],disabled:[...new Set(e.disabled)]};globalThis.localStorage?.setItem(C,JSON.stringify(n)),x(),console.log('%cã€ŠERA-Logã€‹è°ƒè¯•æ¨¡å¼å·²æ›´æ–°ã€‚','color: #3498db; font-weight: bold;',{'å¯ç”¨ (Enabled)':n.enabled,'ç¦ç”¨ (Disabled)':n.disabled})}if(x(),'undefined'!=typeof globalThis){const e={add(e){const n=globalThis.localStorage?.getItem(C)||'{"enabled":[],"disabled":[]}',t=JSON.parse(n),a=new Set(t.enabled||[]),r=new Set(t.disabled||[]);a.add(e),r.delete(e),v({enabled:Array.from(a),disabled:Array.from(r)})},remove(e){const n=globalThis.localStorage?.getItem(C)||'{"enabled":[],"disabled":[]}',t=JSON.parse(n),a=new Set(t.enabled||[]),r=new Set(t.disabled||[]);r.add(e),a.delete(e),v({enabled:Array.from(a),disabled:Array.from(r)})},status(){const e=globalThis.localStorage?.getItem(C)||'{"enabled":[],"disabled":[]}',n=JSON.parse(e);console.log('%cã€ŠERA-Logã€‹å½“å‰è°ƒè¯•é…ç½®:','color: #3498db; font-weight: bold;',n)},clear(){v({enabled:[],disabled:[]})}};globalThis.eraDebug=e}const h={mk:''};class y{moduleName;constructor(e){this.moduleName=e||(this._getModuleNameFromStack()||'unknown')}_getModuleNameFromStack(){try{const e=((new Error).stack||'').split('\n').find(e=>e.includes('/src/ERAå˜é‡æ¡†æ¶/')&&!e.includes('/utils/log.ts'));if(!e)return null;const n=e.match(/src\/ERAå˜é‡æ¡†æ¶\/([^?:\s)]+)/);if(!n||!n[1])return null;let t=n[1];return t=t.replace(/\.(vue|ts|js)$/,''),t.replace(/^src\/ERAå˜é‡æ¡†æ¶\//,'').replace(/\/index$/,'').replace(/\//g,'-')}catch(e){return console.error('ã€ŠERA-Log-Debugã€‹: è§£ææ¨¡å—åæ—¶å‘ç”Ÿæ„å¤–é”™è¯¯ã€‚',e),null}}formatMessage(e,n){return`ã€ŠERAã€‹${h.mk?`ï¼ˆ${h.mk}ï¼‰`:''}ã€Œ${this.moduleName}ã€ã€${e}ã€‘${String(n)}`}debug(e,n,t){if(!(a=this.moduleName)||b.some(e=>e.test(a))||0===m.length||!m.some(e=>e.test(a)))return;var a;const r=this.formatMessage(e,n);void 0!==t?console.debug(r,t):console.debug(r)}log(e,n,t){const a=this.formatMessage(e,n);void 0!==t?console.log(`%c${a}`,'color: #3498db;',t):console.log(`%c${a}`,'color: #3498db;')}warn(e,n,t){const a=this.formatMessage(e,n);void 0!==t?console.warn(`%c${a}`,'color: #f39c12;',t):console.warn(`%c${a}`,'color: #f39c12;')}error(e,n,t){const a=this.formatMessage(e,n);void 0!==t?console.error(`%c${a}`,'color: #e74c3c; font-weight: bold;',t):console.error(`%c${a}`,'color: #e74c3c; font-weight: bold;')}}const B=new y,w={INIT:[tavern_events.APP_READY],SYNC:['manual_write',f,tavern_events.MESSAGE_RECEIVED,tavern_events.MESSAGE_DELETED,tavern_events.MESSAGE_SWIPED,tavern_events.CHAT_CHANGED,'manual_sync','manual_full_sync','combo_sync'],API:Object.values(u),UPDATE_MK_ONLY:[tavern_events.MESSAGE_SENT],COLLISION_DETECTORS:[tavern_events.GENERATION_STARTED],COMBO_STARTERS:[tavern_events.MESSAGE_UPDATED]},k=new Map([[tavern_events.MESSAGE_SWIPED,{next:tavern_events.GENERATION_STARTED,maxInterval:600}]]),E=new Map([[tavern_events.MESSAGE_UPDATED,{next:tavern_events.GENERATION_STARTED,resultType:'combo_sync',maxInterval:1600}]]),S=new Map([[tavern_events.MESSAGE_SWIPED,500],[tavern_events.MESSAGE_UPDATED,1500]]);function N(e){return w.INIT.includes(e)?'INIT':w.SYNC.includes(e)?'SYNC':w.API.includes(e)?'API':w.UPDATE_MK_ONLY.includes(e)?'UPDATE_MK_ONLY':w.COLLISION_DETECTORS.includes(e)?'COLLISION_DETECTORS':w.COMBO_STARTERS.includes(e)?'COMBO_STARTERS':'UNKNOWN'}function V(e){const n=_.cloneDeep(e),t=[];for(const n of e){if(0===t.length){t.push(n);continue}const e=t[t.length-1],a=n.timestamp-e.timestamp,r=E.get(e.type);if(r&&n.type===r.next){if(a<=r.maxInterval){B.debug('mergeEventBatch',`æ£€æµ‹åˆ°äº‹ä»¶ç»„åˆ: ${e.type} å’Œ ${n.type} (æ—¶é—´å·®: ${a}ms <= ${r.maxInterval}ms)ã€‚å°†åˆå¹¶ä¸º ${r.resultType} äº‹ä»¶ã€‚`),t.pop(),t.push({type:r.resultType,timestamp:n.timestamp,detail:n.detail});continue}B.debug('mergeEventBatch',`æ£€æµ‹åˆ°æ½œåœ¨çš„äº‹ä»¶ç»„åˆï¼Œä½†å› è¶…æ—¶è€Œå¤±è´¥: ${e.type} å’Œ ${n.type} (æ—¶é—´å·®: ${a}ms > ${r.maxInterval}ms)ã€‚`)}const o=k.get(e.type);if(o&&n.type===o.next){if(a<=o.maxInterval){B.debug('mergeEventBatch',`æ£€æµ‹åˆ°ç›¸é‚»äº‹ä»¶å¯¹å†²: ${e.type} å’Œ ${n.type} (æ—¶é—´å·®: ${a}ms <= ${o.maxInterval}ms)ã€‚å°†å¿½ç•¥è¿™ä¸¤ä¸ªäº‹ä»¶ã€‚`),t.pop();continue}B.debug('mergeEventBatch',`æ£€æµ‹åˆ°æ½œåœ¨çš„äº‹ä»¶å¯¹å†²ï¼Œä½†å› è¶…æ—¶è€Œå¤±è´¥: ${e.type} å’Œ ${n.type} (æ—¶é—´å·®: ${a}ms > ${o.maxInterval}ms)ã€‚`)}const i=N(e.type);i===N(n.type)&&'SYNC'===i?t[t.length-1]=n:t.push(n)}const a=t.filter(e=>{const n=N(e.type),t='COLLISION_DETECTORS'===n,a='COMBO_STARTERS'===n;return(t||a)&&B.debug('mergeEventBatch',`æ¸…ç†æœªé…å¯¹çš„äº‹ä»¶: ${e.type}`),!t&&!a});return B.debug('mergeEventBatch',`äº‹ä»¶åˆå¹¶: ${n.length} -> ${a.length}`,{before:n.map(e=>e.type),after:a.map(e=>e.type)}),a}const D=_;var O=a.n(D);function M(e){if(!O().isObject(e))return e;const n=O().cloneDeep(e);return function e(n){if(Array.isArray(n))n.forEach(n=>e(n));else if(O().isPlainObject(n))for(const t in n)t.startsWith('$')?delete n[t]:e(n[t])}(n),n}function F(){const e=getVariables(i)||{};return{meta:O().get(e,s,{}),stat:O().get(e,l,{})}}async function T(e){await updateVariablesWith(async n=>{const t=O().get(n,l,{}),a=await e(t);return O().set(n,l,a),n},i)}async function R(e){await updateVariablesWith(async n=>{const t=O().get(n,s,{}),a=await e(t);return O().set(n,s,a),n},i)}function j(){const e=getVariables({type:'script',script_id:getScriptId()});return o.parse(e??{})}async function I(e){await updateVariablesWith(async n=>{const t=o.parse(n??{});return await e(t)},{type:'script',script_id:getScriptId()})}function P(e){if(!e.includes('{{'))return e;let n=e;return n=n.replace(/{{user}}/gi,SillyTavern.name1),n=n.replace(/{{char}}/gi,SillyTavern.name2),n}const J=new y;function L(e){if(!e)return null;let n=null;if('string'==typeof e.mes)n=e.mes;else if(Array.isArray(e.swipes)){const t=Number(e.swipe_id??0);n=e.swipes[t]||null}else'string'==typeof e.message&&(n=e.message);return null===n?null:P(n)}function Y(e){const n=function(e){if('string'!=typeof e)return null;const n=e.match(A);if(!n||!n[1])return null;try{const e=n[1],t=e.match(/"era-message-key"\s*=\s*"(.*?)"/),a=e.match(/"era-message-type"\s*=\s*"(.*?)"/);if(t?.[1]&&a?.[1]){const e={'era-message-key':t[1],'era-message-type':a[1]};return J.debug('parseEraData','æˆåŠŸè§£æ EraData',e),e}return J.debug('parseEraData','æœªèƒ½åœ¨ EraData å—ä¸­æ‰¾åˆ°å®Œæ•´çš„é”®å€¼å¯¹',{customFormatBlock:e}),null}catch(e){return J.warn('parseEraData','è§£æ EraData å—æ—¶å‘ç”Ÿå¼‚å¸¸',e),null}}(L(e));return n?'user'===n['era-message-type']:'user'===e?.role}async function G(e,n){const t=L(e);J.debug('updateMessageContent','æ›´æ–°å‰çš„æ¶ˆæ¯å†…å®¹:',t),J.debug('updateMessageContent','æ›´æ–°åçš„æ¶ˆæ¯å†…å®¹:',n);const a={message_id:e.message_id};if(Array.isArray(e.swipes)){const t=Number(e.swipe_id??0),r=[...e.swipes];r[t]=n,a.swipes=r}else a.message=n;await setChatMessages([a],{refresh:'none'})}function q(e){if(!e)return e;let n=String(e).trim();return n=n.replace(/^\s*(?:```|~~~)\[a-zA-Z0-9_-\]*\s*\r?\n/,''),n=n.replace(/\r?\n(?:```|~~~)\s*$/,''),n.trim()}function U(e='',n='exact'){if('any'===n||'*'===e)return/([a-zA-Z][a-zA-Z0-9_]*)/;const t=e.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');switch(n){case'exact':return new RegExp(`(${t})`);case'prefix':return new RegExp(`(${t}[a-zA-Z0-9_]*)`);case'suffix':return new RegExp(`([a-zA-Z0-9_]*${t})`);default:return new RegExp(`([a-zA-Z0-9_]*${t}[a-zA-Z0-9_]*)`)}}function W(e,n,t=e.length){const a=new RegExp(`</${n.source}>`,'g');let r,o=null;for(;null!==(r=a.exec(e))&&r.index<t;)o=r;if(!o)return null;const i=o[1],s=o.index,l=`<${i}>`,c=e.lastIndexOf(l,s);return-1===c?W(e,n,s):{startIndex:c,endIndex:s+`</${i}>`.length,content:e.substring(c+l.length,s),tagName:i}}function K(e,n){return(n?new RegExp(`</?${n.source}>`):/<\/?\s*[a-zA-Z][a-zA-Z0-9_]*\s*>/).test(e)}function H(e,n){const t=function(e,n){let t=e;for(;;){const e=W(t,n);if(!e)break;t=t.slice(0,e.startIndex)+t.slice(e.endIndex)}return t}(e,U('think','contains')),a=function(e,n){const t=[];let a=e.length;for(;a>0;){const r=W(e,n,a);if(!r)break;t.unshift(r.content),a=r.startIndex}return t}(t,n),r=[];for(const e of a){const n=q(e.trim());K(n)||n&&r.push(n)}return r}const Q=new y;function X(e){if(!e)return'';const n=L(e);return function(e){if('string'!=typeof e)return null;const n=e.match(A);if(!n||!n[1])return null;try{const e=n[1],t=e.match(/"era-message-key"\s*=\s*"(.*?)"/),a=e.match(/"era-message-type"\s*=\s*"(.*?)"/);return t?.[1]&&a?.[1]?{'era-message-key':t[1],'era-message-type':a[1]}:null}catch{return null}}(n)?.['era-message-key']||''}async function Z(e){if(!e||'number'!=typeof e.message_id||!e.role)return Q.warn('ensureMessageKey',`æ— æ•ˆçš„æ¶ˆæ¯å¯¹è±¡ç»“æ„ï¼Œæ— æ³•ç¡®ä¿Keyã€‚msg=${JSON.stringify(e)}`),{mk:'',isNew:!1};const n=X(e);if(n)return{mk:n,isNew:!1};const t=`era_mk_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,a='user'===e.role?'user':'assistant',r=`<${p}>{"era-message-key"="${t}","era-message-type"="${a}"}</${p}>`;Q.log('ensureMessageKey',`ä¸ºæ¶ˆæ¯ (ID: ${e.message_id}) æ³¨å…¥æ–°çš„Key: ${t}`);const o=r+'\n'+(L(e)??'');return await G(e,o),{mk:t,isNew:!0}}const ee=async()=>{const e=getChatMessages(-1,{include_swipes:!0})?.[0];if(!e||'number'!=typeof e.message_id)return;const{mk:n}=await Z(e);n&&await R(t=>{const a=_.get(t,d,[]);return a[e.message_id]!==n&&(a[e.message_id]=n,_.set(t,d,a)),t})},ne=new y('scriptIniter-settings');async function te(){ne.log('initializeExternalSettings','å¼€å§‹åˆå§‹åŒ–è„šæœ¬è®¾ç½®...'),await I(async e=>(ne.debug('initializeExternalSettings','å½“å‰è®¾ç½®:',e),e)),ne.log('initializeExternalSettings','è„šæœ¬è®¾ç½®åˆå§‹åŒ–å®Œæˆã€‚')}$(()=>{te()});const ae=new y,re={'.':'__DOT__','"':'__DQUOTE__','\'':'__SQUOTE__'},oe=_.invert(re),ie=new RegExp(Object.keys(re).map(_.escapeRegExp).join('|'),'g'),se=new RegExp(Object.values(re).map(_.escapeRegExp).join('|'),'g');function le(e){if(Array.isArray(e))return e.map(e=>le(e));if(_.isPlainObject(e)){const n={};for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){n[t.replace(ie,e=>re[e])]=le(e[t])}return n}return'string'==typeof e?e.replace(ie,e=>re[e]):e}function ce(e){if(Array.isArray(e))return e.map(e=>ce(e));if(_.isPlainObject(e)){const n={};for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){n[t.replace(se,e=>oe[e])]=ce(e[t])}return n}return'string'==typeof e?e.replace(se,e=>oe[e]):e}function de(e){if(Array.isArray(e))return e.map(e=>Array.isArray(e)||_.isPlainObject(e)?JSON.stringify(e):e);if(_.isPlainObject(e)){const n={};for(const t in e)n[t]=de(e[t]);return n}return e}const pe=e=>{try{return JSON.stringify(e,null,2)}catch(e){return`<<stringifyå¤±è´¥: ${e?.message||e}>>`}};function Ae(e,n){return _.mergeWith(_.cloneDeep(e),_.cloneDeep(n),(e,n)=>{if(Array.isArray(e)||Array.isArray(n))return n})}function ue(e){if(Array.isArray(e))return e;if(e&&'object'==typeof e)return[e];if('string'==typeof e){const n=e.replace(/^\s*```(?:json)?\s*|\s*```\s*$/g,'');try{const e=JSON.parse(n);return Array.isArray(e)?e:[]}catch{return[]}}return[]}function ge(e){const n=[];if(!e||'string'!=typeof e)return n;const t=function(e){if(!e)return'';let n='',t=!1;for(let a=0;a<e.length;a++){const r=e[a];if('"'!==r||0!==a&&'\\'===e[a-1]||(t=!t),t){n+=r;continue}const o=e[a+1];if('/'===r&&'/'===o){const t=e.indexOf('\n',a+2);if(-1===t)break;n+='\n',a=t;continue}if('/'===r&&'*'===o){const n=e.indexOf('*/',a+2);if(-1===n)break;a=n+1;continue}if('<'===r&&'\x3c!--'===e.substring(a,a+4)){const n=e.indexOf('--\x3e',a+4);if(-1===n)break;a=n+2;continue}n+=r}return n}(e),a=t.trim();let r=0,o=-1,i=!1;for(let e=0;e<a.length;e++){const t=a[e];if('"'!==t||0!==e&&'\\'===a[e-1]||(i=!i),!i)if('{'===t)0===r&&(o=e),r++;else if('}'===t&&r>0&&(r--,0===r&&-1!==o)){const t=a.substring(o,e+1);try{const e=JSON.parse(t);n.push(e)}catch(e){ae.error(`JSONL è§£æå¤±è´¥: ${e?.message||e}. å¤±è´¥çš„ç‰‡æ®µ: ${t}`,e)}o=-1}}return n}const fe=new y,Ce=_.debounce(()=>{eventEmit(f),fe.log('debouncedEmitApiWrite',`å·²è§¦å‘åˆå¹¶åçš„ ${f} äº‹ä»¶ã€‚`)},50,{leading:!1,trailing:!0});function me(e){const{stat:n,meta:t}=F(),a=M(n);fe.debug('emitWriteDoneEvent','è·å–äº†æœ€æ–°çš„ ERA æ•°æ®å¹¶ç”Ÿæˆäº†çº¯å‡€ç‰ˆ',{stat:n,meta:t,statWithoutMeta:a});const r={...e,stat:ce(n),statWithoutMeta:ce(a),selectedMks:_.get(t,d,[]),editLogs:_.get(t,c,{})};fe.debug('emitWriteDoneEvent','åŠ¨æ€æ„å»ºäº†å®Œæ•´çš„äº‹ä»¶è½½è·',{inputPayload:e,fullPayload:r}),eventEmit(g,r),fe.log('emitWriteDoneEvent',`å·²è§¦å‘ ${g} äº‹ä»¶ã€‚æ“ä½œ: ${JSON.stringify(e.actions)}, MK: ${e.mk}, MsgID: ${e.message_id}, è¿ç»­å¤„ç†æ¬¡æ•°: ${e.consecutiveProcessingCount}`)}const be=new y;async function xe(e){const n=pe(e.blockContent),t=`\n<${e.blockTag}>\n${n}\n</${e.blockTag}>`,a=await function(){const e=getChatMessages('0-{{lastMessageId}}',{include_swipes:!0});if(!e||0===e.length)return J.debug('findLastAiMessage','èŠå¤©è®°å½•ä¸ºç©º, æœªæ‰¾åˆ°ä»»ä½•æ¶ˆæ¯ã€‚'),null;for(let n=e.length-1;n>=0;n--){const t=e[n];if(!Y(t))return J.debug('findLastAiMessage',`æ‰¾åˆ°æœ€åä¸€æ¡ AI æ¶ˆæ¯, ID: ${t.message_id}`),t}return J.debug('findLastAiMessage','æœªåœ¨èŠå¤©è®°å½•ä¸­æ‰¾åˆ°ä»»ä½• AI æ¶ˆæ¯ã€‚'),null}();if(!a)return void be.warn('performApiWrite','æ‰¾ä¸åˆ°ä»»ä½• AI æ¶ˆæ¯ï¼Œæ— æ³•æ‰§è¡Œ API å†™å…¥ã€‚');const r=(L(a)??'')+t;be.log('performApiWrite',`å®æ—¶å†™å…¥ API ä»»åŠ¡ (${e.blockTag}) åˆ°æ¶ˆæ¯ ID ${a.message_id}...`),await G(a,r),Ce()}function ve(e,n,t){const{type:a,detail:r}=e;var o,i;n.api=!0,a===u.INSERT_BY_OBJECT?xe({blockTag:'VariableInsert',blockContent:r}):a===u.UPDATE_BY_OBJECT?function(e){xe({blockTag:'VariableEdit',blockContent:e})}(r):a===u.INSERT_BY_PATH?(o=r.path,i=r.value,xe({blockTag:'VariableInsert',blockContent:_.set({},o,i)})):a===u.UPDATE_BY_PATH?function(e,n){xe({blockTag:'VariableEdit',blockContent:_.set({},e,n)})}(r.path,r.value):a===u.DELETE_BY_OBJECT?function(e){xe({blockTag:'VariableDelete',blockContent:e})}(r):a===u.DELETE_BY_PATH?function(e){xe({blockTag:'VariableDelete',blockContent:_.set({},e,{})})}(r.path):a===u.GET_CURRENT_VARS&&function(e){me(e)}(t)}const he=new y;function ye(e,n,t,a){const r=n?_.get(e,n):e;if(void 0===r)return void he.warn('applyDeleteAtLevel',`VariableDelete è·³è¿‡ï¼šè·¯å¾„ä¸å­˜åœ¨ -> ${n||'(root)'}`);const o=_.get(r,['$meta','necessary']),i=_.get(t,'$meta'),s=_.isPlainObject(i)&&_.isEmpty(i)||_.has(t,['$meta','necessary']);if(_.isPlainObject(t)&&!_.isEmpty(t)){if('all'===o&&!s)return void he.warn('applyDeleteAtLevel',`VariableDelete å¤±è´¥ï¼šè·¯å¾„ <${n}> å— "necessary: all" ä¿æŠ¤ï¼Œå…¶å­èŠ‚ç‚¹æ— æ³•è¢«åˆ é™¤ã€‚`);for(const r of Object.keys(t)){ye(e,n?`${n}.${r}`:r,t[r],a)}return}if('self'===o||'all'===o)return void he.warn('applyDeleteAtLevel',`VariableDelete å¤±è´¥ï¼šè·¯å¾„ <${n}> å— "necessary: ${o}" ä¿æŠ¤ï¼Œæ— æ³•è¢«ç›´æ¥åˆ é™¤ã€‚`);if(''===n)return void he.error('applyDeleteAtLevel','VariableDelete å¤±è´¥ï¼šä¸å…è®¸åˆ é™¤æ ¹å¯¹è±¡ã€‚');const l=_.cloneDeep(r);_.unset(e,n),a.push({op:'delete',path:n,value_old:l}),he.debug('applyDeleteAtLevel',`æˆåŠŸåˆ é™¤èŠ‚ç‚¹: ${n}`)}const Be=new y;function we(e,n){if(!e)return;const t=_.get(e,'$template'),a=_.get(e,n);if(_.isPlainObject(t)&&_.isPlainObject(a)){Be.debug('getInheritedTemplateContent',`ä¸ºå­èŠ‚ç‚¹ "${n}" åŒæ—¶æ‰¾åˆ°åŸå‹å’Œç‰¹å¼‚æ€§å†…å®¹ã€‚\n      - åŸå‹: ${JSON.stringify(t)}\n      - ç‰¹å¼‚æ€§: ${JSON.stringify(a)}`);const e=Ae(_.cloneDeep(t),a);return Be.debug('getInheritedTemplateContent',`  - åˆå¹¶å: ${JSON.stringify(e)}`),e}return _.isPlainObject(a)?(Be.debug('getInheritedTemplateContent',`ä¸ºå­èŠ‚ç‚¹ "${n}" åªæ‰¾åˆ°ç‰¹å¼‚æ€§å†…å®¹: ${JSON.stringify(a)}`),a):_.isPlainObject(t)?(Be.debug('getInheritedTemplateContent',`ä¸ºå­èŠ‚ç‚¹ "${n}" åªæ‰¾åˆ°åŸå‹å†…å®¹: ${JSON.stringify(t)}`),t):void Be.debug('getInheritedTemplateContent',`åœ¨çˆ¶çº§æ¨¡æ¿å†…å®¹ä¸­æœªä¸ºå­èŠ‚ç‚¹ "${n}" æ‰¾åˆ°ä»»ä½•å¯ç»§æ‰¿çš„è§„åˆ™ã€‚`)}const ke=new y;function Ee(e,n,t,a,r,o){const i=function(e,n){const t=_.get(n,'$template');Be.debug('resolveTemplate',`è§£æå‡ºçš„æ¨¡æ¿å†…å®¹:\n    - ç»§æ‰¿: ${JSON.stringify(e)}\n    - çˆ¶èŠ‚ç‚¹å˜é‡: ${JSON.stringify(t)}`);let a={};return a=Ae(a,e),a=Ae(a,t),Be.debug('resolveTemplate',`åˆå¹¶åçš„æœ€ç»ˆæ¨¡æ¿å†…å®¹: ${JSON.stringify(a)}`),_.isEmpty(a)?null:a}(r,o);ke.debug('applyInsertAtLevel',`[å…¥å£] basePath: "${n||'root'}"`,{statData:_.cloneDeep(e)});const s=n?_.get(e,n):e;if(ke.debug('applyInsertAtLevel',`[è·¯å¾„æ£€æŸ¥] at path: "${n||'root'}". currentNodeInVars çš„å€¼:`,s),n&&void 0===s){const r=function(e,n){if(Be.debug('applyTemplateToPatch',`[è¿›å…¥] æ¨¡æ¿å†…å®¹: ${JSON.stringify(e)}, è¡¥ä¸: ${JSON.stringify(n)}`),!_.isPlainObject(n))return Be.debug('applyTemplateToPatch','[é€€å‡º] è¡¥ä¸ä¸æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œç›´æ¥è¿”å›ã€‚'),n;if(!e)return Be.debug('applyTemplateToPatch','[é€€å‡º] æ¨¡æ¿å†…å®¹æ— æ•ˆï¼Œç›´æ¥è¿”å›è¡¥ä¸ã€‚'),n;if(_.isEmpty(n))return Be.debug('applyTemplateToPatch','è¡¥ä¸ä¸ºç©ºå¯¹è±¡ï¼Œå®Œå…¨ä½¿ç”¨æ¨¡æ¿å†…å®¹ã€‚'),_.cloneDeep(e);const t=Ae(_.cloneDeep(e),n);return Be.debug('applyTemplateToPatch',`åˆå¹¶æ¨¡æ¿ä¸è¡¥ä¸åçš„ç»“æœ: ${JSON.stringify(t)}`),t}(i,t),o=de(r);return ke.debug('applyInsertAtLevel',`æœ€ç»ˆæ’å…¥æ•°æ® at ${n}:\n${JSON.stringify(o,null,2)}`),_.set(e,n,o),a.push({op:'insert',path:n,value_new:_.cloneDeep(o)}),void ke.debug('applyInsertAtLevel',`åŸå­æ€§æ’å…¥åˆ°æ–°è·¯å¾„: ${n}`)}if(_.isPlainObject(s)&&_.isPlainObject(t)){ke.debug('applyInsertAtLevel',`[é€’å½’è¡¥å……] at path: "${n||'root'}"\n      - å½“å‰å±‚çº§æ¨¡æ¿ (localTplContent): ${JSON.stringify(i)}`);for(const r of Object.keys(t)){const o=n?`${n}.${r}`:r,l=t[r],c=we(i,r);ke.debug('applyInsertAtLevel',`  - å‡†å¤‡é€’å½’å­èŠ‚ç‚¹: "${r}"\n      - å°†ä¼ é€’ç»™å­èŠ‚ç‚¹çš„æ¨¡æ¿ (subInheritedContent): ${JSON.stringify(c)}`),Ee(e,o,l,a,c,s)}}else n&&ke.warn('applyInsertAtLevel',`VariableInsert å¤±è´¥ï¼šè·¯å¾„å·²å­˜åœ¨ä¸”æ— æ³•é€’å½’è¡¥å…… -> ${n}`)}const Se=new y;async function Ne(e,n=!1){try{Se.log('rollbackByMk',`å¼€å§‹å›æ»š, MK=${e}`),await updateVariablesWith(n=>{const t=_.get(n,s,{}),a=_.get(n,l,{}),r=ue(_.get(t,[c,e]));if(!r||!r.length)return Se.debug('rollbackByMk','EditLog ä¸ºç©ºæˆ–æ— æ•ˆï¼Œè·³è¿‡å›æ»šã€‚'),n;for(let e=r.length-1;e>=0;e--){const n=r[e],t=String(n?.op||'').toLowerCase(),o=String(n?.path||'');o&&('insert'!==t?'update'!==t&&'delete'!==t||(void 0===n?.value_old?_.unset(a,o):_.set(a,o,_.cloneDeep(n.value_old))):_.unset(a,o))}return _.set(n,l,a),n},i),Se.log('rollbackByMk',`å›æ»šå®Œæˆï¼šMK=${e}`)}catch(n){Se.error('rollbackByMk',`å›æ»šå¼‚å¸¸ï¼šMK=${e} â†’ ${n?.message||n}`,n)}}async function Ve(e,n){Se?.debug('findLatestNewValue',`å¼€å§‹ä¸ºè·¯å¾„ <${e}> ä»æ¶ˆæ¯ID <${n}> å‘ä¸Šè¿½æº¯å†å²å€¼...`);const t=getChatMessages('0-{{lastMessageId}}',{include_swipes:!1});if(!t||t.length<1)return Se?.debug('findLatestNewValue','æ¶ˆæ¯å†å²ä¸ºç©ºï¼Œæ— æ³•è¿½æº¯ã€‚'),null;const a=t.findIndex(e=>e.message_id===n);if(-1===a)return Se?.warn('findLatestNewValue',`é”™è¯¯ï¼šåœ¨æ¶ˆæ¯åˆ—è¡¨ä¸­æœªæ‰¾åˆ°èµ·å§‹æ¶ˆæ¯ID: ${n}`),null;for(let n=a-1;n>=0;n--){const a=t[n],r=a?.message_id;if(Se?.debug('findLatestNewValue',`[è¿›åº¦] æ­£åœ¨æ£€æŸ¥æ¶ˆæ¯ (ID: ${r})ï¼Œå†…å®¹: "${(L(a)||'').substring(0,100)}..."`),Y(a)||'number'!=typeof r)continue;const o=X(a);if(!o){Se?.debug('findLatestNewValue',`[è¿›åº¦] æ¶ˆæ¯ (ID: ${r}) æ—  MKï¼Œè·³è¿‡ã€‚`);continue}const{meta:i}=F(),s=ue(_.get(i,[c,o]));if(s&&0!==s.length){Se?.debug('findLatestNewValue',`[è¿›åº¦] æ­£åœ¨æ£€æŸ¥ MK ${o} çš„ EditLog...\n${pe(s)}`);for(let n=s.length-1;n>=0;n--){const t=s[n];if(t&&t.path){if(t.path===e)return'delete'===t.op?(Se?.error('findLatestNewValue',`>> çŠ¶æ€å¼‚å¸¸! åœ¨æ¶ˆæ¯(ID:${a.message_id}, MK:${o})ä¸­ä¸ºè·¯å¾„ <${e}> æ‰¾åˆ°äº† 'delete' è®°å½•ã€‚è¿™è¡¨æ˜ update æ“ä½œå¯èƒ½æ­£åœ¨å°è¯•ä¿®æ”¹ä¸€ä¸ªå·²è¢«åˆ é™¤çš„å˜é‡ã€‚`),null):(Se?.debug('findLatestNewValue',`>> æˆåŠŸ! åœ¨æ¶ˆæ¯(ID:${a.message_id}, MK:${o})ä¸­æ‰¾åˆ°ç²¾ç¡®è·¯å¾„ <${e}> çš„å€¼ä¸º: ${pe(t.value_new)}`),_.cloneDeep(t.value_new));if(e.startsWith(t.path+'.')){const n=e.substring(t.path.length+1),r=t.value_new;if(_.isPlainObject(r)&&_.has(r,n)){const e=_.get(r,n);return Se?.debug('findLatestNewValue',`>> æˆåŠŸ! åœ¨æ¶ˆæ¯(ID:${a.message_id}, MK:${o})ä¸­æ‰¾åˆ°çˆ¶çº§è·¯å¾„ <${t.path}>, å¹¶ä»ä¸­æå–å­è·¯å¾„ <${n}> çš„å€¼ä¸º: ${pe(e)}`),_.cloneDeep(e)}}}}}else Se?.debug('findLatestNewValue',`[è¿›åº¦] MK ${o} çš„ EditLog ä¸ºç©ºï¼Œè·³è¿‡ã€‚`)}return Se?.debug('findLatestNewValue',`å‘ä¸Šè¿½æº¯æœªæ‰¾åˆ°è·¯å¾„ ${e} çš„ä»»ä½•å†å²å€¼ï¼Œå°†ä½¿ç”¨ null ä½œä¸ºæ—§å€¼`),null}const _e=new y;async function De(e,n,t,a,r,o){const i=n?_.get(e,n):e;if(void 0===i)return void _e.warn('applyEditAtLevel',`VariableEdit è·³è¿‡ï¼šè·¯å¾„ä¸å­˜åœ¨ -> ${n||'(root)'}`);const s=_.get(i,['$meta','updatable'],!0),l=!1===s&&!0===_.get(t,['$meta','updatable']);if(!1!==s||l)for(const i of Object.keys(t)){const s=n?`${n}.${i}`:i,l=t[i];if(_.isPlainObject(l)){await De(e,s,l,a,r,o);continue}if(!_.has(e,s)){_e.warn('applyEditAtLevel',`VariableEdit å¤±è´¥ï¼šè·¯å¾„éæ³•ï¼Œæ— æ³•å†™å…¥ -> ${s}`);continue}_e.debug('applyEditAtLevel',`[æ—§å€¼æŸ¥æ‰¾] å‡†å¤‡ä¸ºè·¯å¾„ <${s}> ä»æ¶ˆæ¯ ID <${r}> å‘ä¸Šè¿½æº¯...`);let c=await Ve(s,r);null===c?(c=_.get(e,s),_e.debug('applyEditAtLevel',`[æ—§å€¼æŸ¥æ‰¾] è¿½æº¯æœªæ‰¾åˆ°å†å²å€¼ï¼Œä»å½“å‰ stat_data ä¸­è·å–åˆ°æ—§å€¼: ${JSON.stringify(c)}`)):_e.debug('applyEditAtLevel',`[æ—§å€¼æŸ¥æ‰¾] è¿½æº¯æˆåŠŸï¼Œæ‰¾åˆ°å†å²æ—§å€¼: ${JSON.stringify(c)}`);const d=de(l);_.set(e,s,d),a.push({op:'update',path:s,value_old:_.cloneDeep(c),value_new:_.cloneDeep(d)}),o.set(s,_.cloneDeep(d))}else _e.warn('applyEditAtLevel',`VariableEdit å¤±è´¥ï¼šè·¯å¾„ <${n}> å— "$meta.updatable: false" ä¿æŠ¤ï¼Œæ— æ³•è¢«ä¿®æ”¹ã€‚`)}const $e=new y,Oe=async e=>{$e.debug('ApplyVarChangeForMessage','å¼€å§‹å¤„ç†æ¶ˆæ¯...',{msg:e});try{if(!e||'number'!=typeof e.message_id)return $e.warn('ApplyVarChangeForMessage','æ— æ•ˆæ¶ˆæ¯å¯¹è±¡æˆ–ç¼ºå°‘ message_idï¼Œé€€å‡º'),null;const n=e.message_id,t=X(e);if(!t)return $e.debug('ApplyVarChangeForMessage',`æ¶ˆæ¯ (ID: ${n}) ä¸å« MKï¼Œè·³è¿‡å˜é‡å†™å…¥ã€‚`),null;if(Y(e))return $e.debug('ApplyVarChangeForMessage',`æ¶ˆæ¯ (ID: ${n}) ä¸ºç”¨æˆ·æ¶ˆæ¯ï¼Œè·³è¿‡å˜é‡å†™å…¥ï¼Œä½†ä¿ç•™å…¶ MKã€‚`),t;const a=L(e)||'',r=H(a,U('VariableInsert','exact')),o=H(a,U('VariableEdit','exact')),i=H(a,U('VariableDelete','exact'));$e.debug('ApplyVarChangeForMessage','deleteæ‹¿åˆ°çš„æŒ‡ä»¤',i),r.length||o.length||i.length||$e.debug('ApplyVarChangeForMessage',`æ¶ˆæ¯ (ID: ${n}) æœªæ£€æµ‹åˆ°å˜é‡ä¿®æ”¹æ ‡ç­¾ã€‚`);const s=r.flatMap(e=>ge(e)),l=o.flatMap(e=>ge(e)),d=i.flatMap(e=>ge(e)),p=le(s),A=le(l),u=le(d);$e.debug('ApplyVarChangeForMessage','æ•°æ®è½¬ä¹‰å®Œæˆ',{before:{inserts:s,edits:l,deletes:d},after:{inserts:p,edits:A,deletes:u}});const g=[];await async function(e,n){if(e.length>0){await T(async e=>(ke.debug('processInsertBlocks','[åˆå§‹çŠ¶æ€] è¿›å…¥ processInsertBlocks æ—¶çš„ statData:',_.cloneDeep(e)),e));for(const t of e)if(_.isPlainObject(t)&&!_.isEmpty(t))try{await T(e=>(ke.debug('processInsertBlocks',`å¤„ç† insertRoot: ${JSON.stringify(t)}`),Ee(e,'',t,n,null,null),e))}catch(e){ke.error('processInsertBlocks',`å¤„ç† insertRoot å¤±è´¥: ${e?.message||e}`,e)}ke.log('processInsertBlocks','æ‰€æœ‰ VariableInsert æ“ä½œå®Œæˆ')}}(p,g),await async function(e,n,t){if(e.length>0){const a=new Map;for(const r of e)if(_.isPlainObject(r)&&!_.isEmpty(r))try{await T(async e=>(_e.debug('processEditBlocks',`å¤„ç† editRoot: ${JSON.stringify(r)}`),await De(e,'',r,n,t,a),e))}catch(e){_e.error('processEditBlocks',`å¤„ç† editRoot å¤±è´¥: ${e?.message||e}`,e)}_e.log('processEditBlocks','æ‰€æœ‰ VariableEdit æ“ä½œå®Œæˆ')}}(A,g,n),await async function(e,n){if(e.length>0){for(const t of e)if(_.isPlainObject(t)&&!_.isEmpty(t))try{await T(e=>(he.debug('processDeleteBlocks',`å¤„ç† deleteRoot: ${JSON.stringify(t)}`),ye(e,'',t,n),e))}catch(e){he.error('processDeleteBlocks',`å¤„ç† deleteRoot å¤±è´¥: ${e?.message||e}`,e)}he.log('processDeleteBlocks','æ‰€æœ‰ VariableDelete æ“ä½œå®Œæˆ')}}(u,g);try{await R(e=>{const a=Array.isArray(g)?g:ue(g);return $e.debug('ApplyVarChangeForMessage',`å‡†å¤‡ä¸º MK=${t} (MsgID=${n}) å†™å…¥ EditLog:\n${JSON.stringify(a,null,2)}`),_.set(e,[c,t],JSON.stringify(a)),e}),$e.debug('ApplyVarChangeForMessage',`æˆåŠŸä¸º MK=${t} å†™å…¥ EditLogã€‚`)}catch(e){$e.error('ApplyVarChangeForMessage',`ä¸º MK=${t} å†™å…¥ EditLogs å¤±è´¥: ${e?.message||e}`,e)}return t}catch(e){return $e.error('ApplyVarChangeForMessage',`å˜é‡å†™å…¥å™¨å¼‚å¸¸: ${e?.message||e}`,e),null}},Me=new y,Fe=e=>{const n=X(e);return n||null},Te=async(e=!1)=>{e?Me.warn('resyncStateOnHistoryChange','å¼ºåˆ¶å®Œå…¨é‡ç®—æ¨¡å¼å·²å¯åŠ¨ï¼'):Me.log('resyncStateOnHistoryChange','èŠå¤©è®°å½•å˜æ›´ï¼Œå¯åŠ¨çŠ¶æ€åŒæ­¥...');const n=getChatMessages('0-{{lastMessageId}}',{include_swipes:!0});Me.debug('resyncStateOnHistoryChange','è·å–åˆ°çš„ allMessages:',n);const{meta:t}=F(),a=_.cloneDeep(_.get(t,d,[]));if(Me.debug('resyncStateOnHistoryChange',`çŠ¶æ€å¿«ç…§: oldSelectedMks.length=${a.length}, allMessages.length=${n?.length??0}`),!n||0===n.length)return void Me.log('resyncStateOnHistoryChange','å½“å‰èŠå¤©è®°å½•ä¸ºç©ºï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼ŒåŒæ­¥ç»ˆæ­¢ã€‚');let r=-1;if(e)r=0,Me.log('resyncStateOnHistoryChange','å¼ºåˆ¶æ¨¡å¼ï¼šè®¾ç½®é‡ç®—èµ·ç‚¹ä¸º 0ã€‚');else if(n.length<a.length){Me.log('resyncStateOnHistoryChange','æ£€æµ‹åˆ°æ¶ˆæ¯åˆ é™¤ã€‚');for(let e=n.length-1;e>=0;e--){const t=Fe(n[e]),o=a[e];if(Me.debug('resyncStateOnHistoryChange',`[åˆ é™¤-å¯¹é½æ£€æŸ¥] i=${e}, currentMk=${t}, recordedMk=${o}`),t===o){r=e+1,Me.log('resyncStateOnHistoryChange',`æ‰¾åˆ°å¯¹é½ç‚¹äº message_id=${e} (MK=${t})ã€‚å°†ä» ID ${r} å¼€å§‹æ£€æŸ¥ã€‚`);break}}-1===r&&(r=0,Me.log('resyncStateOnHistoryChange','æœªæ‰¾åˆ°ä»»ä½•å¯¹é½ç‚¹ï¼Œå°†ä»å¤´å¼€å§‹æ£€æŸ¥ã€‚'));const e=n.map(Fe).filter(e=>e),t=a.filter(e=>e),o=_.difference(t,e);if(Me.debug('resyncStateOnHistoryChange',`æ—§MKåºåˆ—: [${t.join(', ')}]`),Me.debug('resyncStateOnHistoryChange',`æ–°MKåºåˆ—: [${e.join(', ')}]`),Me.debug('resyncStateOnHistoryChange',`è®¡ç®—å‡ºçš„è¢«åˆ é™¤MK: [${o.join(', ')}]`),o.length>0&&(e=>{const{meta:n}=F();for(const t of e)if(t&&ue(_.get(n,[c,t])).length>0)return!1;return!0})(o)){Me.log('resyncStateOnHistoryChange',`æ£€æµ‹åˆ°è¢«åˆ é™¤çš„ ${o.length} æ¡æ¶ˆæ¯å‡ä¸å«å˜é‡ä¿®æ”¹ï¼Œæ‰§è¡Œå¿«é€ŸåŒæ­¥ã€‚`);const e=[];for(let t=0;t<n.length;t++)e[t]=Fe(n[t]);return await R(n=>(_.set(n,d,e),n)),void Me.log('resyncStateOnHistoryChange','å¿«é€ŸåŒæ­¥å®Œæˆï¼Œä»…ä¿®æ­£ SelectedMks æ•°ç»„ã€‚')}}else if(n.length===a.length){Me.log('resyncStateOnHistoryChange','æ£€æµ‹åˆ°æ¶ˆæ¯é•¿åº¦ä¸å˜ï¼Œå¯èƒ½ä¸ºä¿®æ”¹æˆ–åˆ‡æ¢ã€‚');for(let e=n.length-1;e>=0;e--){const t=Fe(n[e]),o=a[e];Me.debug('resyncStateOnHistoryChange',`[åˆ‡æ¢-å¯¹é½æ£€æŸ¥] i=${e}, currentMk=${t}, recordedMk=${o}`),t!==o&&(r=e)}-1===r?(r=n.length>0?n.length-1:0,Me.log('resyncStateOnHistoryChange',`æ‰€æœ‰MKå‡åŒ¹é…ã€‚å¯åŠ¨æ¨¡æ‹Ÿå†™å…¥ï¼Œå¼ºåˆ¶é‡ç®—æœ€åä¸€æ¡æ¶ˆæ¯ (ID: ${r})ã€‚`)):Me.log('resyncStateOnHistoryChange',`æ‰¾åˆ°æœ€æ—©çš„ä¸åŒ¹é…ç‚¹äº message_id=${r}ã€‚å°†ä»è¯¥ç‚¹å¼€å§‹é‡ç®—ã€‚`)}else Me.log('resyncStateOnHistoryChange','æ£€æµ‹åˆ°æ¶ˆæ¯æ·»åŠ ã€‚'),r=a.length,Me.log('resyncStateOnHistoryChange',`æ–°å¢æ¶ˆæ¯çš„å†™å…¥é€»è¾‘å·²ç”±åŒæ­¥æµç¨‹æ¥ç®¡ã€‚å°†ä»æ–°å¢æ¶ˆæ¯ (ID: ${r}) å¼€å§‹å¤„ç†ã€‚`);if(r>-1){const e=a.slice(r).filter(e=>e);if(e.length>0){Me.log('resyncStateOnHistoryChange',`å‡†å¤‡å›æ»š ${e.length} ä¸ªMK: [${e.join(', ')}]`);for(const n of e.reverse())Me.debug('resyncStateOnHistoryChange',`[å›æ»š] æ­£åœ¨å›æ»š MK: ${n}`),await Ne(n,!0);Me.log('resyncStateOnHistoryChange','é€†åºå›æ»šå®Œæˆã€‚')}}Me.log('resyncStateOnHistoryChange',`ä» ID ${r} å¼€å§‹é¡ºåºé‡ç®—...`);const o=a.slice(0,r);for(let e=r;e<n.length;e++){const t=n[e];Me.debug('resyncStateOnHistoryChange',`[é‡ç®—] æ­£åœ¨å¤„ç†æ¶ˆæ¯ç´¢å¼•: ${e}`);const a=await Oe(t);o[e]=a}Me.log('resyncStateOnHistoryChange','é¡ºåºé‡ç®—å®Œæˆã€‚'),await R(e=>(_.set(e,d,o),e)),Me.log('resyncStateOnHistoryChange','çŠ¶æ€åŒæ­¥å®Œæˆã€‚')},Re=new y;async function je(e){const n=getChatMessages(e);if(!n||0===n.length)return void Re.warn('forceRenderMessage',`æ‰¾ä¸åˆ°æ¶ˆæ¯IDä¸º ${e} çš„æ¶ˆæ¯ã€‚`);const t=n[0];await setChatMessages([{message_id:e,message:t.message}]),Re.debug('forceRenderMessage',`å·²ä½¿ç”¨ setChatMessages åˆ·æ–°æ¶ˆæ¯ ${e}ã€‚`)}const Ie=new y;async function Pe(e,n,t){const{type:a}=e;Ie.debug('handleSyncEvent',`äº‹ä»¶ ${a} è§¦å‘çŠ¶æ€åŒæ­¥æµç¨‹...`);const r='manual_full_sync'===a;await Te(r),n.resync=!0,'combo_sync'!=a&&async function(){const e=getVariables({type:'script',script_id:getScriptId()});if(!_.get(e,'å¼ºåˆ¶é‡è½½åŠŸèƒ½',!1))return void Re.debug('forceRenderRecentMessages','å¼ºåˆ¶é‡è½½åŠŸèƒ½æœªå¯ç”¨, è·³è¿‡ã€‚');const n=_.get(e,'å¼ºåˆ¶é‡è½½æ¶ˆæ¯æ•°',1);Re.log('forceRenderRecentMessages',`å¼€å§‹å¼ºåˆ¶é‡è½½, æ•°é‡: ${n}`),await new Promise(e=>setTimeout(e,1e3));const t=getChatMessages('0-{{lastMessageId}}');if(!t||0===t.length)return void Re.warn('forceRenderRecentMessages','æ— æ³•è·å–åˆ°ä»»ä½•æ¶ˆæ¯, ç»ˆæ­¢é‡è½½ã€‚');const a=t.slice(-n);for(const e of a)Re.debug('forceRenderRecentMessages',`æ­£åœ¨å¼ºåˆ¶æ¸²æŸ“æ¶ˆæ¯: ${e.message_id}`),await je(e.message_id),await new Promise(e=>setTimeout(e,100));Re.log('forceRenderRecentMessages','å¼ºåˆ¶é‡è½½å®Œæˆã€‚')}(),await ee(),me(t)}const ze=new y;let Je=null;function Le(){const e=h.mk;return e&&Je&&Je.mk===e?(ze.debug('updateConsecutiveMkCount',`è¿ç»­å¤„ç†å†™å…¥/åŒæ­¥æ“ä½œçš„ MK: ${e}ã€‚æ—§è®¡æ•°: ${Je.count}ï¼Œæ–°è®¡æ•°: ${Je.count+1}`),Je.count++):(ze.debug('updateConsecutiveMkCount',`æ–°çš„å†™å…¥/åŒæ­¥æ“ä½œçš„ MK: ${e}ã€‚é‡ç½®è®¡æ•°ä¸º 1ã€‚å‰ä¸€ä¸ª MK æ˜¯: ${Je?.mk}`),Je={mk:e,count:1}),Je.count}async function Ye(e,n){const{type:t}=e,a=N(t);let r=null;const o={rollback:!1,apply:!1,resync:!1,api:!1,apiWrite:!1};try{const{mk:i,message_id:s,isNewKey:l}=await(async()=>{try{const e=getChatMessages(-1,{include_swipes:!0})?.[0];if(Q.debug('ensureMkForLatestMessage',`è·å–åˆ°çš„æœ€æ–°æ¶ˆæ¯å¯¹è±¡ (msg): ${JSON.stringify(e)}`),!e||'number'!=typeof e.message_id)return Q.warn('ensureMkForLatestMessage','æ— æ³•è¯»å–æœ€æ–°æ¶ˆæ¯æˆ–å…¶IDï¼Œé€€å‡º'),{mk:'',message_id:null,isNewKey:!1};const{mk:n,isNew:t}=await Z(e);return Q.log('ensureMkForLatestMessage',`å·²ä¸ºæœ€æ–°æ¶ˆæ¯ ${e.message_id} ç¡®ä¿ MK å­˜åœ¨ã€‚ (æ˜¯å¦æ–°å»º: ${t})`),{mk:n,message_id:e.message_id,isNewKey:t}}catch(e){return Q.error('ensureMkForLatestMessage',`ç¡®ä¿MKæ—¶å¼‚å¸¸: ${e?.message||e}`,e),{mk:'',message_id:null,isNewKey:!1}}})();if(!i||null===s)return ze.warn('dispatchAndExecuteTask','æ— æ³•è·å–æœ‰æ•ˆçš„ MK æˆ–æ¶ˆæ¯ IDï¼Œè·³è¿‡ä»»åŠ¡æ‰§è¡Œã€‚'),n;h.mk=i,r=s,l&&i&&(n={mk:i,ignoreCount:1});const{shouldSkip:c,newIgnoreRule:d}=function(e,n,t){return t&&e===tavern_events.CHARACTER_MESSAGE_RENDERED&&n===t.mk?(ze.log('handleRedundantRenderEvent',`å¿½ç•¥ç”± MK (${t.mk}) æ³¨å…¥è§¦å‘çš„å†—ä½™æ¸²æŸ“äº‹ä»¶ã€‚å‰©ä½™å¿½ç•¥æ¬¡æ•°: ${t.ignoreCount-1}`),t.ignoreCount--,t.ignoreCount<=0&&(t=null,ze.log('handleRedundantRenderEvent','å¿½ç•¥æ¬¡æ•°ç”¨å®Œ')),{shouldSkip:!0,newIgnoreRule:t}):{shouldSkip:!1,newIgnoreRule:t}}(t,i,n);if(n=d,c)return n;ze.log('dispatchAndExecuteTask',`æ‰§è¡Œä»»åŠ¡: ${t} (åˆ†ç»„: ${a})`);const p={mk:i,message_id:r,actions:o,consecutiveProcessingCount:1};switch(a){case'INIT':te(),p.consecutiveProcessingCount=Le(),await Pe(e,o,p);break;case'SYNC':p.consecutiveProcessingCount=Le(),await Pe(e,o,p);break;case'API':ve(e,o,p);break;case'UPDATE_MK_ONLY':await async function(){await ee()}()}}catch(e){ze.error('dispatchAndExecuteTask',`äº‹ä»¶ ${t} å¤„ç†å¼‚å¸¸: ${e}`,e)}finally{h.mk=''}return n}const Ge=new y,qe=[];let Ue=!1,We=!1,Ke=null;function He(e,n){Ge.debug('pushToQueue',`æ¥æ”¶åˆ°äº‹ä»¶: ${e}ï¼Œå·²æ¨å…¥é˜Ÿåˆ—ã€‚`,{detail:n}),qe.push({type:e,detail:n,timestamp:Date.now()}),async function(){if(We)return void Ge.debug('processQueue','å·²æœ‰å¤„ç†å‡½æ•°åœ¨æ’é˜Ÿç­‰å¾…ï¼Œæœ¬æ¬¡è°ƒç”¨å¿½ç•¥ã€‚');Ue&&(Ge.debug('processQueue','å¤„ç†å™¨å¿™ç¢Œï¼Œè¿›å…¥æ’é˜Ÿç­‰å¾…çŠ¶æ€...'),We=!0,await new Promise(e=>{Ke=e}),We=!1,Ge.debug('processQueue','ç­‰å¾…ç»“æŸï¼Œè·å–åˆ°å¤„ç†æƒã€‚'));if(0===qe.length)return void Ge.debug('processQueue','é˜Ÿåˆ—ä¸ºç©ºï¼Œæ— éœ€å¤„ç†ã€‚');Ue=!0,Ge.log('processQueue','å¤„ç†å™¨å¯åŠ¨');const e=qe[0];if('API'!==N(e.type)){const n=S.get(e.type)??300;Ge.log('processQueue',`å¯åŠ¨äº‹ä»¶æ”¶é›†çª—å£ï¼Œç­‰å¾… ${n}ms...`),await new Promise(e=>setTimeout(e,n))}Ge.debug('processQueue','äº‹ä»¶æ”¶é›†çª—å£å…³é—­ï¼Œå‡†å¤‡å¤„ç†çš„é˜Ÿåˆ—å†…å®¹:',JSON.stringify(qe.map(e=>e.type)));let n=null;for(;qe.length>0;){const e=qe.splice(0,qe.length),t=V(e);Ge.debug('processQueue',`å¼€å§‹å¤„ç†ä¸€ä¸ªæ–°æ‰¹æ¬¡ï¼ŒåŒ…å« ${e.length} ä¸ªåŸå§‹äº‹ä»¶ï¼Œåˆå¹¶åä¸º ${t.length} ä¸ªä»»åŠ¡ã€‚`);for(const e of t){n=await Ye(e,n)}Ge.debug('processQueue','æœ¬è½®æ‰¹æ¬¡å¤„ç†å®Œæ¯•ã€‚')}if(Ue=!1,Ge.log('processQueue','å¤„ç†å™¨ç©ºé—²ï¼Œå·²é‡Šæ”¾é”ã€‚'),Ke){Ge.debug('processQueue','é€šçŸ¥æ’é˜Ÿçš„å¤„ç†å™¨å¼€å§‹å·¥ä½œã€‚');const e=Ke;Ke=null,e()}}()}const Qe=new y;$(()=>{registerMacroLike(/{{\s*ERA(-withmeta)?\s*:\s*([^}]+?)\s*}}/gi,(e,n,t,a)=>function(e){if(!e.includes('{{ERA'))return e;const{stat:n}=F();return n?e.replace(/{{\s*ERA(-withmeta)?\s*:\s*([^}]+?)\s*}}/gi,(e,t,a)=>{const r=a.trim(),o=!!t;let i;if(i='$ALLDATA'===r?n:_.get(n,r),void 0===i)return Qe.warn('parseEraMacros',`åœ¨ stat_data ä¸­æœªæ‰¾åˆ°è·¯å¾„ "${r}", å®å°†æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸².`),'';const s=o?i:M(i),l=ce(s);return Qe.debug('parseEraMacros',`å®æ›¿æ¢æ•°æ®åè½¬ä¹‰: ${r}`,{before:s,after:l}),'object'==typeof l&&null!==l?JSON.stringify(l):String(l)}):(Qe.warn('parseEraMacros','æ— æ³•è·å–åˆ° stat_data, å®æ›¿æ¢å¤±è´¥.'),e)}(n))});const Xe=Vue,Ze={class:'action-buttons-card',role:'complementary','aria-label':'ERA å¿«æ·æ“ä½œ'},en={class:'btns'},nn=(0,Xe.defineComponent)({__name:'ActionButtons',setup(e){const n=new y('ui-ActionButtons');function t(){n.log('onFullSync','ç‚¹å‡»â€œå®Œå…¨é‡ç®—å˜é‡â€ï¼Œå‘é€ manual_full_sync äº‹ä»¶ã€‚'),eventEmit('manual_full_sync')}function a(){n.log('onLastSync','ç‚¹å‡»â€œé‡ç®—æœ€åä¸€æ¥¼å˜é‡â€ï¼Œå‘é€ manual_sync äº‹ä»¶ã€‚'),eventEmit('manual_sync')}return(e,n)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,null,[(0,Xe.createCommentVNode)(' å³ä¾§æ“ä½œå¡ï¼šå¤–å±‚è‡ªåŒ…å«ï¼Œä¸ä¾èµ–çˆ¶ç»„ä»¶æ ·å¼ '),(0,Xe.createElementVNode)('section',Ze,[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ“ä½œå¡å®¹å™¨ '),n[4]||(n[4]=(0,Xe.createElementVNode)('h4',{class:'card-title'},'å¿«æ·æ“ä½œ',-1)),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå¡ç‰‡æ ‡é¢˜ '),(0,Xe.createElementVNode)('div',en,[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæŒ‰é’®å‚ç›´æ ˆ '),(0,Xe.createElementVNode)('button',{class:'btn primary',title:'é‡æ–°è®¡ç®—æ‰€æœ‰å˜é‡',onClick:(0,Xe.withModifiers)(t,['stop'])},[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šä¸»æŒ‰é’® '),n[0]||(n[0]=(0,Xe.createElementVNode)('span',{class:'ico','aria-hidden':'true'},'ğŸ”„',-1)),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå›¾æ ‡ '),n[1]||(n[1]=(0,Xe.createElementVNode)('span',{class:'label'},'å®Œå…¨é‡ç®—å˜é‡',-1)),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ–‡å­— ')]),(0,Xe.createElementVNode)('button',{class:'btn subtle',title:'åªé‡ç®—æœ€æ–°ä¸€æ¥¼çš„å˜é‡',onClick:(0,Xe.withModifiers)(a,['stop'])},[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ¬¡æŒ‰é’® '),n[2]||(n[2]=(0,Xe.createElementVNode)('span',{class:'ico','aria-hidden':'true'},'â™»ï¸',-1)),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå›¾æ ‡ '),n[3]||(n[3]=(0,Xe.createElementVNode)('span',{class:'label'},'é‡ç®—æœ€åä¸€æ¥¼å˜é‡',-1)),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ–‡å­— ')])])])],2112))}});a(741);var tn=a(441);const an=(0,tn.A)(nn,[['__scopeId','data-v-5766043a']]),rn={class:'settings-card',role:'region','aria-label':'ERA è®¾ç½®'},on=['aria-expanded'],sn={class:'chev','aria-hidden':'true'},ln={class:'content'},cn={class:'toolbar'},dn={class:'vars'},pn=['title'],An={class:'var-editor'},un={key:0,class:'switch'},gn=['onUpdate:modelValue'],fn=['onUpdate:modelValue','placeholder'],Cn=['onUpdate:modelValue','placeholder'],mn=['onUpdate:modelValue','placeholder','onInput'],bn={class:'type-chip'},xn=(0,Xe.defineComponent)({__name:'EraSettingsPanel',setup(e){const n=new y,t=(0,Xe.ref)(!1),a=(0,Xe.ref)([]),r=(0,Xe.reactive)({}),o=(0,Xe.reactive)({}),i=(0,Xe.reactive)({});function s(e){try{return JSON.stringify(e,null,2)}catch{return String(e)}}function l(){try{n.debug('loadVars','å°è¯•è¯»å–è„šæœ¬è®¾ç½®...');const e=j();if(n.debug('loadVars','æˆåŠŸè¯»å–è„šæœ¬è®¾ç½®:',e),!e||0===Object.keys(e).length)return n.warn('loadVars','è®¾ç½®å¯¹è±¡ä¸ºç©ºï¼ŒUI å°†ä¸ä¼šè¢«å¡«å……ã€‚'),void(a.value=[]);a.value=[];for(const e of Object.keys(r))delete r[e];for(const e of Object.keys(o))delete o[e];for(const e of Object.keys(i))delete i[e];Object.entries(e).filter(([e])=>'å¼€å¯æ‚¬æµ®çƒ'!==e).forEach(([e,n])=>{const t='boolean'==typeof(i=n)?'boolean':'number'==typeof i&&Number.isFinite(i)?'number':'string'==typeof i?'string':'json';var i;a.value.push({key:e,value:n,type:t}),'json'===t?o[e]=s(n):r[e]=n})}catch(e){n.error('loadVars','è¯»å–è„šæœ¬å˜é‡å¤±è´¥:',e),alert('è¯»å– ERA è®¾ç½®å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯ã€‚')}}function c(){t.value=!t.value,t.value&&0===a.value.length&&l()}function d(){l()}async function p(){try{await I(e=>{const n={...e};return Object.entries(r).forEach(([e,t])=>{n[e]=t}),Object.entries(o).forEach(([e,t])=>{if(null!=t){if(i[e]?.bad)throw new Error(`é”® ${e} çš„ JSON æ ¼å¼ä¸æ­£ç¡®`);n[e]=JSON.parse(t)}}),n}),n.log('saveEdits','è„šæœ¬å˜é‡å·²ä¿å­˜'),l()}catch(e){n.error('saveEdits','ä¿å­˜å¤±è´¥ï¼š',e),alert(`ä¿å­˜å¤±è´¥ï¼š${e?.message??e}`)}}return(e,n)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,null,[(0,Xe.createCommentVNode)(' å¤–å±‚å¡ç‰‡ï¼šä¸ ActionButtons ä¿æŒä¸€è‡´çš„ç»ç’ƒå¡é£æ ¼ï¼Œä½†é»˜è®¤æ”¶èµ· '),(0,Xe.createElementVNode)('section',rn,[(0,Xe.createCommentVNode)(' è®¾ç½®å¡ç‰‡å®¹å™¨ '),(0,Xe.createCommentVNode)(' æ ‡é¢˜è¡Œï¼šå¯ç‚¹å‡»æŠ˜å /å±•å¼€ '),(0,Xe.createElementVNode)('button',{class:'card-header','aria-expanded':t.value,onClick:c},[(0,Xe.createCommentVNode)(' ç‚¹å‡»åˆ‡æ¢å±•å¼€çŠ¶æ€ '),n[0]||(n[0]=(0,Xe.createElementVNode)('span',{class:'title'},'ERA è®¾ç½®',-1)),(0,Xe.createCommentVNode)(' æ ‡é¢˜æ–‡å­— '),(0,Xe.createElementVNode)('span',sn,(0,Xe.toDisplayString)(t.value?'â–¾':'â–¸'),1),(0,Xe.createCommentVNode)(' å±•å¼€ç®­å¤´ ')],8,on),(0,Xe.createCommentVNode)(' å†…å®¹ä½“ï¼šé»˜è®¤æ”¶èµ·ï¼›å±•å¼€åæ˜¾ç¤ºå˜é‡åˆ—è¡¨ä¸æ“ä½œ '),(0,Xe.withDirectives)((0,Xe.createElementVNode)('div',ln,[(0,Xe.createCommentVNode)(' å±•å¼€å†…å®¹å®¹å™¨ '),(0,Xe.createCommentVNode)(' é¡¶éƒ¨æ“ä½œåŒºï¼šåˆ·æ–°/ä¿å­˜/é‡ç½®ç¼–è¾‘ '),(0,Xe.createElementVNode)('div',cn,[(0,Xe.createCommentVNode)(' å·¥å…·æ¡ '),(0,Xe.createElementVNode)('button',{class:'mini-btn',title:'é‡æ–°è¯»å–è„šæœ¬å˜é‡',onClick:(0,Xe.withModifiers)(l,['stop'])},'ğŸ”„ é‡æ–°è¯»å–'),(0,Xe.createCommentVNode)(' è¯»å–æŒ‰é’® '),n[1]||(n[1]=(0,Xe.createElementVNode)('div',{class:'spacer'},null,-1)),(0,Xe.createCommentVNode)(' å ä½æ’‘å¼€ '),(0,Xe.createElementVNode)('button',{class:'mini-btn subtle',title:'ä¸¢å¼ƒæœªä¿å­˜çš„ä¿®æ”¹',onClick:(0,Xe.withModifiers)(d,['stop'])},'â†©ï¸ ä¸¢å¼ƒä¿®æ”¹'),(0,Xe.createCommentVNode)(' ä¸¢å¼ƒç¼–è¾‘ '),(0,Xe.createElementVNode)('button',{class:'mini-btn primary',title:'ä¿å­˜ä¿®æ”¹åˆ°è„šæœ¬å˜é‡',onClick:(0,Xe.withModifiers)(p,['stop'])},'ğŸ’¾ ä¿å­˜ä¿®æ”¹'),(0,Xe.createCommentVNode)(' ä¿å­˜ä¿®æ”¹ ')]),(0,Xe.createCommentVNode)(' å˜é‡åˆ—è¡¨ï¼šé€é¡¹æ¸²æŸ“ '),(0,Xe.createElementVNode)('div',dn,[a.value.length>0?((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:0},[(0,Xe.createCommentVNode)(' æœ‰å˜é‡æ—¶æ¸²æŸ“åˆ—è¡¨ '),((0,Xe.openBlock)(!0),(0,Xe.createElementBlock)(Xe.Fragment,null,(0,Xe.renderList)(a.value,e=>{return(0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',{key:e.key,class:'var-row'},[(0,Xe.createCommentVNode)(' æ¯ä¸ªå˜é‡ä¸€è¡Œ '),(0,Xe.createElementVNode)('label',{class:'var-key',title:e.key},(0,Xe.toDisplayString)(e.key),9,pn),(0,Xe.createCommentVNode)(' å˜é‡å '),(0,Xe.createCommentVNode)(' æ ¹æ®å˜é‡ç±»å‹é€‰æ‹©ä¸åŒçš„ç¼–è¾‘æ§ä»¶ '),(0,Xe.createElementVNode)('div',An,[(0,Xe.createCommentVNode)(' ç¼–è¾‘å™¨å®¹å™¨ '),(0,Xe.createCommentVNode)(' å¸ƒå°”ï¼šå‹¾é€‰æ¡† '),'boolean'===e.type?((0,Xe.openBlock)(),(0,Xe.createElementBlock)('label',un,[(0,Xe.createCommentVNode)(' è‡ªå®šä¹‰å¼€å…³å¤–è§‚ '),(0,Xe.withDirectives)((0,Xe.createElementVNode)('input',{'onUpdate:modelValue':n=>r[e.key]=n,type:'checkbox'},null,8,gn),[[Xe.vModelCheckbox,r[e.key]]]),(0,Xe.createCommentVNode)(' å‹¾é€‰å€¼ '),n[2]||(n[2]=(0,Xe.createElementVNode)('span',{class:'track'},null,-1)),(0,Xe.createCommentVNode)(' è½¨é“ ')])):'number'===e.type?((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:1},[(0,Xe.createCommentVNode)(' æ•°å­—ï¼šnumber è¾“å…¥ '),(0,Xe.withDirectives)((0,Xe.createElementVNode)('input',{'onUpdate:modelValue':n=>r[e.key]=n,type:'number',class:'ipt',placeholder:String(e.value)},null,8,fn),[[Xe.vModelText,r[e.key],void 0,{number:!0}]]),(0,Xe.createCommentVNode)(' æ•°å­—è¾“å…¥ ')],64)):'string'===e.type?((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:2},[(0,Xe.createCommentVNode)(' å­—ç¬¦ä¸²ï¼štext è¾“å…¥ '),(0,Xe.withDirectives)((0,Xe.createElementVNode)('input',{'onUpdate:modelValue':n=>r[e.key]=n,type:'text',class:'ipt',placeholder:String(e.value)},null,8,Cn),[[Xe.vModelText,r[e.key]]]),(0,Xe.createCommentVNode)(' æ–‡æœ¬è¾“å…¥ ')],64)):((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:3},[(0,Xe.createCommentVNode)(' å…¶ä»–ï¼ˆå¯¹è±¡/æ•°ç»„/null/æœªçŸ¥ï¼‰ï¼šJSON æ–‡æœ¬åŸŸ '),(0,Xe.withDirectives)((0,Xe.createElementVNode)('textarea',{'onUpdate:modelValue':n=>o[e.key]=n,class:'ipt ta',placeholder:s(e.value),onInput:n=>function(e){const n=o[e]??'';if(''!==n.trim())try{JSON.parse(n),i[e]={ok:!0,bad:!1,msg:'JSON æ ¼å¼æœ‰æ•ˆ'}}catch(n){i[e]={bad:!0,ok:!1,msg:`JSON æ ¼å¼é”™è¯¯ï¼š${n?.message??''}`}}else i[e]={bad:!0,ok:!1,msg:'ä¸èƒ½ä¸ºç©ºï¼ˆè‹¥è¦è®¾ä¸º null è¯·å†™ nullï¼‰'}}(e.key)},null,40,mn),[[Xe.vModelText,o[e.key]]]),(0,Xe.createCommentVNode)(' JSON æ–‡æœ¬åŸŸ '),(0,Xe.createElementVNode)('span',{class:(0,Xe.normalizeClass)(['hint',{ok:i[e.key]?.ok,bad:i[e.key]?.bad}])},(0,Xe.toDisplayString)(i[e.key]?.msg??'ä»¥ JSON æ ¼å¼ç¼–è¾‘æ­¤å€¼'),3),(0,Xe.createCommentVNode)(' JSON æ ¡éªŒæç¤º ')],64))]),(0,Xe.createCommentVNode)(' ç±»å‹å¾½æ ‡ '),(0,Xe.createElementVNode)('span',bn,(0,Xe.toDisplayString)((t=e.type,'boolean'===t?'å¸ƒå°”':'number'===t?'æ•°å­—':'string'===t?'å­—ç¬¦ä¸²':'JSON')),1),(0,Xe.createCommentVNode)(' ç±»å‹å±•ç¤º ')]);var t}),128))],64)):((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:1},[(0,Xe.createCommentVNode)(' æ²¡æœ‰å˜é‡æ—¶çš„å ä½ '),n[3]||(n[3]=(0,Xe.createElementVNode)('div',{class:'placeholder'},[(0,Xe.createElementVNode)('p',null,'æœªè¯»å–åˆ°ä»»ä½•è„šæœ¬å˜é‡ã€‚'),(0,Xe.createCommentVNode)(' æ–‡æœ¬æç¤º '),(0,Xe.createElementVNode)('p',{class:'dim'},[(0,Xe.createTextVNode)(' è¯·å…ˆç¡®ä¿åœ¨ '),(0,Xe.createElementVNode)('code',null,'app_ready'),(0,Xe.createTextVNode)(' æˆ–åˆå§‹åŒ–é˜¶æ®µé€šè¿‡ '),(0,Xe.createElementVNode)('code',null,'initializeExternalSettings()'),(0,Xe.createTextVNode)(' å†™å…¥é»˜è®¤å˜é‡ã€‚ ')]),(0,Xe.createCommentVNode)(' è¾…åŠ©è¯´æ˜ ')],-1))],64))])],512),[[Xe.vShow,t.value]])])],2112))}});a(463);const vn=(0,tn.A)(xn,[['__scopeId','data-v-1944c88c']]),hn=(0,Xe.defineComponent)({__name:'FloatingBall',emits:['click'],setup(e){const n=new y('ui-FloatingBall');return(0,Xe.onMounted)(()=>{n.log('onMounted','FloatingBall.vue ç»„ä»¶å·²æŒ‚è½½')}),(e,n)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',{class:'floating-ball',onClick:n[0]||(n[0]=n=>e.$emit('click'))},[n[1]||(n[1]=(0,Xe.createElementVNode)('span',{class:'era-logo','aria-hidden':'true'},'ERA',-1)),(0,Xe.createCommentVNode)(' ä»…æ˜¾ç¤ºç”¨ï¼›ä¸æ‹¦æˆªäº‹ä»¶ ')]))}});a(744);const yn=(0,tn.A)(hn,[['__scopeId','data-v-ee0f5b22']]),Bn={class:'acc'},wn=['aria-expanded'],kn={class:'title'},En={class:'hint'},Sn={class:'inner'},Nn=(0,Xe.defineComponent)({__name:'EraAccordion',props:{title:{},defaultOpen:{type:Boolean,default:!1}},setup(e){const n=e,t=(0,Xe.ref)(n.defaultOpen);return(n,a)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)('section',Bn,[(0,Xe.createCommentVNode)(' æŠ˜å å¤´ï¼šç‚¹å‡»åˆ‡æ¢ '),(0,Xe.createElementVNode)('button',{class:'acc-head','aria-expanded':t.value?'true':'false',onClick:a[0]||(a[0]=e=>t.value=!t.value)},[(0,Xe.createElementVNode)('span',{class:(0,Xe.normalizeClass)(['caret',{open:t.value}])},'â–¸',2),(0,Xe.createCommentVNode)(' æŒ‡ç¤ºç®­å¤´ '),(0,Xe.createElementVNode)('span',kn,(0,Xe.toDisplayString)(e.title),1),(0,Xe.createCommentVNode)(' æ ‡é¢˜æ–‡æœ¬ '),a[1]||(a[1]=(0,Xe.createElementVNode)('span',{class:'spacer'},null,-1)),(0,Xe.createCommentVNode)(' å¼¹æ€§ç©ºéš™ '),(0,Xe.createElementVNode)('span',En,(0,Xe.toDisplayString)(t.value?'æ”¶èµ·':'å±•å¼€'),1),(0,Xe.createCommentVNode)(' å³ä¾§æç¤º ')],8,wn),(0,Xe.createCommentVNode)(' å†…å®¹ï¼šé«˜åº¦è¿‡æ¸¡ï¼ˆä½¿ç”¨ CSS Gridï¼‰ '),(0,Xe.createElementVNode)('div',{class:(0,Xe.normalizeClass)(['acc-body',{open:t.value}])},[(0,Xe.createElementVNode)('div',Sn,[(0,Xe.renderSlot)(n.$slots,'default')])],2)]))}});a(360);const Vn=(0,tn.A)(Nn,[['__scopeId','data-v-cb8a53de']]),_n={class:'meta'},Dn={class:'kv'},$n={class:'item'},On=['title'],Mn={class:'item'},Fn={class:'v'},Tn=(0,Xe.defineComponent)({__name:'MetaHeader',props:{mk:{},messageId:{}},setup(e){const n=new y('ui-MetaHeader'),t=e;return(0,Xe.onMounted)(()=>{n.log('onMounted','ç»„ä»¶å·²æŒ‚è½½',{props:t})}),(0,Xe.watch)(()=>t,e=>{n.debug('watch:props','Props å‘ç”Ÿå˜åŒ–',{newProps:e})},{deep:!0}),(n,t)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)('section',_n,[t[2]||(t[2]=(0,Xe.createElementVNode)('h4',{class:'meta-title'},'æœ€æ–°æ¶ˆæ¯å…ƒæ•°æ®',-1)),(0,Xe.createCommentVNode)(' å°èŠ‚æ ‡é¢˜ '),(0,Xe.createElementVNode)('div',Dn,[(0,Xe.createElementVNode)('div',$n,[t[0]||(t[0]=(0,Xe.createElementVNode)('span',{class:'k'},'mk',-1)),(0,Xe.createCommentVNode)(' é”®ï¼šmk '),(0,Xe.createElementVNode)('span',{class:'v',title:e.mk},(0,Xe.toDisplayString)(e.mk||'â€”'),9,On),(0,Xe.createCommentVNode)(' å€¼ï¼šmk ')]),(0,Xe.createElementVNode)('div',Mn,[t[1]||(t[1]=(0,Xe.createElementVNode)('span',{class:'k'},'message_id',-1)),(0,Xe.createCommentVNode)(' é”®ï¼šmessage_id '),(0,Xe.createElementVNode)('span',Fn,(0,Xe.toDisplayString)(e.messageId??'â€”'),1),(0,Xe.createCommentVNode)(' å€¼ï¼šmessage_id ')])]),t[3]||(t[3]=(0,Xe.createElementVNode)('div',{class:'glow'},null,-1)),(0,Xe.createCommentVNode)(' è£…é¥°ï¼šæµå…‰æ¡ ')]))}});a(462);const Rn=(0,tn.A)(Tn,[['__scopeId','data-v-56f5fbd7']]),jn={class:'node'},In={class:'key'},Pn={class:'brace'},zn={key:0,class:'summary'},Jn={key:0,class:'json-children'},Ln={class:'brace'};const Yn=(0,Xe.defineComponent)({name:'JsonNode',props:{k:{type:[String,Number],required:!0},v:{required:!0},path:{type:String,required:!0},level:{type:Number,required:!0},defaultCollapsed:{type:Boolean,default:!0},maxDepth:{type:Number,default:3}},setup(e){const n=new y;(0,Xe.onMounted)(()=>{n.debug('onMounted','ç»„ä»¶å·²æŒ‚è½½',{props:e})});const t=(0,Xe.computed)(()=>{const n=e.v;if(null===n)return'null';if(Array.isArray(n))return'array';const t=typeof n;return'object'===t?'object':'undefined'===t?'undefined':t}),a=(0,Xe.computed)(()=>'array'===t.value),r=(0,Xe.computed)(()=>'object'===t.value),o=(0,Xe.computed)(()=>a.value||r.value),i=(0,Xe.ref)(e.level<=(e.maxDepth??3)||!e.defaultCollapsed);(0,Xe.watch)(i,e=>{n.debug('watch:open','æŠ˜å çŠ¶æ€æ”¹å˜ä¸º: '+(e?'å±•å¼€':'æ”¶èµ·'))});const s=(0,Xe.computed)(()=>{const n=e.v;switch(t.value){case'string':return JSON.stringify(n);case'number':case'symbol':return String(n);case'boolean':return n?'true':'false';case'null':return'null';case'undefined':return'undefined';case'bigint':return String(n)+'n';case'function':return'Æ’()';default:return''}}),l=(0,Xe.computed)(()=>a.value?`Array[${e.v.length}]`:r.value?`Object{${Object.keys(e.v||{}).length}}`:''),c=(0,Xe.computed)(()=>{if(r.value)return e.v;if(a.value){const n={};return e.v.forEach((e,t)=>{n[String(t)]=e}),n}return{}});return{type:t,isArray:a,foldable:o,open:i,primitiveText:s,summary:l,childEntries:c}}});a(988);const Gn=(0,tn.A)(Yn,[['render',function(e,n,t,a,r,o){const i=(0,Xe.resolveComponent)('JsonNode',!0);return(0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,null,[(0,Xe.createCommentVNode)(' å•æ¡èŠ‚ç‚¹ï¼ˆæ”¯æŒé€’å½’ï¼‰ '),(0,Xe.createElementVNode)('div',jn,[(0,Xe.createCommentVNode)(' æ¯ä¸ªé”®å€¼å¯¹ / æ•°ç»„é¡¹çš„å®¹å™¨ '),(0,Xe.createElementVNode)('div',{class:'json-line',style:(0,Xe.normalizeStyle)({paddingLeft:14*e.level+'px'})},[(0,Xe.createCommentVNode)(' è¡Œ+ç¼©è¿› '),e.foldable?((0,Xe.openBlock)(),(0,Xe.createElementBlock)('button',{key:0,class:(0,Xe.normalizeClass)(['caret',{open:e.open}]),'aria-label':'toggle',onClick:n[0]||(n[0]=n=>e.open=!e.open)},'â–¸',2)):(0,Xe.createCommentVNode)('v-if',!0),(0,Xe.createCommentVNode)(' æŠ˜å ç®­å¤´æŒ‰é’® '),(0,Xe.createElementVNode)('span',In,(0,Xe.toDisplayString)(e.k),1),n[1]||(n[1]=(0,Xe.createElementVNode)('span',{class:'colon'},':',-1)),(0,Xe.createCommentVNode)(' é”®ä¸å†’å· '),(0,Xe.createCommentVNode)(' å¯æŠ˜å å®¹å™¨ï¼šåªæ˜¾ç¤ºæ‹¬å·ä¸æ‘˜è¦ï¼›å±•å¼€åç”±ä¸‹æ–¹ children åŒºåŸŸé€’å½’æ¸²æŸ“ '),e.foldable?((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:1},[(0,Xe.createElementVNode)('span',Pn,(0,Xe.toDisplayString)(e.isArray?'[':'{'),1),(0,Xe.createCommentVNode)(' å®¹å™¨èµ·å§‹æ‹¬å· '),e.open?(0,Xe.createCommentVNode)('v-if',!0):((0,Xe.openBlock)(),(0,Xe.createElementBlock)('span',zn,(0,Xe.toDisplayString)(e.summary),1)),(0,Xe.createCommentVNode)(' æ”¶èµ·æ—¶çš„æ‘˜è¦ ')],64)):((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:2},[(0,Xe.createCommentVNode)(' åŸå§‹å€¼ï¼šç›´æ¥ç€è‰²æ¸²æŸ“ '),(0,Xe.createElementVNode)('span',{class:(0,Xe.normalizeClass)(['val',e.type])},(0,Xe.toDisplayString)(e.primitiveText),3),(0,Xe.createCommentVNode)(' åŸå§‹å€¼æ–‡æœ¬ ')],64))],4),(0,Xe.createCommentVNode)(' å­å…ƒç´ åŒºåŸŸï¼šä»…å½“å¯æŠ˜å ä¸”å¤„äºå±•å¼€æ€æ—¶æ˜¾ç¤º '),e.foldable&&e.open?((0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',Jn,[(0,Xe.createCommentVNode)(' é€’å½’ï¼šè‡ªå¼•ç”¨åŒåç»„ä»¶ JsonNodeï¼ˆä¾èµ– name: \'JsonNode\' å®ç°è‡ªé€’å½’ï¼‰ '),((0,Xe.openBlock)(!0),(0,Xe.createElementBlock)(Xe.Fragment,null,(0,Xe.renderList)(e.childEntries,(n,t)=>((0,Xe.openBlock)(),(0,Xe.createBlock)(i,{key:e.path+'/'+String(t),k:String(t),v:n,path:e.path+'/'+String(t),level:e.level+1,'default-collapsed':e.defaultCollapsed,'max-depth':e.maxDepth},null,8,['k','v','path','level','default-collapsed','max-depth']))),128)),(0,Xe.createElementVNode)('div',{class:'json-line',style:(0,Xe.normalizeStyle)({paddingLeft:14*e.level+'px'})},[(0,Xe.createElementVNode)('span',Ln,(0,Xe.toDisplayString)(e.isArray?']':'}'),1),(0,Xe.createCommentVNode)(' å®¹å™¨é—­åˆæ‹¬å· ')],4)])):(0,Xe.createCommentVNode)('v-if',!0)])],2112)}],['__scopeId','data-v-34fc6c00']]),qn={class:'json-root'},Un={class:'json-line'},Wn={class:'brace'},Kn={class:'json-children'},Hn={key:1,class:'json-line',style:{paddingLeft:'14px'}},Qn={class:'json-line'},Xn={class:'brace'},Zn=(0,Xe.defineComponent)({__name:'PrettyJsonViewer',props:{value:{},defaultCollapsed:{type:Boolean,default:!0},maxDepth:{default:3}},setup(e){const n=new y,t=e,a=(0,Xe.computed)(()=>{const e=t.value,a=null!==e&&'object'==typeof e;return n.debug('isPlainObjectOrArray',`è®¡ç®—ç»“æœ: ${a}ã€‚è¯¥å€¼${a?'æ˜¯':'ä¸æ˜¯'}æ™®é€šå¯¹è±¡æˆ–æ•°ç»„ã€‚`,{ä¼ å…¥å€¼:e}),a}),r=(0,Xe.computed)(()=>{const e=t.value;let a;if(null===e)a='null';else if(Array.isArray(e))a='array';else{const n=typeof e;a='undefined'===n?'undefined':n}return n.debug('primitiveType',`è®¡ç®—åŸå§‹å€¼ç±»å‹: ${a}`,{ä¼ å…¥å€¼:e}),a}),o=(0,Xe.computed)(()=>{const e=t.value;let a;switch(r.value){case'string':a=JSON.stringify(e);break;case'number':case'symbol':a=String(e);break;case'boolean':a=e?'true':'false';break;case'null':a='null';break;case'undefined':a='undefined';break;case'bigint':a=String(e)+'n';break;case'function':a='Æ’()';break;default:a=''}return n.debug('primitiveText',`æ ¼å¼åŒ–åŸå§‹å€¼æ–‡æœ¬: "${a}"`,{ä¼ å…¥å€¼:e,ç±»å‹:r.value}),a}),i=(0,Xe.computed)(()=>{const e=Array.isArray(t.value);return n.debug('isArrayRoot',`è®¡ç®—æ ¹èŠ‚ç‚¹æ˜¯å¦ä¸ºæ•°ç»„: ${e}`,{ä¼ å…¥å€¼:t.value}),e}),s=(0,Xe.computed)(()=>i.value?'[':'{'),l=(0,Xe.computed)(()=>i.value?']':'}');return(n,t)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',qn,[(0,Xe.createElementVNode)('div',Un,[(0,Xe.createElementVNode)('span',Wn,(0,Xe.toDisplayString)(s.value),1),(0,Xe.createCommentVNode)(' æ ¹å¼€æ‹¬å·ï¼šå¯¹è±¡{ / æ•°ç»„[ ')]),(0,Xe.createElementVNode)('div',Kn,[a.value?((0,Xe.openBlock)(!0),(0,Xe.createElementBlock)(Xe.Fragment,{key:0},(0,Xe.renderList)(e.value,(n,t)=>((0,Xe.openBlock)(),(0,Xe.createBlock)(Gn,{key:String(t),k:String(t),v:n,path:String(t),level:1,'default-collapsed':e.defaultCollapsed,'max-depth':e.maxDepth},null,8,['k','v','path','default-collapsed','max-depth']))),128)):((0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',Hn,[t[0]||(t[0]=(0,Xe.createElementVNode)('span',{class:'key'},'value',-1)),t[1]||(t[1]=(0,Xe.createElementVNode)('span',{class:'colon'},':',-1)),(0,Xe.createElementVNode)('span',{class:(0,Xe.normalizeClass)(['val',r.value])},(0,Xe.toDisplayString)(o.value),3)]))]),(0,Xe.createElementVNode)('div',Qn,[(0,Xe.createElementVNode)('span',Xn,(0,Xe.toDisplayString)(l.value),1),(0,Xe.createCommentVNode)(' æ ¹é—­æ‹¬å·ï¼šå¯¹è±¡} / æ•°ç»„] ')])]))}});a(802);const et=(0,tn.A)(Zn,[['__scopeId','data-v-036df356']]),nt={class:'tabs'},tt={class:'tab-bar',role:'tablist'},at=['onClick'],rt={class:'tab-content'},ot={key:0},it={key:1},st=(0,Xe.defineComponent)({__name:'TabSwitch',props:{tabs:{},active:{}},emits:['update:active'],setup(e,{emit:n}){const t=new y('ui-TabSwitch'),a=e,r=n,o=(0,Xe.ref)(a.active??'pure');return(0,Xe.watch)(()=>a.active,e=>{e&&(t.debug('watch:active',`å¤–éƒ¨åŒæ­¥ active tab ä¸º: ${e}`),o.value=e)}),(0,Xe.onMounted)(()=>{t.log('onMounted','ç»„ä»¶å·²æŒ‚è½½',{props:a})}),(n,a)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)('section',nt,[(0,Xe.createCommentVNode)(' é¡µç­¾è¡Œ '),(0,Xe.createElementVNode)('div',tt,[((0,Xe.openBlock)(!0),(0,Xe.createElementBlock)(Xe.Fragment,null,(0,Xe.renderList)(e.tabs,e=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)('button',{key:e.key,class:(0,Xe.normalizeClass)(['tab-btn',{active:e.key===o.value}]),role:'tab',onClick:n=>{return a=e.key,t.log('setActive',`ç”¨æˆ·ç‚¹å‡»ï¼Œåˆ‡æ¢ tab åˆ°: ${a}`),o.value=a,void r('update:active',a);var a}},(0,Xe.toDisplayString)(e.label),11,at))),128))]),(0,Xe.createCommentVNode)(' å†…å®¹åŒºï¼šæ ¹æ®æ´»åŠ¨é”®æ¸²æŸ“å¯¹åº”æ’æ§½ '),(0,Xe.createElementVNode)('div',rt,['pure'===o.value?((0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',ot,[(0,Xe.renderSlot)(n.$slots,'pure'),(0,Xe.createCommentVNode)(' çº¯å‡€çŠ¶æ€æ•°æ®å†…å®¹ ')])):((0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',it,[(0,Xe.renderSlot)(n.$slots,'full'),(0,Xe.createCommentVNode)(' å®Œæ•´çŠ¶æ€æ•°æ®å†…å®¹ ')]))])]))}});a(364);const lt=(0,tn.A)(st,[['__scopeId','data-v-7ab146e6']]),ct={class:'era-app-container'},dt={class:'era-expanded-layer'},pt={class:'era-shell'},At={class:'era-panel'},ut={class:'panel-top'},gt={class:'panel-body'},ft={style:{display:'flex','flex-direction':'column',gap:'8px'}},Ct={class:'right-rail'},mt=(0,Xe.defineComponent)({__name:'App',props:{initialView:{type:String,required:!0,default:'FloatingBall'},eventData:{type:Object,default:()=>null}},setup(e){const n=new y('ui-App'),t=e,a=(0,Xe.ref)(t.initialView),r=e=>{n.debug('requestSwitchView',`è¯·æ±‚åˆ‡æ¢è§†å›¾åˆ°: ${e}`),window.eraUiSwitchView?window.eraUiSwitchView(e):n.warn('requestSwitchView','å…¨å±€åˆ‡æ¢å‡½æ•° eraUiSwitchView æœªæ‰¾åˆ°')},o=(0,Xe.computed)(()=>t.eventData||null),i=[{key:'pure',label:'çº¯å‡€çŠ¶æ€æ•°æ®'},{key:'full',label:'å®Œæ•´çŠ¶æ€æ•°æ®'}],s=(0,Xe.ref)('pure');return(0,Xe.onMounted)(()=>{n.log('onMounted','App.vue ç»„ä»¶å·²æŒ‚è½½',{props:t})}),(0,Xe.watch)(()=>t.eventData,(e,t)=>{n.debug('watch:eventData','eventData prop å‘ç”Ÿå˜åŒ–',{newData:e,oldData:t})},{deep:!0}),(0,Xe.watch)(()=>t.initialView,e=>{n.debug('watch:initialView',`initialView prop å‘ç”Ÿå˜åŒ–ï¼Œæ–°è§†å›¾: ${e}`),a.value=e}),(e,n)=>((0,Xe.openBlock)(),(0,Xe.createElementBlock)('div',ct,[(0,Xe.withDirectives)((0,Xe.createVNode)(yn,{onClick:n[0]||(n[0]=e=>r('ExpandedView'))},null,512),[[Xe.vShow,'FloatingBall'===a.value]]),(0,Xe.withDirectives)((0,Xe.createElementVNode)('div',dt,[(0,Xe.createCommentVNode)(' è§†å£çº§å±•å¼€å±‚ï¼šæ‚¬æµ®æ¨¡æ€å®¹å™¨ '),(0,Xe.createElementVNode)('div',pt,[(0,Xe.createCommentVNode)(' æ–°å¢æ¨ªå‘å£³å®¹å™¨ï¼šå·¦é¢æ¿ + å³ä¾§æ  '),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ¨ªå‘å¸ƒå±€å®¹å™¨ '),(0,Xe.createElementVNode)('div',At,[(0,Xe.createCommentVNode)(' ä¿æŒé¢æ¿åŸæœ‰ç»“æ„ä¸å˜ '),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå·¦ä¾§ ERA é¢æ¿ '),(0,Xe.createCommentVNode)(' é¡¶éƒ¨æ ï¼šæ ‡é¢˜ + å…³é—­æŒ‰é’® '),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šé¢æ¿é¡¶éƒ¨ '),(0,Xe.createElementVNode)('header',ut,[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šé¡¶æ  '),n[3]||(n[3]=(0,Xe.createElementVNode)('h3',{class:'panel-title'},'ERA æ•°æ®é¢æ¿',-1)),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ ‡é¢˜ '),(0,Xe.createElementVNode)('button',{class:'btn-close','aria-label':'å…³é—­',onClick:n[1]||(n[1]=e=>r('FloatingBall'))},'Ã—'),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå…³é—­æŒ‰é’® ')]),(0,Xe.createCommentVNode)(' å†…å®¹åŒºï¼ˆåŸæ ·ä¿ç•™ï¼‰ '),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šé¢æ¿ä¸»ä½“ '),(0,Xe.createElementVNode)('div',gt,[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå¯æ»šåŠ¨å†…å®¹ '),o.value?((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:0},[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæœ‰æ•°æ®åˆ™æ¸²æŸ“ '),(0,Xe.createVNode)(Rn,{mk:o.value.mk,'message-id':o.value.message_id},null,8,['mk','message-id']),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæœ€æ–°æ¶ˆæ¯å…ƒæ•°æ® '),(0,Xe.createVNode)(Vn,{title:'ERA æœ€æ–°æ“ä½œè¯¦æƒ…','default-open':!1},{default:(0,Xe.withCtx)(()=>[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ '),(0,Xe.createElementVNode)('div',ft,[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå †å ä¸¤ä¸ªå­æŠ˜å  '),(0,Xe.createVNode)(Vn,{title:'SelectedMksï¼ˆæ•°ç»„ï¼‰','default-open':!1},{default:(0,Xe.withCtx)(()=>[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ '),(0,Xe.createVNode)(et,{value:o.value.selectedMks,'default-collapsed':!0,'max-depth':3},null,8,['value']),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ ')]),_:1}),(0,Xe.createVNode)(Vn,{title:'EditLogsï¼ˆå¯¹è±¡ï¼‰','default-open':!1},{default:(0,Xe.withCtx)(()=>[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ’æ§½ '),(0,Xe.createVNode)(et,{value:o.value.editLogs,'default-collapsed':!0,'max-depth':2},null,8,['value']),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ ')]),_:1})])]),_:1}),(0,Xe.createVNode)(lt,{active:s.value,'onUpdate:active':n[2]||(n[2]=e=>s.value=e),tabs:i},{pure:(0,Xe.withCtx)(()=>[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šçº¯å‡€çŠ¶æ€æ•°æ® '),(0,Xe.createVNode)(et,{value:o.value.statWithoutMeta,'default-collapsed':!0,'max-depth':1/0},null,8,['value']),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ ')]),full:(0,Xe.withCtx)(()=>[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå®Œæ•´çŠ¶æ€æ•°æ® '),(0,Xe.createVNode)(et,{value:o.value.stat,'default-collapsed':!0,'max-depth':1/0},null,8,['value']),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šJSON è§†å›¾ ')]),_:1},8,['active'])],64)):((0,Xe.openBlock)(),(0,Xe.createElementBlock)(Xe.Fragment,{key:1},[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæš‚æ— æ•°æ®å ä½ '),n[4]||(n[4]=(0,Xe.createElementVNode)('div',{class:'empty'},'ç­‰å¾… era:writeDone äº‹ä»¶æ•°æ®â€¦',-1)),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå ä½æç¤º ')],64))])]),(0,Xe.createCommentVNode)(' å³ä¾§å›ºå®šæ ï¼šåªæ”¹å˜â€œä½ç½®/å¤–éƒ¨ç»“æ„â€ï¼Œä¸æ”¹æŒ‰é’®é€»è¾‘ '),(0,Xe.createElementVNode)('aside',Ct,[(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šå³ä¾§æ å®¹å™¨ '),(0,Xe.createVNode)(an),(0,Xe.createCommentVNode)(' ä¸­æ–‡æ³¨é‡Šï¼šæ“ä½œæŒ‰é’®ç»„ä»¶ï¼ˆäº‹ä»¶ä¿æŒä¸å˜ï¼‰ '),(0,Xe.createVNode)(vn)])])],512),[[Xe.vShow,'ExpandedView'===a.value]])]))}});a(242),a(408);const bt=(0,tn.A)(mt,[['__scopeId','data-v-57305d87']]);const xt=new y('ui-index');let vt=null,ht=null,yt='FloatingBall',Bt=null;function wt(n,t){xt.debug('renderApp',`å¼€å§‹æ¸²æŸ“ Appï¼Œè§†å›¾: ${n}`,{dataToPass:t}),ht?(kt(),vt=(0,Xe.createApp)(bt,{initialView:n,eventData:t}),vt.use(e()),vt.mount(ht[0]),function(){const e=getScriptId();$(`head > div[script_id="${e}"]`).remove();const n=$('<div>').attr('script_id',e).append($('head > style',document).clone());$('head').append(n)}(),xt.debug('renderApp','æ¸²æŸ“å®Œæˆ')):xt.warn('renderApp','æŒ‚è½½ç‚¹ä¸å­˜åœ¨ï¼Œæ¸²æŸ“ä¸­æ­¢')}function kt(){vt&&(xt.debug('unmountVueApp','å¸è½½ Vue å®ä¾‹'),vt.unmount(),vt=null)}function Et(){xt.log('unloadUI','UI è„šæœ¬å¼€å§‹å¸è½½'),kt(),$(`head > div[script_id="${getScriptId()}"]`).remove(),ht&&(xt.debug('unloadUI','é”€æ¯æŒ‚è½½ç‚¹'),$(`div#era-ui-mount-point-${getScriptId()}`).remove(),ht=null),xt.log('unloadUI','UI è„šæœ¬å¸è½½å®Œæˆ')}window.eraUiSwitchView=function(e){xt.debug('switchView',`è¯·æ±‚åˆ‡æ¢è§†å›¾åˆ°: ${e}`),yt!==e?(yt=e,xt.log('switchView','è§†å›¾å·²åˆ‡æ¢ï¼Œé‡æ–°æ¸²æŸ“ App'),wt(e,Bt)):xt.debug('switchView',`è§†å›¾å·²ç»æ˜¯ ${e}ï¼Œæ— éœ€åˆ‡æ¢`)},$(()=>{if(!1===j()['å¼€å¯æ‚¬æµ®çƒ'])return xt.log('initialize','UI ahow ball disabled, attempting to unload...'),void Et();xt.log('initialize','UI è„šæœ¬å¼€å§‹åˆå§‹åŒ–'),ht=$('<div>').attr('id',`era-ui-mount-point-${getScriptId()}`).css({position:'fixed',bottom:'20px',left:'20px','z-index':1e4}),xt.debug('$(document).ready','åˆ›å»ºæŒ‚è½½ç‚¹',ht),$('body').append(ht),xt.debug('$(document).ready','æŒ‚è½½ç‚¹å·²æ·»åŠ åˆ° body'),wt(yt,Bt),eventOn('era:writeDone',e=>{xt.log('era:writeDone','æ¥æ”¶åˆ° era:writeDone äº‹ä»¶ï¼Œå‡†å¤‡åˆ·æ–° UI',e),Bt=e,wt(yt,Bt)}),xt.debug('$(document).ready','å·²è®¾ç½® era:writeDone äº‹ä»¶ç›‘å¬å™¨')}),$(window).on('pagehide',Et);[...w.INIT,...w.SYNC,...w.API,...w.UPDATE_MK_ONLY,...w.COLLISION_DETECTORS,...w.COMBO_STARTERS].forEach(e=>{eventOn(e,n=>He(e,n))}),eventOn(getButtonEvent('å†™å…¥å˜é‡ä¿®æ”¹'),()=>He('manual_write')),eventOn(getButtonEvent('æ‰‹åŠ¨åŒæ­¥çŠ¶æ€'),()=>He('manual_sync')),eventOn(getButtonEvent('å¼ºåˆ¶å®Œå…¨é‡ç®—'),()=>He('manual_full_sync'));
//# sourceMappingURL=index.js.map